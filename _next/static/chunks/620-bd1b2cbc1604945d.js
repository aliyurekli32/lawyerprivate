(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[620],{9742:function(t,e){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],i=e[1];return(n+i)*3/4-i},e.toByteArray=function(t){var e,n,o=l(t),a=o[0],s=o[1],u=new r((a+s)*3/4-s),c=0,h=s>0?a-4:a;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;return 2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[c++]=255&e),1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e),u},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,o=[],a=0,s=i-r;a<s;a+=16383)o.push(function(t,e,i){for(var r,o=[],a=e;a<i;a+=3)o.push(n[(r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]))>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return o.join("")}(t,a,a+16383>s?s:a+16383));return 1===r?o.push(n[(e=t[i-1])>>2]+n[e<<4&63]+"=="):2===r&&o.push(n[(e=(t[i-2]<<8)+t[i-1])>>10]+n[e>>4&63]+n[e<<2&63]+"="),o.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)n[a]=o[a],i[o.charCodeAt(a)]=a;function l(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var i=n===e?0:4-n%4;return[n,i]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},8764:function(t,e,n){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var i=n(9742),r=n(645),o=n(5826);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!l.TYPED_ARRAY_SUPPORT&&!(this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,n)}function u(t,e,n,i){if("number"==typeof e)throw TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw RangeError("'length' is out of bounds");return e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=f(t,e),t}(t,e,n,i):"string"==typeof e?function(t,e,n){if(("string"!=typeof n||""===n)&&(n="utf8"),!l.isEncoding(n))throw TypeError('"encoding" must be a valid string encoding');var i=0|v(e,n),r=(t=s(t,i)).write(e,n);return r!==i&&(t=t.slice(0,r)),t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n,i=0|d(e.length);return 0===(t=s(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}throw TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw TypeError('"size" argument must be a number');if(t<0)throw RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=s(t,e<0?0:0|d(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=s(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function d(t){if(t>=a())throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function v(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return P(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(t).length;default:if(i)return P(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var r,o,a=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,n){var i,r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",a=e;a<n;++a)o+=(i=t[a])<16?"0"+i.toString(16):i.toString(16);return o}(this,e,n);case"utf8":case"utf-8":return m(this,e,n);case"ascii":return function(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}(this,e,n);case"latin1":case"binary":return function(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}(this,e,n);case"base64":return r=e,o=n,0===r&&o===this.length?i.fromByteArray(this):i.fromByteArray(this.slice(r,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n){for(var i=t.slice(e,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}(this,e,n);default:if(a)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}function p(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function y(t,e,n,i,r){if(0===t.length)return -1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),isNaN(n=+n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return -1;n=t.length-1}else if(n<0){if(!r)return -1;n=0}if("string"==typeof e&&(e=l.from(e,i)),l.isBuffer(e))return 0===e.length?-1:_(t,e,n,i,r);if("number"==typeof e)return(e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf)?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):_(t,[e],n,i,r);throw TypeError("val must be string, number or Buffer")}function _(t,e,n,i,r){var o,a=1,s=t.length,l=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return -1;a=2,s/=2,l/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){var c=-1;for(o=n;o<s;o++)if(u(t,o)===u(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else -1!==c&&(o-=o-c),c=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var h=!0,f=0;f<l;f++)if(u(t,o+f)!==u(e,f)){h=!1;break}if(h)return o}return -1}function m(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var o,a,s,l,u=t[r],c=null,h=u>239?4:u>223?3:u>191?2:1;if(r+h<=n)switch(h){case 1:u<128&&(c=u);break;case 2:(192&(o=t[r+1]))==128&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=t[r+1],a=t[r+2],(192&o)==128&&(192&a)==128&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=t[r+1],a=t[r+2],s=t[r+3],(192&o)==128&&(192&a)==128&&(192&s)==128&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return n}(i)}function x(t,e,n){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>n)throw RangeError("Trying to access beyond buffer length")}function R(t,e,n,i,r,o){if(!l.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw RangeError('"value" argument is out of bounds');if(n+i>t.length)throw RangeError("Index out of range")}function E(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);r<o;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>(i?r:1-r)*8}function k(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);r<o;++r)t[n+r]=e>>>(i?r:3-r)*8&255}function T(t,e,n,i,r,o){if(n+i>t.length||n<0)throw RangeError("Index out of range")}function C(t,e,n,i,o){return o||T(t,e,n,4,34028234663852886e22,-34028234663852886e22),r.write(t,e,n,i,23,4),n+4}function S(t,e,n,i,o){return o||T(t,e,n,8,17976931348623157e292,-17976931348623157e292),r.write(t,e,n,i,52,8),n+8}e.lW=l,e.h2=50,l.TYPED_ARRAY_SUPPORT=void 0!==n.g.TYPED_ARRAY_SUPPORT?n.g.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return u(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return(c(t),t<=0)?s(null,t):void 0!==e?"string"==typeof n?s(null,t).fill(e,n):s(null,t).fill(e):s(null,t)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!!(null!=t&&t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);if(void 0===e)for(n=0,e=0;n<t.length;++n)e+=t[n].length;var n,i=l.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var a=t[n];if(!l.isBuffer(a))throw TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},l.byteLength=v,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)p(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)p(this,e,e+3),p(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)p(this,e,e+7),p(this,e+1,e+6),p(this,e+2,e+5),p(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0==arguments.length?m(this,0,t):g.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.h2;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,i,r){if(!l.isBuffer(t))throw TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return -1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,r>>>=0,this===t)return 0;for(var o=r-i,a=n-e,s=Math.min(o,a),u=this.slice(i,r),c=t.slice(e,n),h=0;h<s;++h)if(u[h]!==c[h]){o=u[h],a=c[h];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,n){return -1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},l.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else if(isFinite(e))e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var r,o,a,s,l,u,c,h,f,d,v,g,p=this.length-e;if((void 0===n||n>p)&&(n=p),t.length>0&&(n<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var y=!1;;)switch(i){case"hex":return function(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=e.length;if(o%2!=0)throw TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))break;t[n+a]=s}return a}(this,t,e,n);case"utf8":case"utf-8":return l=e,u=n,b(P(t,this.length-l),this,l,u);case"ascii":return c=e,h=n,b(Z(t),this,c,h);case"latin1":case"binary":return r=this,o=t,a=e,s=n,b(Z(o),r,a,s);case"base64":return f=e,d=n,b(I(t),this,f,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v=e,g=n,b(function(t,e){for(var n,i,r=[],o=0;o<t.length&&!((e-=2)<0);++o)i=(n=t.charCodeAt(o))>>8,r.push(n%256),r.push(i);return r}(t,this.length-v),this,v,g);default:if(y)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),y=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(t,e){var n,i=this.length;if(t=~~t,e=void 0===e?i:~~e,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),e<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},l.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return(e||x(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},l.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;R(this,t,e,n,r,0)}var o=1,a=0;for(this[e]=255&t;++a<n&&(o*=256);)this[e+a]=t/o&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;R(this,t,e,n,r,0)}var o=n-1,a=1;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=t/a&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):E(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):E(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);R(this,t,e,n,r-1,-r)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);R(this,t,e,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):E(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):E(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return C(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return C(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return S(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return S(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("sourceStart out of bounds");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,o=i-n;if(this===t&&n<e&&e<i)for(r=o-1;r>=0;--r)t[r+e]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r,o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw RangeError("Out of range index");if(n<=e)return this;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(r=e;r<n;++r)this[r]=t;else{var a=l.isBuffer(t)?t:P(new l(t,i).toString()),s=a.length;for(r=0;r<n-e;++r)this[r+e]=a[r%s]}return this};var w=/[^+\/0-9A-Za-z-_]/g;function P(t,e){e=e||1/0;for(var n,i=t.length,r=null,o=[],a=0;a<i;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319||a+1===i){(e-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),r=n;continue}n=(r-55296<<10|n-56320)+65536}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return o}function Z(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function I(t){return i.toByteArray(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(w,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function b(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length)&&!(r>=t.length);++r)e[r+n]=t[r];return r}},9187:function(t){"use strict";function e(t,e,c){c=c||2;var h,v,p,y,_,m,x,R=e&&e.length,E=R?e[0]*c:t.length,k=n(t,0,E,c,!0),T=[];if(!k||k.next===k.prev)return T;if(R&&(k=function(t,e,o,l){var u,c,h,v,g,p=[];for(u=0,c=e.length;u<c;u++)h=e[u]*l,v=u<c-1?e[u+1]*l:t.length,(g=n(t,h,v,l,!1))===g.next&&(g.steiner=!0),p.push(function(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}(g));for(p.sort(r),u=0;u<p.length;u++)o=function(t,e){var n=function(t,e){var n,i,r,o=e,l=t.x,u=t.y,c=-1/0;do{if(u<=o.y&&u>=o.next.y&&o.next.y!==o.y){var h=o.x+(u-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(h<=l&&h>c&&(c=h,r=o.x<o.next.x?o:o.next,h===l))return r}o=o.next}while(o!==e);if(!r)return null;var d,v=r,g=r.x,p=r.y,y=1/0;o=r;do l>=o.x&&o.x>=g&&l!==o.x&&a(u<p?l:c,u,g,p,u<p?c:l,u,o.x,o.y)&&(d=Math.abs(u-o.y)/(l-o.x),f(o,t)&&(d<y||d===y&&(o.x>r.x||o.x===r.x&&(n=r,i=o,0>s(n.prev,n,i.prev)&&0>s(i.next,n,n.next))))&&(r=o,y=d)),o=o.next;while(o!==v);return r}(t,e);if(!n)return e;var r=d(n,t);return i(r,r.next),i(n,n.next)}(p[u],o);return o}(t,e,k,c)),t.length>80*c){h=p=t[0],v=y=t[1];for(var C=c;C<E;C+=c)_=t[C],m=t[C+1],_<h&&(h=_),m<v&&(v=m),_>p&&(p=_),m>y&&(y=m);x=0!==(x=Math.max(p-h,y-v))?32767/x:0}return function t(e,n,r,c,h,v,p){if(e){!p&&v&&function(t,e,n,i){var r=t;do 0===r.z&&(r.z=o(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(a>1)}(r)}(e,c,h,v);for(var y,_,m=e;e.prev!==e.next;){if(y=e.prev,_=e.next,v?function(t,e,n,i){var r=t.prev,l=t.next;if(s(r,t,l)>=0)return!1;for(var u=r.x,c=t.x,h=l.x,f=r.y,d=t.y,v=l.y,g=u<c?u<h?u:h:c<h?c:h,p=f<d?f<v?f:v:d<v?d:v,y=u>c?u>h?u:h:c>h?c:h,_=f>d?f>v?f:v:d>v?d:v,m=o(g,p,e,n,i),x=o(y,_,e,n,i),R=t.prevZ,E=t.nextZ;R&&R.z>=m&&E&&E.z<=x;){if(R.x>=g&&R.x<=y&&R.y>=p&&R.y<=_&&R!==r&&R!==l&&a(u,f,c,d,h,v,R.x,R.y)&&s(R.prev,R,R.next)>=0||(R=R.prevZ,E.x>=g&&E.x<=y&&E.y>=p&&E.y<=_&&E!==r&&E!==l&&a(u,f,c,d,h,v,E.x,E.y)&&s(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;R&&R.z>=m;){if(R.x>=g&&R.x<=y&&R.y>=p&&R.y<=_&&R!==r&&R!==l&&a(u,f,c,d,h,v,R.x,R.y)&&s(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;E&&E.z<=x;){if(E.x>=g&&E.x<=y&&E.y>=p&&E.y<=_&&E!==r&&E!==l&&a(u,f,c,d,h,v,E.x,E.y)&&s(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}(e,c,h,v):function(t){var e=t.prev,n=t.next;if(s(e,t,n)>=0)return!1;for(var i=e.x,r=t.x,o=n.x,l=e.y,u=t.y,c=n.y,h=i<r?i<o?i:o:r<o?r:o,f=l<u?l<c?l:c:u<c?u:c,d=i>r?i>o?i:o:r>o?r:o,v=l>u?l>c?l:c:u>c?u:c,g=n.next;g!==e;){if(g.x>=h&&g.x<=d&&g.y>=f&&g.y<=v&&a(i,l,r,u,o,c,g.x,g.y)&&s(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}(e)){n.push(y.i/r|0),n.push(e.i/r|0),n.push(_.i/r|0),g(e),e=_.next,m=_.next;continue}if((e=_)===m){p?1===p?t(e=function(t,e,n){var r=t;do{var o=r.prev,a=r.next.next;!l(o,a)&&u(o,r,r.next,a)&&f(o,a)&&f(a,o)&&(e.push(o.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),g(r),g(r.next),r=t=a),r=r.next}while(r!==t);return i(r)}(i(e),n,r),n,r,c,h,v,2):2===p&&function(e,n,r,o,a,c){var h=e;do{for(var v,g,p=h.next.next;p!==h.prev;){if(h.i!==p.i&&(v=h,g=p,v.next.i!==g.i&&v.prev.i!==g.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&u(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(v,g)&&(f(v,g)&&f(g,v)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}(v,g)&&(s(v.prev,v,g.prev)||s(v,g.prev,g))||l(v,g)&&s(v.prev,v,v.next)>0&&s(g.prev,g,g.next)>0))){var y=d(h,p);h=i(h,h.next),y=i(y,y.next),t(h,n,r,o,a,c,0),t(y,n,r,o,a,c,0);return}p=p.next}h=h.next}while(h!==e)}(e,n,r,c,h,v):t(i(e),n,r,c,h,v,1);break}}}}(k,T,c,h,v,x,0),T}function n(t,e,n,i,r){var o,a;if(r===y(t,e,n,i)>0)for(o=e;o<n;o+=i)a=v(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=v(o,t[o],t[o+1],a);return a&&l(a,a.next)&&(g(a),a=a.next),a}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do if(n=!1,!i.steiner&&(l(i,i.next)||0===s(i.prev,i,i.next))){if(g(i),(i=e=i.prev)===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function r(t,e){return t.x-e.x}function o(t,e,n,i,r){return(t=((t=((t=((t=((t=(t-n)*r|0)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)|(e=((e=((e=((e=((e=(e-i)*r|0)|e<<8)&16711935)|e<<4)&252645135)|e<<2)&858993459)|e<<1)&1431655765)<<1}function a(t,e,n,i,r,o,a,s){return(r-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(i-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(r-a)*(i-s)}function s(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function l(t,e){return t.x===e.x&&t.y===e.y}function u(t,e,n,i){var r=h(s(t,e,n)),o=h(s(t,e,i)),a=h(s(n,i,t)),l=h(s(n,i,e));return!!(r!==o&&a!==l||0===r&&c(t,n,e)||0===o&&c(t,i,e)||0===a&&c(n,t,i)||0===l&&c(n,e,i))}function c(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function h(t){return t>0?1:t<0?-1:0}function f(t,e){return 0>s(t.prev,t,t.next)?s(t,e,t.next)>=0&&s(t,t.prev,e)>=0:0>s(t,e,t.prev)||0>s(t,t.next,e)}function d(t,e){var n=new p(t.i,t.x,t.y),i=new p(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function v(t,e,n,i){var r=new p(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function g(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function p(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function y(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(y(t,0,o,n));if(r)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(y(t,u,c,n))}var h=0;for(s=0;s<i.length;s+=3){var f=i[s]*n,d=i[s+1]*n,v=i[s+2]*n;h+=Math.abs((t[f]-t[v])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[v+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},645:function(t,e){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */e.read=function(t,e,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?r-1:0,f=n?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;c>0;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,i),o-=u}return(d?-1:1)*a*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var a,s,l,u=8*o-r-1,c=(1<<u)-1,h=c>>1,f=23===r?5960464477539062e-23:0,d=i?0:o-1,v=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+h>=1?e+=f/l:e+=f*Math.pow(2,1-h),e*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+d]=255&s,d+=v,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[n+d]=255&a,d+=v,a/=256,u-=8);t[n+d-v]|=128*g}},5826:function(t){var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},5505:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AmpStateContext=void 0;var i=(0,n(2648).Z)(n(7294)).default.createContext({});e.AmpStateContext=i},1342:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isInAmpMode=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.ampFirst,n=t.hybrid,i=t.hasQuery;return void 0!==e&&e||void 0!==n&&n&&void 0!==i&&i}},1597:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultHead=c,e.default=void 0;var i=n(6495).Z,r=n(2648).Z,o=(0,n(1598).Z)(n(7294)),a=r(n(7271)),s=n(5505),l=n(236),u=n(1342);function c(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[o.default.createElement("meta",{charSet:"utf-8"})];return t||e.push(o.default.createElement("meta",{name:"viewport",content:"width=device-width"})),e}function h(t,e){return"string"==typeof e||"number"==typeof e?t:e.type===o.default.Fragment?t.concat(o.default.Children.toArray(e.props.children).reduce(function(t,e){return"string"==typeof e||"number"==typeof e?t:t.concat(e)},[])):t.concat(e)}n(3766);var f=["name","httpEquiv","charSet","itemProp"];function d(t,e){var n,r,a,s,l=e.inAmpMode;return t.reduce(h,[]).reverse().concat(c(l).reverse()).filter((n=new Set,r=new Set,a=new Set,s={},function(t){var e=!0,i=!1;if(t.key&&"number"!=typeof t.key&&t.key.indexOf("$")>0){i=!0;var o=t.key.slice(t.key.indexOf("$")+1);n.has(o)?e=!1:n.add(o)}switch(t.type){case"title":case"base":r.has(t.type)?e=!1:r.add(t.type);break;case"meta":for(var l=0,u=f.length;l<u;l++){var c=f[l];if(t.props.hasOwnProperty(c)){if("charSet"===c)a.has(c)?e=!1:a.add(c);else{var h=t.props[c],d=s[c]||new Set;("name"!==c||!i)&&d.has(h)?e=!1:(d.add(h),s[c]=d)}}}}return e})).reverse().map(function(t,e){var n=t.key||e;if(!l&&"link"===t.type&&t.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(function(e){return t.props.href.startsWith(e)})){var r=i({},t.props||{});return r["data-href"]=r.href,r.href=void 0,r["data-optimized-fonts"]=!0,o.default.cloneElement(t,r)}return o.default.cloneElement(t,{key:n})})}e.default=function(t){var e=t.children,n=o.useContext(s.AmpStateContext),i=o.useContext(l.HeadManagerContext);return o.default.createElement(a.default,{reduceComponentsToState:d,headManager:i,inAmpMode:u.isInAmpMode(n)},e)},("function"==typeof e.default||"object"==typeof e.default&&null!==e.default)&&void 0===e.default.__esModule&&(Object.defineProperty(e.default,"__esModule",{value:!0}),Object.assign(e.default,e),t.exports=e.default)},7271:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.headManager,s=t.reduceComponentsToState;function l(){if(n&&n.mountedInstances){var e=i.Children.toArray(Array.from(n.mountedInstances).filter(Boolean));n.updateHead(s(e,t))}}return r&&(null==n||null==(e=n.mountedInstances)||e.add(t.children),l()),o(function(){var e;return null==n||null==(e=n.mountedInstances)||e.add(t.children),function(){var e;null==n||null==(e=n.mountedInstances)||e.delete(t.children)}}),o(function(){return n&&(n._pendingUpdate=l),function(){n&&(n._pendingUpdate=l)}}),a(function(){return n&&n._pendingUpdate&&(n._pendingUpdate(),n._pendingUpdate=null),function(){n&&n._pendingUpdate&&(n._pendingUpdate(),n._pendingUpdate=null)}}),null};var i=(0,n(1598).Z)(n(7294)),r=!1,o=i.useLayoutEffect,a=r?function(){}:i.useEffect},3766:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.warnOnce=void 0,e.warnOnce=function(t){}},4508:function(t,e,n){"use strict";var i=n(2262),r=n(2777),o=n(1531),a=n(3553),s=n(7247),l=n(6576),u={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"},c=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(t){(0,r.Z)(this,l);var e,i=u[t];return(e=n.call(this,i)).code=t,e.name="AssertionError",e.message=i,e}return(0,i.Z)(l)}((0,l.Z)(Error));e.Z=c},1093:function(t,e,n){"use strict";var i=n(2777),r=n(2262),o=function(){function t(){(0,i.Z)(this,t),this.disposed=!1}return(0,r.Z)(t,[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}]),t}();e.Z=o},9429:function(t,e,n){"use strict";var i=n(748),r=n(2262),o=n(2777),a=n(1531),s=n(3553),l=n(7247),u=n(7018),c=n(7317),h=n(6441),f=n(1148),d=n(1181);function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,l.Z)(t);if(e){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var g=function(t){(0,a.Z)(n,t);var e=v(n);function n(t,i,r){var a;return(0,o.Z)(this,n),(a=e.call(this,t)).key=i,a.oldValue=r,a}return(0,r.Z)(n)}(u.ZP),p=function(t){(0,a.Z)(n,t);var e=v(n);function n(t){var r;return(0,o.Z)(this,n),(r=e.call(this)).on,r.once,r.un,(0,f.sq)((0,i.Z)(r)),r.values_=null,void 0!==t&&r.setProperties(t),r}return(0,r.Z)(n,[{key:"get",value:function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Object.assign({},this.values_)||{}}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(t,e){var n;n="change:".concat(t),this.hasListener(n)&&this.dispatchEvent(new g(n,t,e)),n=c.Z.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new g(n,t,e))}},{key:"addChangeListener",value:function(t,e){this.addEventListener("change:".concat(t),e)}},{key:"removeChangeListener",value:function(t,e){this.removeEventListener("change:".concat(t),e)}},{key:"set",value:function(t,e,n){var i=this.values_||(this.values_={});if(n)i[t]=e;else{var r=i[t];i[t]=e,r!==e&&this.notify(t,r)}}},{key:"setProperties",value:function(t,e){for(var n in t)this.set(n,t[n],e)}},{key:"applyProperties",value:function(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}},{key:"unset",value:function(t,e){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],(0,d.x)(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}]),n}(h.Z);e.Z=p},7317:function(t,e){"use strict";e.Z={PROPERTYCHANGE:"propertychange"}},6441:function(t,e,n){"use strict";var i=n(2777),r=n(2262),o=n(1531),a=n(3553),s=n(7247),l=n(8982),u=n(9879),c=n(391),h=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(){var t;return(0,i.Z)(this,l),(t=n.call(this)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return(0,r.Z)(l,[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(u.Z.CHANGE)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(t,e){if(Array.isArray(t)){for(var n=t.length,i=Array(n),r=0;r<n;++r)i[r]=(0,c.oL)(this,t[r],e);return i}return(0,c.oL)(this,t,e)}},{key:"onceInternal",value:function(t,e){var n;if(Array.isArray(t)){var i=t.length;n=Array(i);for(var r=0;r<i;++r)n[r]=(0,c.Vx)(this,t[r],e)}else n=(0,c.Vx)(this,t,e);return e.ol_key=n,n}},{key:"unInternal",value:function(t,e){var n=e.ol_key;if(n)(function(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)(0,c.bN)(t[e]);else(0,c.bN)(t)})(n);else if(Array.isArray(t))for(var i=0,r=t.length;i<r;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}]),l}(l.Z);h.prototype.on,h.prototype.once,h.prototype.un,e.Z=h},2955:function(t,e,n){"use strict";function i(t,e,n){n=n||r;for(var i,o,a=0,s=t.length,l=!1;a<s;)(o=+n(t[i=a+(s-a>>1)],e))<0?a=i+1:(s=i,l=!o);return l?a:~a}function r(t,e){return t>e?1:t<e?-1:0}function o(t,e,n){var i,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(n>0){for(i=1;i<r;++i)if(t[i]<e)return i-1}else if(n<0){for(i=1;i<r;++i)if(t[i]<=e)return i}else for(i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e){if("function"==typeof n){if(n(e,t[i-1],t[i])>0)return i-1}else if(t[i-1]-e<e-t[i])return i-1;return i}}return r-1}function a(t,e,n){for(;e<n;){var i=t[e];t[e]=t[n],t[n]=i,++e,--n}}function s(t,e){for(var n=Array.isArray(e)?e:[e],i=n.length,r=0;r<i;r++)t[t.length]=n[r]}function l(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function u(t,e,n){var i=e||r;return t.every(function(e,r){if(0===r)return!0;var o=i(t[r-1],e);return!(o>0||n&&0===o)})}n.d(e,{FZ:function(){return a},fS:function(){return l},h7:function(){return o},j2:function(){return r},l7:function(){return s},pT:function(){return u},ry:function(){return i}})},9201:function(t,e,n){"use strict";n.d(e,{h:function(){return r}});var i=n(4508);function r(t,e){if(!t)throw new i.Z(e)}},4155:function(t,e,n){"use strict";n.d(e,{ZK:function(){return o}});var i={info:1,warn:2,error:3,none:4},r=i.info;function o(){var t;r>i.warn||(t=console).warn.apply(t,arguments)}},5360:function(t,e,n){"use strict";n.d(e,{Bs:function(){return v},Cf:function(){return g},I8:function(){return l},IH:function(){return a},TE:function(){return d},U1:function(){return c},bA:function(){return h},bI:function(){return f},fS:function(){return u},oL:function(){return s}});var i=n(4764),r=n(9441),o=n(3270);function a(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function s(t,e){var n,i,r=t[0],o=t[1],a=e[0],s=e[1],l=a[0],u=a[1],c=s[0],h=s[1],f=c-l,d=h-u,v=0===f&&0===d?0:(f*(r-l)+d*(o-u))/(f*f+d*d||0);return v<=0?(n=l,i=u):v>=1?(n=c,i=h):(n=l+v*f,i=u+v*d),[n,i]}function l(t,e,n){var i=(0,r.$W)(e+180,360)-180,a=Math.abs(3600*i),s=n||0,l=Math.floor(a/3600),u=Math.floor((a-3600*l)/60),c=(0,r.FH)(a-3600*l-60*u,s);c>=60&&(c=0,u+=1),u>=60&&(u=0,l+=1);var h=l+"\xb0";return(0!==u||0!==c)&&(h+=" "+(0,o.v)(u,2)+"′"),0!==c&&(h+=" "+(0,o.v)(c,2,s)+"″"),0!==i&&(h+=" "+t.charAt(i<0?1:0)),h}function u(t,e){for(var n=!0,i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function c(t,e){var n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,o=t[1]*n+t[0]*i;return t[0]=r,t[1]=o,t}function h(t,e){return t[0]*=e,t[1]*=e,t}function f(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function d(t,e){return Math.sqrt(f(t,e))}function v(t,e){return f(t,s(t,e))}function g(t,e){if(e.canWrapX()){var n,r,o,a=(0,i.dz)(e.getExtent()),s=(n=a,r=e.getExtent(),o=0,e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||(0,i.dz)(r),o=Math.floor((t[0]-r[0])/n)),o);s&&(t[0]-=s*a)}return t}},391:function(t,e,n){"use strict";n.d(e,{Vx:function(){return o},bN:function(){return a},oL:function(){return r}});var i=n(1181);function r(t,e,n,i,r){if(i&&i!==t&&(n=n.bind(i)),r){var o=n;n=function(){t.removeEventListener(e,n),o.apply(this,arguments)}}var a={target:t,type:e,listener:n};return t.addEventListener(e,n),a}function o(t,e,n,i){return r(t,e,n,i,!0)}function a(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),(0,i.Z)(t))}},7018:function(t,e,n){"use strict";n.d(e,{UW:function(){return a}});var i=n(2777),r=n(2262),o=function(){function t(e){(0,i.Z)(this,t),this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return(0,r.Z)(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),t}();function a(t){t.stopPropagation()}e.ZP=o},9879:function(t,e){"use strict";e.Z={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"}},8982:function(t,e,n){"use strict";var i=n(2777),r=n(2262),o=n(1531),a=n(3553),s=n(7247),l=n(1093),u=n(7018),c=n(518),h=n(1181),f=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(t){var e;return(0,i.Z)(this,l),(e=n.call(this)).eventTarget_=t,e.pendingRemovals_=null,e.dispatching_=null,e.listeners_=null,e}return(0,r.Z)(l,[{key:"addEventListener",value:function(t,e){if(t&&e){var n=this.listeners_||(this.listeners_={}),i=n[t]||(n[t]=[]);i.includes(e)||i.push(e)}}},{key:"dispatchEvent",value:function(t){var e,n="string"==typeof t,i=n?t:t.type,r=this.listeners_&&this.listeners_[i];if(r){var o=n?new u.ZP(t):t;o.target||(o.target=this.eventTarget_||this);var a=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});i in a||(a[i]=0,s[i]=0),++a[i];for(var l=0,h=r.length;l<h;++l)if(!1===(e="handleEvent"in r[l]?r[l].handleEvent(o):r[l].call(this,o))||o.propagationStopped){e=!1;break}if(0==--a[i]){var f=s[i];for(delete s[i];f--;)this.removeEventListener(i,c.Zn);delete a[i]}return e}}},{key:"disposeInternal",value:function(){this.listeners_&&(0,h.Z)(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_&&this.listeners_[t]||void 0}},{key:"hasListener",value:function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(t,e){var n=this.listeners_&&this.listeners_[t];if(n){var i=n.indexOf(e);-1!==i&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=c.Zn,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}}}]),l}(l.Z);e.Z=f},4764:function(t,e,n){"use strict";n.d(e,{Cf:function(){return X},Cr:function(){return O},EO:function(){return B},Ed:function(){return A},GN:function(){return _},H6:function(){return T},H9:function(){return G},HK:function(){return y},I7:function(){return U},MV:function(){return j},Ne:function(){return z},T9:function(){return g},Wj:function(){return E},Xv:function(){return M},YN:function(){return p},b8:function(){return c},bg:function(){return C},d9:function(){return l},dY:function(){return b},dz:function(){return D},f3:function(){return s},fS:function(){return m},g0:function(){return Z},hC:function(){return S},hI:function(){return a},iW:function(){return x},jE:function(){return f},kK:function(){return F},l7:function(){return R},lJ:function(){return v},p8:function(){return I},pX:function(){return d},qP:function(){return k},qf:function(){return u},qg:function(){return P},r4:function(){return h},rL:function(){return L},w$:function(){return w},xb:function(){return N}});var i=n(6835),r=n(2568),o=n(9201);function a(t){for(var e=v(),n=0,i=t.length;n<i;++n)E(e,t[n]);return e}function s(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function l(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function u(t,e,n){var i,r;return(i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*i+(r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*r}function c(t,e){return f(t,e[0],e[1])}function h(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function f(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function d(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],l=e[1],u=r.Z.UNKNOWN;return s<n?u|=r.Z.LEFT:s>o&&(u|=r.Z.RIGHT),l<i?u|=r.Z.BELOW:l>a&&(u|=r.Z.ABOVE),u===r.Z.UNKNOWN&&(u=r.Z.INTERSECTING),u}function v(){return[1/0,1/0,-1/0,-1/0]}function g(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function p(t){return g(1/0,1/0,-1/0,-1/0,t)}function y(t,e){var n=t[0],i=t[1];return g(n,i,n,i,e)}function _(t,e,n,i,r){return k(p(r),t,e,n,i)}function m(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function x(t,e,n){return Math.abs(t[0]-e[0])<n&&Math.abs(t[2]-e[2])<n&&Math.abs(t[1]-e[1])<n&&Math.abs(t[3]-e[3])<n}function R(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function E(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function k(t,e,n,i,r){for(;n<i;n+=r){var o,a,s;o=t,a=e[n],s=e[n+1],o[0]=Math.min(o[0],a),o[1]=Math.min(o[1],s),o[2]=Math.max(o[2],a),o[3]=Math.max(o[3],s)}return t}function T(t,e){var n;return!!((n=e(S(t)))||(n=e(w(t)))||(n=e(M(t)))||(n=e(L(t))))&&n}function C(t){var e=0;return N(t)||(e=D(t)*O(t)),e}function S(t){return[t[0],t[1]]}function w(t){return[t[2],t[1]]}function P(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Z(t,e){var n;return"bottom-left"===e?n=S(t):"bottom-right"===e?n=w(t):"top-left"===e?n=L(t):"top-right"===e?n=M(t):(0,o.h)(!1,13),n}function I(t,e,n,r,o){var a=b(t,e,n,r),s=(0,i.Z)(a,8),l=s[0],u=s[1],c=s[2],h=s[3],f=s[4],d=s[5],v=s[6],p=s[7];return g(Math.min(l,c,f,v),Math.min(u,h,d,p),Math.max(l,c,f,v),Math.max(u,h,d,p),o)}function b(t,e,n,i){var r=e*i[0]/2,o=e*i[1]/2,a=Math.cos(n),s=Math.sin(n),l=r*a,u=r*s,c=o*a,h=o*s,f=t[0],d=t[1];return[f-l+h,d-u-c,f-l-h,d-u+c,f+l-h,d+u+c,f+l+h,d+u-c,f-l+h,d-u-c]}function O(t){return t[3]-t[1]}function A(t,e,n){var i=n||v();return F(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):p(i),i}function L(t){return[t[0],t[3]]}function M(t){return[t[2],t[3]]}function D(t){return t[2]-t[0]}function F(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function N(t){return t[2]<t[0]||t[3]<t[1]}function B(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function G(t,e){var n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i}function U(t,e,n){var i=!1,o=d(t,e),a=d(t,n);if(o===r.Z.INTERSECTING||a===r.Z.INTERSECTING)i=!0;else{var s,l,u=t[0],c=t[1],h=t[2],f=t[3],v=e[0],g=e[1],p=n[0],y=n[1],_=(y-g)/(p-v);a&r.Z.ABOVE&&!(o&r.Z.ABOVE)&&(i=(s=p-(y-f)/_)>=u&&s<=h),i||!(a&r.Z.RIGHT)||o&r.Z.RIGHT||(i=(l=y-(p-h)*_)>=c&&l<=f),i||!(a&r.Z.BELOW)||o&r.Z.BELOW||(i=(s=p-(y-c)/_)>=u&&s<=h),i||!(a&r.Z.LEFT)||o&r.Z.LEFT||(i=(l=y-(p-u)*_)>=c&&l<=f)}return i}function z(t,e,n,i){var r=[];if(i>1)for(var o=t[2]-t[0],a=t[3]-t[1],s=0;s<i;++s)r.push(t[0]+o*s/i,t[1],t[2],t[1]+a*s/i,t[2]-o*s/i,t[3],t[0],t[3]-a*s/i);else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);for(var l=[],u=[],c=0,h=r.length;c<h;c+=2)l.push(r[c]),u.push(r[c+1]);return g(Math.min.apply(null,l),Math.min.apply(null,u),Math.max.apply(null,l),Math.max.apply(null,u),n)}function X(t,e){var n=e.getExtent(),i=P(t);if(e.canWrapX()&&(i[0]<n[0]||i[0]>=n[2])){var r=D(n),o=Math.floor((i[0]-n[0])/r)*r;t[0]-=o,t[2]-=o}return t}function j(t,e){if(e.canWrapX()){var n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];X(t,e);var i=D(n);if(D(t)>i)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+i,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-i,t[3]]]}return[t]}},2568:function(t,e){"use strict";e.Z={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}},518:function(t,e,n){"use strict";n.d(e,{Dv:function(){return o},Zn:function(){return a},qe:function(){return s},uX:function(){return r}});var i=n(2955);function r(){return!0}function o(){return!1}function a(){}function s(t){var e,n,r,o=!1;return function(){var a=Array.prototype.slice.call(arguments);return o&&this===r&&(0,i.fS)(a,n)||(o=!0,r=this,n=a,e=t.apply(this,arguments)),e}}},3849:function(t,e,n){"use strict";var i=n(2777),r=n(2262),o=n(1531),a=n(3553),s=n(7247),l=n(9429),u=n(1148),c=n(4054),h=n(4764),f=n(5581),d=n(518),v=n(2456),g=(0,c.Ue)(),p=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(){var t;return(0,i.Z)(this,l),(t=n.call(this)).extent_=(0,h.lJ)(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(0,d.qe)(function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);var i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)}),t}return(0,r.Z)(l,[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return(0,u.O3)()}},{key:"closestPointXY",value:function(t,e,n,i){return(0,u.O3)()}},{key:"containsXY",value:function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}},{key:"getClosestPoint",value:function(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return(0,u.O3)()}},{key:"getExtent",value:function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&(0,h.YN)(e),this.extentRevision_=this.getRevision()}return(0,h.EO)(this.extent_,t)}},{key:"rotate",value:function(t,e){(0,u.O3)()}},{key:"scale",value:function(t,e,n){(0,u.O3)()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return(0,u.O3)()}},{key:"getType",value:function(){return(0,u.O3)()}},{key:"applyTransform",value:function(t){(0,u.O3)()}},{key:"intersectsExtent",value:function(t){return(0,u.O3)()}},{key:"translate",value:function(t,e){(0,u.O3)()}},{key:"transform",value:function(t,e){var n=(0,f.U2)(t),i="tile-pixels"==n.getUnits()?function(t,i,r){var o=n.getExtent(),a=n.getWorldExtent(),s=(0,h.Cr)(a)/(0,h.Cr)(o);return(0,c.qC)(g,a[0],a[3],s,-s,0,0,0),(0,v.vT)(t,0,t.length,r,g,i),(0,f.Ck)(n,e)(t,i,r)}:(0,f.Ck)(n,e);return this.applyTransform(i),this}}]),l}(l.Z);e.Z=p},3379:function(t,e,n){"use strict";var i=n(2777),r=n(2262),o=n(1531),a=n(3553),s=n(7247),l=n(5815),u=n(4764),c=n(5030),h=n(9441),f=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(t,e){var r;return(0,i.Z)(this,l),(r=n.call(this)).setCoordinates(t,e),r}return(0,r.Z)(l,[{key:"clone",value:function(){var t=new l(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){var r=this.flatCoordinates,o=(0,h.bI)(t,e,r[0],r[1]);if(o<i){for(var a=this.stride,s=0;s<a;++s)n[s]=r[s];return n.length=a,o}return i}},{key:"getCoordinates",value:function(){return this.flatCoordinates?this.flatCoordinates.slice():[]}},{key:"computeExtent",value:function(t){return(0,u.HK)(this.flatCoordinates,t)}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(t){return(0,u.jE)(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,c.IG)(this.flatCoordinates,0,t,this.stride),this.changed()}}]),l}(l.ZP);e.Z=f},5815:function(t,e,n){"use strict";n.d(e,{Kr:function(){return v},tP:function(){return d}});var i=n(2777),r=n(2262),o=n(1531),a=n(3553),s=n(7247),l=n(3849),u=n(1148),c=n(4764),h=n(2456),f=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(){var t;return(0,i.Z)(this,l),(t=n.call(this)).layout="XY",t.stride=2,t.flatCoordinates=null,t}return(0,r.Z)(l,[{key:"computeExtent",value:function(t){return(0,c.GN)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return(0,u.O3)()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=d(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){(0,u.O3)()}},{key:"setLayout",value:function(t,e,n){var i;if(t)i=d(t);else{for(var r,o,a=0;a<n;++a){if(0===e.length){this.layout="XY",this.stride=2;return}e=e[0]}2==(r=i=e.length)?o="XY":3==r?o="XYZ":4==r&&(o="XYZM"),t=o}this.layout=t,this.stride=i}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();(0,h.U1)(n,0,n.length,i,t,e,n),this.changed()}}},{key:"scale",value:function(t,e,n){void 0===e&&(e=t),n||(n=(0,c.qg)(this.getExtent()));var i=this.getFlatCoordinates();if(i){var r=this.getStride();(0,h.bA)(i,0,i.length,r,t,e,n,i),this.changed()}}},{key:"translate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();(0,h.Iu)(n,0,n.length,i,t,e,n),this.changed()}}}]),l}(l.Z);function d(t){var e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}function v(t,e,n){var i=t.getFlatCoordinates();if(!i)return null;var r=t.getStride();return(0,h.vT)(i,0,i.length,r,e,n)}e.ZP=f},5030:function(t,e,n){"use strict";function i(t,e,n,i){for(var r=0,o=n.length;r<o;++r)t[e++]=n[r];return e}function r(t,e,n,i){for(var r=0,o=n.length;r<o;++r)for(var a=n[r],s=0;s<i;++s)t[e++]=a[s];return e}function o(t,e,n,i,o){o=o||[];for(var a=0,s=0,l=n.length;s<l;++s){var u=r(t,e,n[s],i);o[a++]=u,e=u}return o.length=a,o}function a(t,e,n,i,r){r=r||[];for(var a=0,s=0,l=n.length;s<l;++s){var u=o(t,e,n[s],i,r[a]);0===u.length&&(u[0]=e),r[a++]=u,e=u[u.length-1]}return r.length=a,r}n.d(e,{IG:function(){return i},QT:function(){return a},Sg:function(){return r},_5:function(){return o}})},2456:function(t,e,n){"use strict";function i(t,e,n,i,r,o){o=o||[];for(var a=0,s=e;s<n;s+=i){var l=t[s],u=t[s+1];o[a++]=r[0]*l+r[2]*u+r[4],o[a++]=r[1]*l+r[3]*u+r[5]}return o&&o.length!=a&&(o.length=a),o}function r(t,e,n,i,r,o,a){a=a||[];for(var s=Math.cos(r),l=Math.sin(r),u=o[0],c=o[1],h=0,f=e;f<n;f+=i){var d=t[f]-u,v=t[f+1]-c;a[h++]=u+d*s-v*l,a[h++]=c+d*l+v*s;for(var g=f+2;g<f+i;++g)a[h++]=t[g]}return a&&a.length!=h&&(a.length=h),a}function o(t,e,n,i,r,o,a,s){s=s||[];for(var l=a[0],u=a[1],c=0,h=e;h<n;h+=i){var f=t[h]-l,d=t[h+1]-u;s[c++]=l+r*f,s[c++]=u+o*d;for(var v=h+2;v<h+i;++v)s[c++]=t[v]}return s&&s.length!=c&&(s.length=c),s}function a(t,e,n,i,r,o,a){a=a||[];for(var s=0,l=e;l<n;l+=i){a[s++]=t[l]+r,a[s++]=t[l+1]+o;for(var u=l+2;u<l+i;++u)a[s++]=t[u]}return a&&a.length!=s&&(a.length=s),a}n.d(e,{Iu:function(){return a},U1:function(){return r},bA:function(){return o},vT:function(){return i}})},6991:function(t,e,n){"use strict";n.d(e,{G$:function(){return a},Id:function(){return u},ME:function(){return o},MP:function(){return l},Tp:function(){return c},V:function(){return r},bM:function(){return h},tK:function(){return s}});var i="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",r=i.includes("firefox"),o=i.includes("safari")&&!i.includes("chrom")&&(i.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(i)),a=i.includes("webkit")&&!i.includes("edge"),s=i.includes("macintosh"),l="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,u="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,c="undefined"!=typeof Image&&Image.prototype.decode,h=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}()},9441:function(t,e,n){"use strict";function i(t,e,n){return Math.min(Math.max(t,e),n)}function r(t,e,n,i,r,a){var s=r-n,l=a-i;if(0!==s||0!==l){var u=((t-n)*s+(e-i)*l)/(s*s+l*l);u>1?(n=r,i=a):u>0&&(n+=s*u,i+=l*u)}return o(t,e,n,i)}function o(t,e,n,i){var r=n-t,o=i-e;return r*r+o*o}function a(t){for(var e=t.length,n=0;n<e;n++){for(var i=n,r=Math.abs(t[n][n]),o=n+1;o<e;o++){var a=Math.abs(t[o][n]);a>r&&(r=a,i=o)}if(0===r)return null;var s=t[i];t[i]=t[n],t[n]=s;for(var l=n+1;l<e;l++)for(var u=-t[l][n]/t[n][n],c=n;c<e+1;c++)n==c?t[l][c]=0:t[l][c]+=u*t[n][c]}for(var h=Array(e),f=e-1;f>=0;f--){h[f]=t[f][e]/t[f][f];for(var d=f-1;d>=0;d--)t[d][e]-=t[d][f]*h[f]}return h}function s(t){return 180*t/Math.PI}function l(t){return t*Math.PI/180}function u(t,e){var n=t%e;return n*e<0?n+e:n}function c(t,e,n){return t+n*(e-t)}function h(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}function f(t,e){return Math.round(h(t,e))}function d(t,e){return Math.floor(h(t,e))}function v(t,e){return Math.ceil(h(t,e))}n.d(e,{$W:function(){return u},FH:function(){return h},GW:function(){return d},NM:function(){return f},SV:function(){return a},Ux:function(){return s},Yr:function(){return l},bI:function(){return o},mD:function(){return v},rU:function(){return r},t7:function(){return c},uZ:function(){return i}})},1181:function(t,e,n){"use strict";function i(t){for(var e in t)delete t[e]}function r(t){var e;for(e in t)return!1;return!e}n.d(e,{Z:function(){return i},x:function(){return r}})},5581:function(t,e,n){"use strict";n.d(e,{Wm:function(){return l},UQ:function(){return M},h_:function(){return P},OP:function(){return F},mi:function(){return D},Vs:function(){return j},dY:function(){return Y},U2:function(){return O},_Q:function(){return A},Ck:function(){return B},WO:function(){return N},Cs:function(){return z},gD:function(){return I},lO:function(){return X},Fj:function(){return W},on:function(){return V},vs:function(){return G},$A:function(){return U}});var i=n(2262),r=n(2777),o=n(1531),a=n(3553),s=n(7247),l={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},u=function(){function t(e){(0,r.Z)(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return(0,i.Z)(t,[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||l[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}]),t}(),c=6378137*Math.PI,h=[-c,-c,c,c],f=[-180,-85,180,85],d=6378137*Math.log(Math.tan(Math.PI/2)),v=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(t){return(0,r.Z)(this,l),n.call(this,{code:t,units:"m",extent:h,global:!0,worldExtent:f,getPointResolution:function(t,e){return t/Math.cosh(e[1]/6378137)}})}return(0,i.Z)(l)}(u),g=[new v("EPSG:3857"),new v("EPSG:102100"),new v("EPSG:102113"),new v("EPSG:900913"),new v("http://www.opengis.net/def/crs/EPSG/0/3857"),new v("http://www.opengis.net/gml/srs/epsg.xml#3857")],p=[-180,-90,180,90],y=6378137*Math.PI/180,_=function(t){(0,o.Z)(l,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,s.Z)(l);if(e){var i=(0,s.Z)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.Z)(this,t)});function l(t,e){return(0,r.Z)(this,l),n.call(this,{code:t,units:"degrees",extent:p,axisOrientation:e,global:!0,metersPerUnit:y,worldExtent:p})}return(0,i.Z)(l)}(u),m=[new _("CRS:84"),new _("EPSG:4326","neu"),new _("urn:ogc:def:crs:OGC:1.3:CRS84"),new _("urn:ogc:def:crs:OGC:2:84"),new _("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new _("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new _("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],x={},R={};function E(t,e,n){var i=t.getCode(),r=e.getCode();i in R||(R[i]={}),R[i][r]=n}var k=n(4764),T=n(5360),C=n(7934),S=n(4155),w=!0;function P(t){w=!(void 0===t||t)}function Z(t,e){if(void 0!==e)for(var n=0,i=t.length;n<i;++n)e[n]=t[n];else e=t.slice();return e}function I(t,e){if(void 0!==e&&t!==e){for(var n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function b(t){x[t.getCode()]=t,E(t,t,Z)}function O(t){return"string"==typeof t?x[t]||x[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null}function A(t,e,n,i){var r,o=(t=O(t)).getPointResolutionFunc();if(o){if(r=o(e,n),i&&i!==t.getUnits()){var a=t.getMetersPerUnit();a&&(r=r*a/l[i])}}else{var s=t.getUnits();if(("degrees"!=s||i)&&"degrees"!=i){var u=N(t,O("EPSG:4326"));if(u===I&&"degrees"!==s)r=e*t.getMetersPerUnit();else{var c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];c=u(c,c,2),r=((0,C.Sp)(c.slice(0,2),c.slice(2,4))+(0,C.Sp)(c.slice(4,6),c.slice(6,8)))/2}var h=i?l[i]:t.getMetersPerUnit();void 0!==h&&(r/=h)}else r=e}return r}function L(t){!function(t){t.forEach(b)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&E(e,t,Z)})})}function M(t,e){return t?"string"==typeof t?O(t):t:O(e)}function D(t,e){return P(),G(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function F(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?n:N(t,e)===Z&&n}function N(t,e){var n,i=t.getCode(),r=e.getCode(),o=(i in R&&r in R[i]&&(n=R[i][r]),n);return o||(o=I),o}function B(t,e){return N(O(t),O(e))}function G(t,e,n){return B(e,n)(t,void 0,t.length)}function U(t,e,n,i){var r=B(e,n);return(0,k.Ne)(t,r,void 0,i)}function z(){return null}function X(t,e){return t}function j(t,e){return w&&!(0,T.fS)(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(w=!1,(0,S.ZK)("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function W(t,e){return t}function Y(t,e){return t}function V(t,e){return t}L(g),L(m),function(t,e,n,i){t.forEach(function(t){e.forEach(function(e){E(t,e,n),E(e,t,i)})})}(m,g,function(t,e,n){var i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():Array(i));for(var r=0;r<i;r+=n){e[r]=c*t[r]/180;var o=6378137*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));o>d?o=d:o<-d&&(o=-d),e[r+1]=o}return e},function(t,e,n){var i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():Array(i));for(var r=0;r<i;r+=n)e[r]=180*t[r]/c,e[r+1]=360*Math.atan(Math.exp(t[r+1]/6378137))/Math.PI-90;return e})},7934:function(t,e,n){"use strict";n.d(e,{Sp:function(){return r},cv:function(){return o}});var i=n(9441);function r(t,e,n){n=n||6371008.8;var r=(0,i.Yr)(t[1]),o=(0,i.Yr)(e[1]),a=(o-r)/2,s=(0,i.Yr)(e[0]-t[0])/2,l=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function o(t,e,n,r){r=r||6371008.8;var o=(0,i.Yr)(t[1]),a=(0,i.Yr)(t[0]),s=e/r,l=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(n));return[(0,i.Ux)(a+Math.atan2(Math.sin(n)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(l))),(0,i.Ux)(l)]}},3270:function(t,e,n){"use strict";function i(t,e,n){var i=void 0!==n?t.toFixed(n):""+t,r=i.indexOf(".");return(r=-1===r?i.length:r)>e?i:Array(1+e-r).join("0")+i}function r(t,e){for(var n=(""+t).split("."),i=(""+e).split("."),r=0;r<Math.max(n.length,i.length);r++){var o=parseInt(n[r]||"0",10),a=parseInt(i[r]||"0",10);if(o>a)return 1;if(a>o)return -1}return 0}n.d(e,{n:function(){return r},v:function(){return i}})},4054:function(t,e,n){"use strict";n.d(e,{BB:function(){return m},Iu:function(){return p},Jp:function(){return u},U1:function(){return d},Ue:function(){return s},bA:function(){return v},lk:function(){return h},mc:function(){return l},n3:function(){return g},nb:function(){return _},nn:function(){return f},qC:function(){return y}});var i,r=n(6991),o=n(9201),a=Array(6);function s(){return[1,0,0,1,0,0]}function l(t){return c(t,1,0,0,1,0,0)}function u(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=e[0],u=e[1],c=e[2],h=e[3],f=e[4],d=e[5];return t[0]=n*l+r*u,t[1]=i*l+o*u,t[2]=n*c+r*h,t[3]=i*c+o*h,t[4]=n*f+r*d+a,t[5]=i*f+o*d+s,t}function c(t,e,n,i,r,o,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function f(t,e){var n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function d(t,e){var n=Math.cos(e),i=Math.sin(e);return u(t,c(a,n,i,-i,n,0,0))}function v(t,e,n){return u(t,c(a,e,0,0,n,0,0))}function g(t,e,n){return c(t,e,0,0,n,0,0)}function p(t,e,n){return u(t,c(a,1,0,0,1,e,n))}function y(t,e,n,i,r,o,a,s){var l=Math.sin(o),u=Math.cos(o);return t[0]=i*u,t[1]=r*l,t[2]=-i*l,t[3]=r*u,t[4]=a*i*u-s*i*l+e,t[5]=a*r*l+s*r*u+n,t}function _(t,e){var n=e[0]*e[3]-e[1]*e[2];(0,o.h)(0!==n,32);var i=e[0],r=e[1],a=e[2],s=e[3],l=e[4],u=e[5];return t[0]=s/n,t[1]=-r/n,t[2]=-a/n,t[3]=i/n,t[4]=(a*u-s*l)/n,t[5]=-(i*u-r*l)/n,t}function m(t){var e="matrix("+t.join(", ")+")";if(r.Id)return e;var n=i||(i=document.createElement("div"));return n.style.transform=e,n.style.transform}},1148:function(t,e,n){"use strict";function i(){throw Error("Unimplemented abstract method.")}n.d(e,{O3:function(){return i},sq:function(){return o}});var r=0;function o(t){return t.ol_uid||(t.ol_uid=String(++r))}},3511:function(t,e,n){"use strict";n.d(e,{j$:function(){return iD},jh:function(){return rD},rO:function(){return ny},H3:function(){return rU},Cs:function(){return sn},P_:function(){return l}});var i,r,o,a,s,l={};n.r(l),n.d(l,{JW:function(){return oP},P_:function(){return ib}});var u=n(2777),c=n(2262),h=n(1531),f=n(3553),d=n(7247),v=n(7294),g=v.createContext({}),p=n(46),y=void 0===p||void 0===p.env.RLAYERS_DEBUG?function(){}:console.debug.bind(window.console);function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var x=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"olEventName",value:function(t){return t.substring(2).toLowerCase()}},{key:"attachEventHandlers",value:function(){var t,e,n,i=this,r=null!==(t=this.eventSources)&&void 0!==t?t:[this.ol],o=Object.keys(this.props).filter(function(t){return t.startsWith("on")}),a=_(o.concat(Object.keys(null!==(e=this.handlers)&&void 0!==e?e:{}).filter(function(t){return!o.includes(t)})));try{for(a.s();!(n=a.n()).done;)!function(){var t=n.value;if(void 0===i.handlers&&(i.handlers={}),void 0!==i.handlers[t]&&void 0===i.props[t]){y("removing previously installed handler",i,t,i.handlers[t]);var e,o=_(r);try{for(o.s();!(e=o.n()).done;)e.value.un(i.olEventName(t),i.handlers[t])}catch(t){o.e(t)}finally{o.f()}i.handlers[t]=void 0}if(void 0===i.handlers[t]&&void 0!==i.props[t]){y("installing handler",i,t,i.props[t]),i.handlers[t]=function(e){return i.props[t].call(i,e)};var a,s=_(r);try{for(s.s();!(a=s.n()).done;)a.value.on(i.olEventName(t),i.handlers[t])}catch(t){s.e(t)}finally{s.f()}}}()}catch(t){a.e(t)}finally{a.f()}}},{key:"attachOldEventHandlers",value:function(t){if(this.handlers){var e,n=_(Object.keys(this.props).filter(function(t){return t.startsWith("on")}));try{for(n.s();!(e=n.n()).done;){var i=e.value;this.props[i]&&(y("reinstalling existing handler",this,i,this.props[i]),t.on(this.olEventName(i),this.handlers[i]))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"refresh",value:function(t){this.attachEventHandlers()}},{key:"componentDidMount",value:function(){y("didMount",this),this.refresh()}},{key:"propsDiff",value:function(t){if(null===this.props||null===t)return this.props!==t&&(y("null props differ",this.props,t),!0);for(var e=0,n=Object.keys(this.props);e<n.length;e++){var i=n[e];if(this.props[i]!==t[i])return y("because of",i,this.props[i],t[i]),!0}return!1}},{key:"componentDidUpdate",value:function(t,e,n){this.props!==t&&(y("willRefresh",this,t,this.props),this.refresh(t))}},{key:"componentWillUnmount",value:function(){y("willUnmount",this,this.handlers);for(var t=null!==(r=this.eventSources)&&void 0!==r?r:[this.ol],e=0,n=Object.keys(null!==(o=this.handlers)&&void 0!==o?o:{});e<n.length;e++){var i=n[e];if(y("cleaning up handler",this,i,this.handlers[i]),this.handlers[i]){var r,o,a,s=_(t);try{for(s.s();!(a=s.n()).done;)a.value.un(this.olEventName(i),this.handlers[i])}catch(t){s.e(t)}finally{s.f()}this.handlers[i]=void 0}}}},{key:"render",value:function(){return null}}]),i}(v.PureComponent);function R(t,e,n){return(R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,d.Z)(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}x.contextType=g;var E=n(748),k=n(9429),T=n(4508),C={ADD:"add",REMOVE:"remove"},S=n(7018);function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var P={LENGTH:"length"},Z=function(t){(0,h.Z)(n,t);var e=w(n);function n(t,i,r){var o;return(0,u.Z)(this,n),(o=e.call(this,t)).element=i,o.index=r,o}return(0,c.Z)(n)}(S.ZP),I=function(t){(0,h.Z)(n,t);var e=w(n);function n(t,i){var r;if((0,u.Z)(this,n),(r=e.call(this)).on,r.once,r.un,i=i||{},r.unique_=!!i.unique,r.array_=t||[],r.unique_)for(var o=0,a=r.array_.length;o<a;++o)r.assertUnique_(r.array_[o],o);return r.updateLength_(),r}return(0,c.Z)(n,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this}},{key:"forEach",value:function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)t(e[n],n,e)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get(P.LENGTH)}},{key:"insertAt",value:function(t,e){if(t<0||t>this.getLength())throw Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Z(C.ADD,e,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}},{key:"remove",value:function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}},{key:"removeAt",value:function(t){if(!(t<0||t>=this.getLength())){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Z(C.REMOVE,e,t)),e}}},{key:"setAt",value:function(t,e){if(t>=this.getLength()){this.insertAt(t,e);return}if(t<0)throw Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Z(C.REMOVE,n,t)),this.dispatchEvent(new Z(C.ADD,e,t))}},{key:"updateLength_",value:function(){this.set(P.LENGTH,this.array_.length)}},{key:"assertUnique_",value:function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new T.Z(58)}}]),n}(k.Z),b=n(1093),O=n(518),A=n(1148),L=n(4054),M=n(4764),D=n(9201),F=n(9441),N=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,B=/^([a-z]*)$|^hsla?\(.*\)$/i;function G(t){return"string"==typeof t?t:W(t)}function U(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var n=getComputedStyle(e).color;return document.body.removeChild(e),n}return""}var z=(i={},r=0,function(t){var e;if(i.hasOwnProperty(t))e=i[t];else{if(r>=1024){var n=0;for(var o in i)(3&n++)==0&&(delete i[o],--r)}e=function(t){var e,n,i,r,o;if(B.exec(t)&&(t=U(t)),N.exec(t)){var a,s=t.length-1;a=s<=4?1:2;var l=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),n=parseInt(t.substr(1+1*a,a),16),i=parseInt(t.substr(1+2*a,a),16),r=l?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,n=(n<<4)+n,i=(i<<4)+i,l&&(r=(r<<4)+r)),o=[e,n,i,r/255]}else t.startsWith("rgba(")?j(o=t.slice(5,-1).split(",").map(Number)):t.startsWith("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),j(o)):(0,D.h)(!1,14);return o}(t),i[t]=e,++r}return e});function X(t){return Array.isArray(t)?t:z(t)}function j(t){return t[0]=(0,F.uZ)(t[0]+.5|0,0,255),t[1]=(0,F.uZ)(t[1]+.5|0,0,255),t[2]=(0,F.uZ)(t[2]+.5|0,0,255),t[3]=(0,F.uZ)(t[3],0,1),t}function W(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function Y(t,e,n){return e+":"+t+":"+(n?G(n):"null")}var V=new(function(){function t(){(0,u.Z)(this,t),this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return(0,c.Z)(t,[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];(3&t++)==0&&!n.hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}}},{key:"get",value:function(t,e,n){var i=Y(t,e,n);return i in this.cache_?this.cache_[i]:null}},{key:"set",value:function(t,e,n,i){var r=Y(t,e,n);this.cache_[r]=i,++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}]),t}()),H={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"},K=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),(e=n.call(this)).on,e.once,e.un,e.background_=t.background;var e,r=Object.assign({},t);return"object"==typeof t.properties&&(delete r.properties,Object.assign(r,t.properties)),r[H.OPACITY]=void 0!==t.opacity?t.opacity:1,(0,D.h)("number"==typeof r[H.OPACITY],64),r[H.VISIBLE]=void 0===t.visible||t.visible,r[H.Z_INDEX]=t.zIndex,r[H.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,r[H.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,r[H.MIN_ZOOM]=void 0!==t.minZoom?t.minZoom:-1/0,r[H.MAX_ZOOM]=void 0!==t.maxZoom?t.maxZoom:1/0,e.className_=void 0!==r.className?r.className:"ol-layer",delete r.className,e.setProperties(r),e.state_=null,e}return(0,c.Z)(i,[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=(0,F.uZ)(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}},{key:"getLayersArray",value:function(t){return(0,A.O3)()}},{key:"getLayerStatesArray",value:function(t){return(0,A.O3)()}},{key:"getExtent",value:function(){return this.get(H.EXTENT)}},{key:"getMaxResolution",value:function(){return this.get(H.MAX_RESOLUTION)}},{key:"getMinResolution",value:function(){return this.get(H.MIN_RESOLUTION)}},{key:"getMinZoom",value:function(){return this.get(H.MIN_ZOOM)}},{key:"getMaxZoom",value:function(){return this.get(H.MAX_ZOOM)}},{key:"getOpacity",value:function(){return this.get(H.OPACITY)}},{key:"getSourceState",value:function(){return(0,A.O3)()}},{key:"getVisible",value:function(){return this.get(H.VISIBLE)}},{key:"getZIndex",value:function(){return this.get(H.Z_INDEX)}},{key:"setBackground",value:function(t){this.background_=t,this.changed()}},{key:"setExtent",value:function(t){this.set(H.EXTENT,t)}},{key:"setMaxResolution",value:function(t){this.set(H.MAX_RESOLUTION,t)}},{key:"setMinResolution",value:function(t){this.set(H.MIN_RESOLUTION,t)}},{key:"setMaxZoom",value:function(t){this.set(H.MAX_ZOOM,t)}},{key:"setMinZoom",value:function(t){this.set(H.MIN_ZOOM,t)}},{key:"setOpacity",value:function(t){(0,D.h)("number"==typeof t,64),this.set(H.OPACITY,t)}},{key:"setVisible",value:function(t){this.set(H.VISIBLE,t)}},{key:"setZIndex",value:function(t){this.set(H.Z_INDEX,t)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}}]),i}(k.Z),q=n(9879),J={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},$=n(391),Q=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=Object.assign({},t);delete r.source,(e=n.call(this,r)).on,e.once,e.un,e.mapPrecomposeKey_=null,e.mapRenderKey_=null,e.sourceChangeKey_=null,e.renderer_=null,e.sourceReady_=!1,e.rendered=!1,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addChangeListener(H.SOURCE,e.handleSourcePropertyChange_);var o=t.source?t.source:null;return e.setSource(o),e}return(0,c.Z)(i,[{key:"getLayersArray",value:function(t){return(t=t||[]).push(this),t}},{key:"getLayerStatesArray",value:function(t){return(t=t||[]).push(this.getLayerState()),t}},{key:"getSource",value:function(){return this.get(H.SOURCE)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():"undefined"}},{key:"handleSourceChange_",value:function(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}},{key:"handleSourcePropertyChange_",value:function(){var t=this;this.sourceChangeKey_&&((0,$.bN)(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;var e=this.getSource();e&&(this.sourceChangeKey_=(0,$.oL)(e,q.Z.CHANGE,this.handleSourceChange_,this),"ready"===e.getState()&&(this.sourceReady_=!0,setTimeout(function(){t.dispatchEvent("sourceready")},0))),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}},{key:"getData",value:function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}},{key:"render",value:function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return this.rendered=!0,n.renderFrame(t,e)}},{key:"unrender",value:function(){this.rendered=!1}},{key:"setMapInternal",value:function(t){t||this.unrender(),this.set(H.MAP,t)}},{key:"getMapInternal",value:function(){return this.get(H.MAP)}},{key:"setMap",value:function(t){this.mapPrecomposeKey_&&((0,$.bN)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&((0,$.bN)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=(0,$.oL)(t,J.PRECOMPOSE,function(t){var e=t.frameState.layerStatesArray,n=this.getLayerState(!1);(0,D.h)(!e.some(function(t){return t.layer===n.layer}),67),e.push(n)},this),this.mapRenderKey_=(0,$.oL)(this,q.Z.CHANGE,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(H.SOURCE,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}}]),i}(K);function tt(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}var te=n(5360),tn=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).map_=t,e}return(0,c.Z)(i,[{key:"dispatchRenderEvent",value:function(t,e){(0,A.O3)()}},{key:"calculateMatrices2D",value:function(t){var e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;(0,L.qC)(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),(0,L.nb)(i,n)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r,o,a,s){var l,u=e.viewState;function c(t,e,n,i){return r.call(o,e,t?n:null,i)}var h=u.projection,f=(0,te.Cf)(t.slice(),h),d=[[0,0]];if(h.canWrapX()&&i){var v=h.getExtent(),g=(0,M.dz)(v);d.push([-g,0],[g,0])}for(var p=e.layerStatesArray,y=p.length,_=[],m=[],x=0;x<d.length;x++)for(var R=y-1;R>=0;--R){var E=p[R],k=E.layer;if(k.hasRenderer()&&tt(E,u)&&a.call(s,k)){var T=k.getRenderer(),C=k.getSource();if(T&&C){var S=C.getWrapX()?f:t,w=c.bind(null,E.managed);m[0]=S[0]+d[x][0],m[1]=S[1]+d[x][1],l=T.forEachFeatureAtCoordinate(m,e,n,w,_)}if(l)return l}}if(0!==_.length){var P=1/_.length;return _.forEach(function(t,e){return t.distanceSq+=e*P}),_.sort(function(t,e){return t.distanceSq-e.distanceSq}),_.some(function(t){return l=t.callback(t.feature,t.layer,t.geometry)}),l}}},{key:"hasFeatureAtCoordinate",value:function(t,e,n,i,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,O.uX,this,r,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){(0,A.O3)()}},{key:"scheduleExpireIconCache",value:function(t){V.canExpireCache()&&t.postRenderFunctions.push(ti)}}]),i}(b.Z);function ti(t,e){V.expire()}var tr=n(7317),to=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){var a;return(0,u.Z)(this,i),(a=n.call(this,t)).inversePixelTransform=e,a.frameState=r,a.context=o,a}return(0,c.Z)(i)}(S.ZP),ta="ol-hidden",ts="ol-unselectable",tl="ol-control",tu="ol-collapsed",tc=RegExp("^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$","i"),th=["style","variant","weight","size","lineHeight","family"],tf=function(t){var e=t.match(tc);if(!e)return null;for(var n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},i=0,r=th.length;i<r;++i){var o=e[i+1];void 0!==o&&(n[th[i]]=o)}return n.families=n.family.split(/,\s?/),n},td=n(6991),tv=n(1181);function tg(t,e,n,i){var r;return r=n&&n.length?n.shift():td.Id?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",i)}function tp(t){var e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function ty(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function t_(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function tm(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var tx="10px sans-serif",tR="#000",tE="round",tk=[],tT="round",tC="#000",tS="center",tw="middle",tP=[0,0,0,0],tZ=new k.Z,tI=null,tb={},tO=function(){var t,e,n="32px ",i=["monospace","serif"],r=i.length,o="wmytzilWMYTZIL@#/&?$%10";function s(t,a,s){for(var l=!0,u=0;u<r;++u){var c=i[u];if(e=tM(t+" "+a+" "+n+c,o),s!=c){var h=tM(t+" "+a+" "+n+s+","+c,o);l=l&&h!=e}}return!!l}function l(){for(var e=!0,n=tZ.getKeys(),i=0,r=n.length;i<r;++i){var o=n[i];100>tZ.get(o)&&(s.apply(this,o.split("\n"))?((0,tv.Z)(tb),tI=null,a=void 0,tZ.set(o,100)):(tZ.set(o,tZ.get(o)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var n=tf(e);if(n)for(var i=n.families,r=0,o=i.length;r<o;++r){var a=i[r],u=n.style+"\n"+n.weight+"\n"+a;void 0!==tZ.get(u)||(tZ.set(u,100,!0),s(n.style,n.weight,a)||(tZ.set(u,0,!0),void 0===t&&(t=setInterval(l,32))))}}}(),tA=function(t){var e=tb[t];if(void 0==e){if(td.Id){var n=tf(t),i=tL(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else o||((o=document.createElement("div")).innerHTML="M",o.style.minHeight="0",o.style.maxHeight="none",o.style.height="auto",o.style.padding="0",o.style.border="none",o.style.position="absolute",o.style.display="block",o.style.left="-99999px"),o.style.font=t,document.body.appendChild(o),e=o.offsetHeight,document.body.removeChild(o);tb[t]=e}return e};function tL(t,e){return tI||(tI=tg(1,1)),t!=a&&(tI.font=t,a=tI.font),tI.measureText(e)}function tM(t,e){return tL(t,e).width}function tD(t,e,n){if(e in n)return n[e];var i=e.split("\n").reduce(function(e,n){return Math.max(e,tM(t,n))},0);return n[e]=i,i}var tF=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),(e=n.call(this,t)).fontChangeListenerKey_=(0,$.oL)(tZ,tr.Z.PROPERTYCHANGE,t.redrawText.bind(t)),e.element_=document.createElement("div");var e,r=e.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",e.element_.className=ts+" ol-layers";var o=t.getViewport();return o.insertBefore(e.element_,o.firstChild||null),e.children_=[],e.renderedVisible_=!0,e}return(0,c.Z)(i,[{key:"dispatchRenderEvent",value:function(t,e){var n=this.getMap();if(n.hasListener(t)){var i=new to(t,void 0,e);n.dispatchEvent(i)}}},{key:"disposeInternal",value:function(){(0,$.bN)(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(J.PRECOMPOSE,t);var e=t.layerStatesArray.sort(function(t,e){return t.zIndex-e.zIndex}),n=t.viewState;this.children_.length=0;for(var i=[],r=null,o=0,a=e.length;o<a;++o){var s=e[o];t.layerIndex=o;var l=s.layer,u=l.getSourceState();if(!tt(s,n)||"ready"!=u&&"undefined"!=u){l.unrender();continue}var c=l.render(t,r);c&&(c!==r&&(this.children_.push(c),r=c),"getDeclutter"in l&&i.push(l))}for(var h=i.length-1;h>=0;--h)i[h].renderDeclutter(t);(function(t,e){for(var n=t.childNodes,i=0;;++i){var r=n[i],o=e[i];if(!r&&!o)break;if(r!==o){if(!r){t.appendChild(o);continue}if(!o){t.removeChild(r),--i;continue}t.insertBefore(o,r)}}})(this.element_,this.children_),this.dispatchRenderEvent(J.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}}]),i}(tn);function tN(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var tB=function(t){(0,h.Z)(n,t);var e=tN(n);function n(t,i){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).layer=i,r}return(0,c.Z)(n)}(S.ZP),tG={LAYERS:"layers"},tU=function(t){(0,h.Z)(n,t);var e=tN(n);function n(t){(0,u.Z)(this,n);var i,r=Object.assign({},t=t||{});delete r.layers;var o=t.layers;return(i=e.call(this,r)).on,i.once,i.un,i.layersListenerKeys_=[],i.listenerKeys_={},i.addChangeListener(tG.LAYERS,i.handleLayersChanged_),o?Array.isArray(o)?o=new I(o.slice(),{unique:!0}):(0,D.h)("function"==typeof o.getArray,43):o=new I(void 0,{unique:!0}),i.setLayers(o),i}return(0,c.Z)(n,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach($.bN),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push((0,$.oL)(t,C.ADD,this.handleLayersAdd_,this),(0,$.oL)(t,C.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach($.bN);(0,tv.Z)(this.listenerKeys_);for(var n=t.getArray(),i=0,r=n.length;i<r;i++){var o=n[i];this.registerLayerListeners_(o),this.dispatchEvent(new tB("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(t){var e=[(0,$.oL)(t,tr.Z.PROPERTYCHANGE,this.handleLayerChange_,this),(0,$.oL)(t,q.Z.CHANGE,this.handleLayerChange_,this)];t instanceof n&&e.push((0,$.oL)(t,"addlayer",this.handleLayerGroupAdd_,this),(0,$.oL)(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,A.sq)(t)]=e}},{key:"handleLayerGroupAdd_",value:function(t){this.dispatchEvent(new tB("addlayer",t.layer))}},{key:"handleLayerGroupRemove_",value:function(t){this.dispatchEvent(new tB("removelayer",t.layer))}},{key:"handleLayersAdd_",value:function(t){var e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new tB("addlayer",e)),this.changed()}},{key:"handleLayersRemove_",value:function(t){var e=t.element,n=(0,A.sq)(e);this.listenerKeys_[n].forEach($.bN),delete this.listenerKeys_[n],this.dispatchEvent(new tB("removelayer",e)),this.changed()}},{key:"getLayers",value:function(){return this.get(tG.LAYERS)}},{key:"setLayers",value:function(t){var e=this.getLayers();if(e)for(var n=e.getArray(),i=0,r=n.length;i<r;++i)this.dispatchEvent(new tB("removelayer",n[i]));this.set(tG.LAYERS,t)}},{key:"getLayersArray",value:function(t){return t=void 0!==t?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}},{key:"getLayerStatesArray",value:function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});var i=this.getLayerState(),r=i.zIndex;t||void 0!==i.zIndex||(r=0);for(var o=n,a=e.length;o<a;o++){var s=e[o];s.opacity*=i.opacity,s.visible=s.visible&&i.visible,s.maxResolution=Math.min(s.maxResolution,i.maxResolution),s.minResolution=Math.max(s.minResolution,i.minResolution),s.minZoom=Math.max(s.minZoom,i.minZoom),s.maxZoom=Math.min(s.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==s.extent?s.extent=(0,M.Ed)(s.extent,i.extent):s.extent=i.extent),void 0===s.zIndex&&(s.zIndex=r)}return e}},{key:"getSourceState",value:function(){return"ready"}}]),n}(K),tz=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r){var o;return(0,u.Z)(this,i),(o=n.call(this,t)).map=e,o.frameState=void 0!==r?r:null,o}return(0,c.Z)(i)}(S.ZP),tX=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a,s){var l;return(0,u.Z)(this,i),(l=n.call(this,t,e,a)).originalEvent=r,l.pixel_=null,l.coordinate_=null,l.dragging=void 0!==o&&o,l.activePointers=s,l}return(0,c.Z)(i,[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}},{key:"preventDefault",value:function(){R((0,d.Z)(i.prototype),"preventDefault",this).call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){R((0,d.Z)(i.prototype),"stopPropagation",this).call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}]),i}(tz),tj={SINGLECLICK:"singleclick",CLICK:q.Z.CLICK,DBLCLICK:q.Z.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},tW={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},tY=n(8982),tV=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){(0,u.Z)(this,i),(r=n.call(this,t)).map_=t,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=void 0===e?1:e,r.down_=null;var r,o=r.map_.getViewport();return r.activePointers_=[],r.trackedTouches_={},r.element_=o,r.pointerdownListenerKey_=(0,$.oL)(o,tW.POINTERDOWN,r.handlePointerDown_,(0,E.Z)(r)),r.originalPointerMoveEvent_,r.relayedListenerKey_=(0,$.oL)(o,tW.POINTERMOVE,r.relayMoveEvent_,(0,E.Z)(r)),r.boundHandleTouchMove_=r.handleTouchMove_.bind((0,E.Z)(r)),r.element_.addEventListener(q.Z.TOUCHMOVE,r.boundHandleTouchMove_,!!td.bM&&{passive:!1}),r}return(0,c.Z)(i,[{key:"emulateClick_",value:function(t){var e=this,n=new tX(tj.CLICK,this.map_,t);this.dispatchEvent(n),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new tX(tj.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){e.clickTimeoutId_=void 0;var n=new tX(tj.SINGLECLICK,e.map_,t);e.dispatchEvent(n)},250)}},{key:"updateActivePointers_",value:function(t){var e=t.pointerId;if(t.type==tj.POINTERUP||t.type==tj.POINTERCANCEL){for(var n in delete this.trackedTouches_[e],this.trackedTouches_)if(this.trackedTouches_[n].target!==t.target){delete this.trackedTouches_[n];break}}else(t.type==tj.POINTERDOWN||t.type==tj.POINTERMOVE)&&(this.trackedTouches_[e]=t);this.activePointers_=Object.values(this.trackedTouches_)}},{key:"handlePointerUp_",value:function(t){this.updateActivePointers_(t);var e=new tX(tj.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach($.bN),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(t){return 0===t.button}},{key:"handlePointerDown_",value:function(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);var e=new tX(tj.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);for(var n in this.dispatchEvent(e),this.down_={},t){var i=t[n];this.down_[n]="function"==typeof i?O.Zn:i}if(0===this.dragListenerKeys_.length){var r=this.map_.getOwnerDocument();this.dragListenerKeys_.push((0,$.oL)(r,tj.POINTERMOVE,this.handlePointerMove_,this),(0,$.oL)(r,tj.POINTERUP,this.handlePointerUp_,this),(0,$.oL)(this.element_,tj.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push((0,$.oL)(this.element_.getRootNode(),tj.POINTERUP,this.handlePointerUp_,this))}}},{key:"handlePointerMove_",value:function(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;var e=new tX(tj.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}},{key:"relayMoveEvent_",value:function(t){this.originalPointerMoveEvent_=t;var e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new tX(tj.POINTERMOVE,this.map_,t,e))}},{key:"handleTouchMove_",value:function(t){var e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&("boolean"!=typeof t.cancelable||!0===t.cancelable)&&t.preventDefault()}},{key:"isMoving_",value:function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&((0,$.bN)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(q.Z.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,$.bN)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach($.bN),this.dragListenerKeys_.length=0,this.element_=null,R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}}]),i}(tY.Z),tH={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},tK={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},tq=1/0,tJ=function(){function t(e,n){(0,u.Z)(this,t),this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return(0,c.Z)(t,[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,(0,tv.Z)(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n}},{key:"enqueue",value:function(t){(0,D.h)(!(this.keyFunction_(t) in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=tq&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var e=this.elements_,n=this.priorities_,i=e.length,r=e[t],o=n[t],a=t;t<i>>1;){var s=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<i&&n[l]<n[s]?l:s;e[t]=e[u],n[t]=n[u],t=u}e[t]=r,n[t]=o,this.siftDown_(a,t)}},{key:"siftDown_",value:function(t,e){for(var n=this.elements_,i=this.priorities_,r=n[e],o=i[e];e>t;){var a=this.getParentIndex_(e);if(i[a]>o)n[e]=n[a],i[e]=i[a],e=a;else break}n[e]=r,i[e]=o}},{key:"reprioritize",value:function(){var t,e,n,i=this.priorityFunction_,r=this.elements_,o=this.priorities_,a=0,s=r.length;for(e=0;e<s;++e)(n=i(t=r[e]))==tq?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=n,r[a++]=t);r.length=a,o.length=a,this.heapify_()}}]),t}(),t$={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},tQ=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),(r=n.call(this,function(e){return t.apply(null,e)},function(t){return t[0].getKey()})).boundHandleTileChange_=r.handleTileChange.bind((0,E.Z)(r)),r.tileChangeCallback_=e,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return(0,c.Z)(i,[{key:"enqueue",value:function(t){var e=R((0,d.Z)(i.prototype),"enqueue",this).call(this,t);return e&&t[0].addEventListener(q.Z.CHANGE,this.boundHandleTileChange_),e}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var e=t.target,n=e.getState();if(n===t$.LOADED||n===t$.ERROR||n===t$.EMPTY){n!==t$.ERROR&&e.removeEventListener(q.Z.CHANGE,this.boundHandleTileChange_);var i=e.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(t,e){for(var n,i,r=0;this.tilesLoading_<t&&r<e&&this.getCount()>0;)i=(n=this.dequeue()[0]).getKey(),n.getState()!==t$.IDLE||i in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[i]=!0,++this.tilesLoading_,++r,n.load())}}]),i}(tJ),t0={ANIMATING:0,INTERACTING:1},t1={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},t2=n(5581);function t3(t,e,n){return function(i,r,o,a,s){if(i){if(!r&&!e)return i;var l=e?0:o[0]*r,u=e?0:o[1]*r,c=s?s[0]:0,h=s?s[1]:0,f=t[0]+l/2+c,d=t[2]-l/2+c,v=t[1]+u/2+h,g=t[3]-u/2+h;f>d&&(d=f=(d+f)/2),v>g&&(g=v=(g+v)/2);var p=(0,F.uZ)(i[0],f,d),y=(0,F.uZ)(i[1],v,g);if(a&&n&&r){var _=30*r;p+=-_*Math.log(1+Math.max(0,f-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-d)/_),y+=-_*Math.log(1+Math.max(0,v-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-g)/_)}return[p,y]}}}function t5(t){return t}var t4=n(2955);function t6(t,e,n,i){var r=(0,M.dz)(e)/n[0],o=(0,M.Cr)(e)/n[1];return i?Math.min(t,Math.max(r,o)):Math.min(t,Math.min(r,o))}function t8(t,e,n){var i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n)/(Math.log(1+50*Math.max(0,n/t-1))/50+1)),(0,F.uZ)(i,n/2,2*e)}function t7(t,e,n,i,r){return n=void 0===n||n,function(o,a,s,l){if(void 0!==o){var u=i?t6(t,i,s,r):t;return n&&l?t8(o,u,e):(0,F.uZ)(o,e,u)}}}function t9(t){if(void 0!==t)return 0}function et(t){if(void 0!==t)return t}function ee(t){return Math.pow(t,3)}function en(t){return 1-ee(1-t)}function ei(t){return 3*t*t-2*t*t*t}function er(t){return t}var eo=n(5815);function ea(t,e,n,i,r,o,a){var s,l=t[e],u=t[e+1],c=t[n]-l,h=t[n+1]-u;if(0===c&&0===h)s=e;else{var f=((r-l)*c+(o-u)*h)/(c*c+h*h);if(f>1)s=n;else if(f>0){for(var d=0;d<i;++d)a[d]=(0,F.t7)(t[e+d],t[n+d],f);a.length=i;return}else s=e}for(var v=0;v<i;++v)a[v]=t[s+v];a.length=i}function es(t,e,n,i,r){var o=t[e],a=t[e+1];for(e+=i;e<n;e+=i){var s=t[e],l=t[e+1],u=(0,F.bI)(o,a,s,l);u>r&&(r=u),o=s,a=l}return r}function el(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o];r=es(t,e,s,i,r),e=s}return r}function eu(t,e,n,i,r,o,a,s,l,u,c){if(e==n)return u;if(0===r){if((f=(0,F.bI)(a,s,t[e],t[e+1]))<u){for(h=0;h<i;++h)l[h]=t[e+h];return l.length=i,f}return u}c=c||[NaN,NaN];for(var h,f,d=e+i;d<n;)if(ea(t,d-i,d,i,a,s,c),(f=(0,F.bI)(a,s,c[0],c[1]))<u){for(h=0,u=f;h<i;++h)l[h]=c[h];l.length=i,d+=i}else d+=i*Math.max((Math.sqrt(f)-Math.sqrt(u))/r|0,1);if(o&&(ea(t,n-i,e,i,a,s,c),(f=(0,F.bI)(a,s,c[0],c[1]))<u)){for(h=0,u=f;h<i;++h)l[h]=c[h];l.length=i}return u}function ec(t,e,n,i,r,o,a,s,l,u,c){c=c||[NaN,NaN];for(var h=0,f=n.length;h<f;++h){var d=n[h];u=eu(t,e,d,i,r,o,a,s,l,u,c),e=d}return u}var eh=n(5030);function ef(t,e,n,i,r,o,a){var s=(n-e)/i;if(s<3){for(;e<n;e+=i)o[a++]=t[e],o[a++]=t[e+1];return a}var l=Array(s);l[0]=1,l[s-1]=1;for(var u=[e,n-i],c=0;u.length>0;){for(var h=u.pop(),f=u.pop(),d=0,v=t[f],g=t[f+1],p=t[h],y=t[h+1],_=f+i;_<h;_+=i){var m=t[_],x=t[_+1],R=(0,F.rU)(m,x,v,g,p,y);R>d&&(c=_,d=R)}d>r&&(l[(c-e)/i]=1,f+i<c&&u.push(f,c),c+i<h&&u.push(c,h))}for(var E=0;E<s;++E)l[E]&&(o[a++]=t[e+E*i],o[a++]=t[e+E*i+1]);return a}function ed(t,e){return e*Math.round(t/e)}function ev(t,e,n,i,r,o,a,s){for(var l=0,u=n.length;l<u;++l){var c=n[l];a=function(t,e,n,i,r,o,a){if(e==n)return a;var s,l,u=ed(t[e],r),c=ed(t[e+1],r);e+=i,o[a++]=u,o[a++]=c;do if(s=ed(t[e],r),l=ed(t[e+1],r),(e+=i)==n)return o[a++]=s,o[a++]=l,a;while(s==u&&l==c);for(;e<n;){var h=ed(t[e],r),f=ed(t[e+1],r);if(e+=i,h!=s||f!=l){var d=s-u,v=l-c,g=h-u,p=f-c;if(d*p==v*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(v<0&&p<v||v==p||v>0&&p>v)){s=h,l=f;continue}o[a++]=s,o[a++]=l,u=s,c=l,s=h,l=f}}return o[a++]=s,o[a++]=l,a}(t,e,c,i,r,o,a),s.push(a),e=c}return a}function eg(t,e,n,i,r){r=void 0!==r?r:[];for(var o=0,a=e;a<n;a+=i)r[o++]=t.slice(a,a+i);return r.length=o,r}function ep(t,e,n,i,r){r=void 0!==r?r:[];for(var o=0,a=0,s=n.length;a<s;++a){var l=n[a];r[o++]=eg(t,e,l,i,r[o]),e=l}return r.length=o,r}function ey(t,e,n,i,r){r=void 0!==r?r:[];for(var o=0,a=0,s=n.length;a<s;++a){var l=n[a];r[o++]=1===l.length&&l[0]===e?[]:ep(t,e,l,i,r[o]),e=l[l.length-1]}return r.length=o,r}function e_(t,e,n,i){for(var r=0,o=t[n-i],a=t[n-i+1];e<n;e+=i){var s=t[e],l=t[e+1];r+=a*s-o*l,o=s,a=l}return r/2}function em(t,e,n,i){for(var r=0,o=0,a=n.length;o<a;++o){var s=n[o];r+=e_(t,e,s,i),e=s}return r}var ex=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),(r=n.call(this)).maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r}return(0,c.Z)(i,[{key:"clone",value:function(){return new i(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){return i<(0,M.qf)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(es(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),eu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"getArea",value:function(){return e_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return eg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=ef(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,"XY")}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,eh.Sg)(this.flatCoordinates,0,t,this.stride),this.changed()}}]),i}(eo.ZP),eR=n(3379);function eE(t,e,n,i,r,o){for(var a=0,s=t[n-i],l=t[n-i+1];e<n;e+=i){var u=t[e],c=t[e+1];l<=o?c>o&&(u-s)*(o-l)-(r-s)*(c-l)>0&&a++:c<=o&&(u-s)*(o-l)-(r-s)*(c-l)<0&&a--,s=u,l=c}return 0!==a}function ek(t,e,n,i,r,o){if(0===n.length||!eE(t,e,n[0],i,r,o))return!1;for(var a=1,s=n.length;a<s;++a)if(eE(t,n[a-1],n[a],i,r,o))return!1;return!0}function eT(t,e,n,i,r,o,a){for(var s,l,u,c,h,f,d,v=r[o+1],g=[],p=0,y=n.length;p<y;++p){var _=n[p];for(c=t[_-i],f=t[_-i+1],s=e;s<_;s+=i)h=t[s],d=t[s+1],(v<=f&&d<=v||f<=v&&v<=d)&&(u=(v-f)/(d-f)*(h-c)+c,g.push(u)),c=h,f=d}var m=NaN,x=-1/0;for(g.sort(t4.j2),c=g[0],s=1,l=g.length;s<l;++s){var R=Math.abs((h=g[s])-c);R>x&&ek(t,e,n,i,u=(c+h)/2,v)&&(m=u,x=R),c=h}return(isNaN(m)&&(m=r[o]),a)?(a.push(m,v,x),a):[m,v,x]}function eC(t,e,n,i,r){var o;for(e+=i;e<n;e+=i)if(o=r(t.slice(e-i,e),t.slice(e,e+i)))return o;return!1}function eS(t,e,n,i,r){var o=(0,M.qP)((0,M.lJ)(),t,e,n,i);return!!(0,M.kK)(r,o)&&(!!(0,M.r4)(r,o)||o[0]>=r[0]&&o[2]<=r[2]||o[1]>=r[1]&&o[3]<=r[3]||eC(t,e,n,i,function(t,e){return(0,M.I7)(r,t,e)}))}function ew(t,e,n,i,r){return!!(eS(t,e,n,i,r)||eE(t,e,n,i,r[0],r[1])||eE(t,e,n,i,r[0],r[3])||eE(t,e,n,i,r[2],r[1])||eE(t,e,n,i,r[2],r[3]))}function eP(t,e,n,i,r){if(!ew(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(var o=1,a=n.length;o<a;++o)if(function(t,e,n,i,r){return!(0,M.H6)(r,function(r){return!eE(t,e,n,i,r[0],r[1])})}(t,n[o-1],n[o],i,r)&&!eS(t,n[o-1],n[o],i,r))return!1;return!0}function eZ(t,e,n,i){for(var r=0,o=t[n-i],a=t[n-i+1];e<n;e+=i){var s=t[e],l=t[e+1];r+=(s-o)*(l+a),o=s,a=l}return 0===r?void 0:r>0}function eI(t,e,n,i,r){r=void 0!==r&&r;for(var o=0,a=n.length;o<a;++o){var s=n[o],l=eZ(t,e,s,i);if(0===o){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=s}return!0}function eb(t,e,n,i,r){r=void 0!==r&&r;for(var o=0,a=n.length;o<a;++o){var s=n[o],l=eZ(t,e,s,i);(0===o?r&&l||!r&&!l:r&&!l||!r&&l)&&function(t,e,n,i){for(;e<n-i;){for(var r=0;r<i;++r){var o=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=o}e+=i,n-=i}}(t,e,s,i),e=s}return e}function eO(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o)e=eb(t,e,n[o],i,r);return e}n(7934);var eA=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r){var o;return(0,u.Z)(this,i),(o=n.call(this)).ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==e&&r?(o.setFlatCoordinates(e,t),o.ends_=r):o.setCoordinates(t,e),o}return(0,c.Z)(i,[{key:"appendLinearRing",value:function(t){this.flatCoordinates?(0,t4.l7)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){return i<(0,M.qf)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(el(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ec(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"containsXY",value:function(t,e){return ek(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return em(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?eb(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,ep(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=(0,M.qg)(this.getExtent());this.flatInteriorPoint_=eT(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new eR.Z(this.getFlatInteriorPoint(),"XYM")}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new ex(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[],r=0,o=0,a=n.length;o<a;++o){var s=n[o],l=new ex(e.slice(r,s),t);i.push(l),r=s}return i}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;eI(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=eb(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],n=[];return e.length=ev(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new i(e,"XY",n)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(t){return eP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=(0,eh._5)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}]),i}(eo.ZP);function eL(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=[e,n,e,r,i,r,i,n,e,n];return new eA(o,"XY",[o.length])}function eM(t,e,n){e=e||32;for(var i=t.getStride(),r=t.getLayout(),o=t.getCenter(),a=i*(e+1),s=Array(a),l=0;l<a;l+=i){s[l]=0,s[l+1]=0;for(var u=2;u<i;u++)s[l+u]=o[u]}var c=[s.length],h=new eA(s,r,c);return function(t,e,n,i){for(var r=t.getFlatCoordinates(),o=t.getStride(),a=r.length/o-1,s=i||0,l=0;l<=a;++l){var u=l*o,c=s+2*(0,F.$W)(l,a)*Math.PI/a;r[u]=e[0]+n*Math.cos(c),r[u+1]=e[1]+n*Math.sin(c)}t.changed()}(h,o,t.getRadius(),n),h}var eD=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).on,e.once,e.un,t=Object.assign({},t),e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=(0,t2.UQ)(t.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.nextCenter_=null,e.nextResolution_,e.nextRotation_,e.cancelAnchor_=void 0,t.projection&&(0,t2.h_)(),t.center&&(t.center=(0,t2.Vs)(t.center,e.projection_)),t.extent&&(t.extent=(0,t2.dY)(t.extent,e.projection_)),e.applyOptions_(t),e}return(0,c.Z)(i,[{key:"applyOptions_",value:function(t){var e=Object.assign({},t);for(var n in t1)delete e[n];this.setProperties(e,!0);var i=function(t){var e=void 0!==t.minZoom?t.minZoom:0,n=void 0!==t.maxZoom?t.maxZoom:28,i=void 0!==t.zoomFactor?t.zoomFactor:2,r=void 0!==t.multiWorld&&t.multiWorld,o=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,a=void 0!==t.showFullExtent&&t.showFullExtent,s=(0,t2.UQ)(t.projection,"EPSG:3857"),l=s.getExtent(),u=t.constrainOnlyCenter,c=t.extent;if(!r&&!c&&s.isGlobal()&&(u=!1,c=l),void 0!==t.resolutions){var h,f,d,v,g,p=t.resolutions;(f=p[e],d=void 0!==p[n]?p[n]:p[p.length-1],t.constrainResolution)?(v=o,g=!u&&c,v=void 0===v||v,h=function(t,e,n,i){if(void 0!==t){var r=p[0],o=p[p.length-1],s=g?t6(r,g,n,a):r;if(i)return v?t8(t,s,o):(0,F.uZ)(t,o,s);var l=Math.floor((0,t4.h7)(p,Math.min(s,t),e));return p[l]>s&&l<p.length-1?p[l+1]:p[l]}}):h=t7(f,d,o,!u&&c,a)}else{var y,_,m,x,R=(l?Math.max((0,M.dz)(l),(0,M.Cr)(l)):360*t2.Wm.degrees/s.getMetersPerUnit())/256/1;(void 0!==(f=t.maxResolution)?e=0:f=R/Math.pow(i,e),void 0===(d=t.minResolution)&&(d=void 0!==t.maxZoom?void 0!==t.maxResolution?f/Math.pow(i,n):R/Math.pow(i,n):R/268435456),n=e+Math.floor(Math.log(f/d)/Math.log(i)),d=f/Math.pow(i,n-e),t.constrainResolution)?(y=f,_=d,m=o,x=!u&&c,m=void 0===m||m,_=void 0!==_?_:0,h=function(t,e,n,r){if(void 0!==t){var o=x?t6(y,x,n,a):y;return r?m?t8(t,o,_):(0,F.uZ)(t,_,o):(0,F.uZ)(y/Math.pow(i,Math.max(Math.ceil(Math.log(y/o)/Math.log(i)-1e-9),Math.floor(Math.log(y/Math.min(o,t))/Math.log(i)+(-(.499999999*e)+.5)))),_,o)}}):h=t7(f,d,o,!u&&c,a)}return{constraint:h,maxResolution:f,minResolution:d,minZoom:e,zoomFactor:i}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;var r=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return t3(t.extent,t.constrainOnlyCenter,e)}var n=(0,t2.UQ)(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var i=n.getExtent().slice();return i[0]=-1/0,i[2]=1/0,t3(i,!1,!1)}return t5}(t),o=i.constraint,a=function(t){if(void 0===t.enableRotation||t.enableRotation){var e,n,i=t.constrainRotation;if(void 0===i||!0===i)return e=e||(0,F.Yr)(5),function(t,n){return n?t:void 0!==t?Math.abs(t)<=e?0:t:void 0};if(!1===i);else if("number"==typeof i)return n=2*Math.PI/i,function(t,e){return e?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0};return et}return t9}(t);this.constraints_={center:r,resolution:o,rotation:a},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var n=this.getCenter();if(n){var i=t||[0,0,0,0];e=e||[0,0,0,0];var r=this.getResolution(),o=r/2*(i[3]-e[3]+e[1]-i[1]),a=r/2*(i[0]-e[0]+e[2]-i[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=Array(arguments.length),n=0;n<e.length;++n){var i=arguments[n];i.center&&((i=Object.assign({},i)).center=(0,t2.Vs)(i.center,this.getProjection())),i.anchor&&((i=Object.assign({},i)).anchor=(0,t2.Vs)(i.anchor,this.getProjection())),e[n]=i}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);for(var i=0;i<n&&!this.isDef();++i){var r=arguments[i];r.center&&this.setCenterInternal(r.center),void 0!==r.zoom?this.setZoom(r.zoom):r.resolution&&this.setResolution(r.resolution),void 0!==r.rotation&&this.setRotation(r.rotation)}if(i===n){e&&eF(e,!0);return}for(var o=Date.now(),a=this.targetCenter_.slice(),s=this.targetResolution_,l=this.targetRotation_,u=[];i<n;++i){var c=arguments[i],h={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||ei,callback:e};if(c.center&&(h.sourceCenter=a,h.targetCenter=c.center.slice(),a=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=s,h.targetResolution=this.getResolutionForZoom(c.zoom),s=h.targetResolution):c.resolution&&(h.sourceResolution=s,h.targetResolution=c.resolution,s=h.targetResolution),void 0!==c.rotation){h.sourceRotation=l;var f=(0,F.$W)(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+f,l=h.targetRotation}(!h.sourceCenter||!h.targetCenter||(0,te.fS)(h.sourceCenter,h.targetCenter))&&h.sourceResolution===h.targetResolution&&h.sourceRotation===h.targetRotation?h.complete=!0:o+=h.duration,u.push(h)}this.animations_.push(u),this.setHint(t0.ANIMATING,1),this.updateAnimations_()}},{key:"getAnimating",value:function(){return this.hints_[t0.ANIMATING]>0}},{key:"getInteracting",value:function(){return this.hints_[t0.INTERACTING]>0}},{key:"cancelAnimations",value:function(){this.setHint(t0.ANIMATING,-this.hints_[t0.ANIMATING]);for(var t,e=0,n=this.animations_.length;e<n;++e){var i=this.animations_[e];if(i[0].callback&&eF(i[0].callback,!1),!t)for(var r=0,o=i.length;r<o;++r){var a=i[r];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var i=this.animations_[n],r=!0,o=0,a=i.length;o<a;++o){var s=i[o];if(!s.complete){var l=t-s.start,u=s.duration>0?l/s.duration:1;u>=1?(s.complete=!0,u=1):r=!1;var c=s.easing(u);if(s.sourceCenter){var h=s.sourceCenter[0],f=s.sourceCenter[1],d=s.targetCenter[0],v=s.targetCenter[1];this.nextCenter_=s.targetCenter;var g=h+c*(d-h),p=f+c*(v-f);this.targetCenter_=[g,p]}if(s.sourceResolution&&s.targetResolution){var y=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var _=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(y,0,_,!0);this.targetCenter_=this.calculateCenterZoom(m,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var x=1===c?(0,F.$W)(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var R=this.constraints_.rotation(x,!0);this.targetCenter_=this.calculateCenterRotate(R,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=x}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(r){this.animations_[n]=null,this.setHint(t0.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var E=i[0].callback;E&&eF(E,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,i=this.getCenterInternal();return void 0!==i&&(n=[i[0]-e[0],i[1]-e[1]],(0,te.U1)(n,t-this.getRotation()),(0,te.IH)(n,e)),n}},{key:"calculateCenterZoom",value:function(t,e){var n,i=this.getCenterInternal(),r=this.getResolution();return void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]),n}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var n=e[0],i=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?(0,t2.lO)(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(t1.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){var e=this.calculateExtentInternal(t);return(0,t2.Fj)(e,this.getProjection())}},{key:"calculateExtentInternal",value:function(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal();(0,D.h)(e,1);var n=this.getResolution();(0,D.h)(void 0!==n,2);var i=this.getRotation();return(0,D.h)(void 0!==i,3),(0,M.p8)(e,n,i,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(t1.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal((0,t2.dY)(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){return e=e||this.getViewportSizeMinusPadding_(),Math.max((0,M.dz)(t)/e[0],(0,M.Cr)(t)/e[1])}},{key:"getResolutionForValueFunction",value:function(t){t=t||2;var e=this.getConstrainedResolution(this.maxResolution_),n=Math.log(e/this.minResolution_)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}},{key:"getRotation",value:function(){return this.get(t1.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=Math.log(n/this.minResolution_)/e;return function(t){return Math.log(n/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){var e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}},{key:"getState",value:function(){var t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),i=this.getCenterInternal(),r=this.padding_;if(r){var o=this.getViewportSizeMinusPadding_();i=eN(i,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,n)}return{center:i.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,n,i=this.minZoom_||0;if(this.resolutions_){var r=(0,t4.h7)(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=(0,F.uZ)(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,(0,F.uZ)(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var n;if((0,D.h)(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))(0,D.h)(!(0,M.xb)(t),25),n=eL((0,t2.dY)(t,this.getProjection()));else if("Circle"===t.getType()){var i=(0,t2.dY)(t.getExtent(),this.getProjection());(n=eL(i)).rotate(this.getRotation(),(0,M.qg)(i))}else{var r=(0,t2.Cs)();n=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(n,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),n=Math.cos(e),i=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride(),a=Infinity,s=Infinity,l=-1/0,u=-1/0,c=0,h=r.length;c<h;c+=o){var f=r[c]*n-r[c+1]*i,d=r[c]*i+r[c+1]*n;a=Math.min(a,f),s=Math.min(s,d),l=Math.max(l,f),u=Math.max(u,d)}return[a,s,l,u]}},{key:"fitInternal",value:function(t,e){var n,i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());var r=void 0!==e.padding?e.padding:[0,0,0,0],o=void 0!==e.nearest&&e.nearest;n=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;var a=this.rotatedExtentForGeometry(t),s=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);s=isNaN(s)?n:Math.max(s,n),s=this.getConstrainedResolution(s,o?0:1);var l=this.getRotation(),u=Math.sin(l),c=Math.cos(l),h=(0,M.qg)(a);h[0]+=(r[1]-r[3])/2*s,h[1]+=(r[0]-r[2])/2*s;var f=h[0]*c-h[1]*u,d=h[1]*c+h[0]*u,v=this.getConstrainedCenter([f,d],s),g=e.callback?e.callback:O.Zn;void 0!==e.duration?this.animateInternal({resolution:s,center:v,duration:e.duration,easing:e.easing},g):(this.targetResolution_=s,this.targetCenter_=v,this.applyTargetState_(!1,!0),eF(g,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal((0,t2.Vs)(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){this.setCenterInternal(eN(t,e,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,n,i){var r,o=this.padding_;if(o&&t){var a=this.getViewportSizeMinusPadding_(-n),s=eN(t,i,[a[0]/2+o[3],a[1]/2+o[0]],e,n);r=[t[0]-s[0],t[1]-s[1]]}return r}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=(0,t2.lO)(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){e=e&&(0,t2.Vs)(e,this.getProjection()),this.adjustResolutionInternal(t,e)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=(0,t2.Vs)(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t?(0,t2.Vs)(t,this.getProjection()):t)}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,r,n),a=this.constraints_.center(this.targetCenter_,o,r,n,this.calculateCenterShift(this.targetCenter_,o,i,r));this.get(t1.ROTATION)!==i&&this.set(t1.ROTATION,i),this.get(t1.RESOLUTION)!==o&&(this.set(t1.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),a&&this.get(t1.CENTER)&&(0,te.fS)(this.get(t1.CENTER),a)||this.set(t1.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){t=void 0!==t?t:200;var i=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,e||0,r),a=this.constraints_.center(this.targetCenter_,o,r,!1,this.calculateCenterShift(this.targetCenter_,o,i,r));if(0===t&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=i,this.targetCenter_=a,this.applyTargetState_();return}n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===i&&this.getCenterInternal()&&(0,te.fS)(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:a,resolution:o,duration:t,easing:en,anchor:n}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(t0.INTERACTING,1)}},{key:"endInteraction",value:function(t,e,n){n=n&&(0,t2.Vs)(n,this.getProjection()),this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,n){this.setHint(t0.INTERACTING,-1),this.resolveConstraints(t,e,n)}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}},{key:"getConstrainedResolution",value:function(t,e){e=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}]),i}(k.Z);function eF(t,e){setTimeout(function(){t(e)},0)}function eN(t,e,n,i,r){var o=Math.cos(-r),a=Math.sin(-r),s=t[0]*o-t[1]*a,l=t[1]*o+t[0]*a;return[(s+=(e[0]/2-n[0])*i)*o-(l+=(n[1]-e[1]/2)*i)*(a=-a),l*o+s*a]}var eB=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),e=n.call(this);var e,r=t.element;return!r||t.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),e.element=r||null,e.target_=null,e.map_=null,e.listenerKeys=[],t.render&&(e.render=t.render),t.target&&e.setTarget(t.target),e}return(0,c.Z)(i,[{key:"disposeInternal",value:function(){t_(this.element),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(t){this.map_&&t_(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)(0,$.bN)(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==O.Zn&&this.listenerKeys.push((0,$.oL)(t,tH.POSTRENDER,this.render,this)),t.render())}},{key:"render",value:function(t){}},{key:"setTarget",value:function(t){this.target_="string"==typeof t?document.getElementById(t):t}}]),i}(k.Z),eG=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),t=t||{},(e=n.call(this,{element:document.createElement("div"),render:t.render,target:t.target})).ulElement_=document.createElement("ul"),e.collapsed_=void 0===t.collapsed||t.collapsed,e.userCollapsed_=e.collapsed_,e.overrideCollapsible_=void 0!==t.collapsible,e.collapsible_=void 0===t.collapsible||t.collapsible,e.collapsible_||(e.collapsed_=!1);var e,r=void 0!==t.className?t.className:"ol-attribution",o=void 0!==t.tipLabel?t.tipLabel:"Attributions",a=void 0!==t.expandClassName?t.expandClassName:r+"-expand",s=void 0!==t.collapseLabel?t.collapseLabel:"›",l=void 0!==t.collapseClassName?t.collapseClassName:r+"-collapse";"string"==typeof s?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=s,e.collapseLabel_.className=l):e.collapseLabel_=s;var c=void 0!==t.label?t.label:"i";"string"==typeof c?(e.label_=document.createElement("span"),e.label_.textContent=c,e.label_.className=a):e.label_=c;var h=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_;e.toggleButton_=document.createElement("button"),e.toggleButton_.setAttribute("type","button"),e.toggleButton_.setAttribute("aria-expanded",String(!e.collapsed_)),e.toggleButton_.title=o,e.toggleButton_.appendChild(h),e.toggleButton_.addEventListener(q.Z.CLICK,e.handleClick_.bind((0,E.Z)(e)),!1);var f=r+" "+ts+" "+tl+(e.collapsed_&&e.collapsible_?" "+tu:"")+(e.collapsible_?"":" ol-uncollapsible"),d=e.element;return d.className=f,d.appendChild(e.toggleButton_),d.appendChild(e.ulElement_),e.renderedAttributions_=[],e.renderedVisible_=!0,e}return(0,c.Z)(i,[{key:"collectSourceAttributions_",value:function(t){for(var e={},n=[],i=!0,r=t.layerStatesArray,o=0,a=r.length;o<a;++o){var s=r[o];if(tt(s,t.viewState)){var l=s.layer.getSource();if(l){var u=l.getAttributions();if(u){var c=u(t);if(c){if(i=i&&!1!==l.getAttributionsCollapsible(),Array.isArray(c))for(var h=0,f=c.length;h<f;++h)c[h]in e||(n.push(c[h]),e[c[h]]=!0);else c in e||(n.push(c),e[c]=!0)}}}}}return this.overrideCollapsible_||this.setCollapsible(i),n}},{key:"updateElement_",value:function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!(0,t4.fS)(e,this.renderedAttributions_)){tm(this.ulElement_);for(var i=0,r=e.length;i<r;++i){var o=document.createElement("li");o.innerHTML=e[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}},{key:"handleClick_",value:function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle(tu),this.collapsed_?ty(this.collapseLabel_,this.label_):ty(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(t){this.updateElement_(t.frameState)}}]),i}(eB),eU=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),t=t||{},e=n.call(this,{element:document.createElement("div"),render:t.render,target:t.target});var e,r=void 0!==t.className?t.className:"ol-rotate",o=void 0!==t.label?t.label:"⇧",a=void 0!==t.compassClassName?t.compassClassName:"ol-compass";e.label_=null,"string"==typeof o?(e.label_=document.createElement("span"),e.label_.className=a,e.label_.textContent=o):(e.label_=o,e.label_.classList.add(a));var s=t.tipLabel?t.tipLabel:"Reset rotation",l=document.createElement("button");l.className=r+"-reset",l.setAttribute("type","button"),l.title=s,l.appendChild(e.label_),l.addEventListener(q.Z.CLICK,e.handleClick_.bind((0,E.Z)(e)),!1);var c=e.element;return c.className=r+" "+ts+" "+tl,c.appendChild(l),e.callResetNorth_=t.resetNorth?t.resetNorth:void 0,e.duration_=void 0!==t.duration?t.duration:250,e.autoHide_=void 0===t.autoHide||t.autoHide,e.rotation_=void 0,e.autoHide_&&e.element.classList.add(ta),e}return(0,c.Z)(i,[{key:"handleClick_",value:function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:en}):t.setRotation(0))}}},{key:"render",value:function(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){if(this.autoHide_){var i=this.element.classList.contains(ta);i||0!==n?i&&0!==n&&this.element.classList.remove(ta):this.element.classList.add(ta)}this.label_.style.transform="rotate("+n+"rad)"}this.rotation_=n}}}]),i}(eB),ez=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),t=t||{},e=n.call(this,{element:document.createElement("div"),target:t.target});var e,r=void 0!==t.className?t.className:"ol-zoom",o=void 0!==t.delta?t.delta:1,a=void 0!==t.zoomInClassName?t.zoomInClassName:r+"-in",s=void 0!==t.zoomOutClassName?t.zoomOutClassName:r+"-out",l=void 0!==t.zoomInLabel?t.zoomInLabel:"+",c=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",h=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",f=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=a,d.setAttribute("type","button"),d.title=h,d.appendChild("string"==typeof l?document.createTextNode(l):l),d.addEventListener(q.Z.CLICK,e.handleClick_.bind((0,E.Z)(e),o),!1);var v=document.createElement("button");v.className=s,v.setAttribute("type","button"),v.title=f,v.appendChild("string"==typeof c?document.createTextNode(c):c),v.addEventListener(q.Z.CLICK,e.handleClick_.bind((0,E.Z)(e),-o),!1);var g=e.element;return g.className=r+" "+ts+" "+tl,g.appendChild(d),g.appendChild(v),e.duration_=void 0!==t.duration?t.duration:250,e}return(0,c.Z)(i,[{key:"handleClick_",value:function(t,e){e.preventDefault(),this.zoomByDelta_(t)}},{key:"zoomByDelta_",value:function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:en})):e.setZoom(i)}}}}]),i}(eB),eX={ACTIVE:"active"},ej=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).on,e.once,e.un,t&&t.handleEvent&&(e.handleEvent=t.handleEvent),e.map_=null,e.setActive(!0),e}return(0,c.Z)(i,[{key:"getActive",value:function(){return this.get(eX.ACTIVE)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(t){return!0}},{key:"setActive",value:function(t){this.set(eX.ACTIVE,t)}},{key:"setMap",value:function(t){this.map_=t}}]),i}(k.Z);function eW(t,e,n,i){var r=t.getZoom();if(void 0!==r){var o=t.getConstrainedZoom(r+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:n,duration:void 0!==i?i:250,easing:en})}}var eY=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),e=n.call(this),t=t||{},e.delta_=t.delta?t.delta:1,e.duration_=void 0!==t.duration?t.duration:250,e}return(0,c.Z)(i,[{key:"handleEvent",value:function(t){var e=!1;if(t.type==tj.DBLCLICK){var n=t.originalEvent,i=t.map,r=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;eW(i.getView(),o,r,this.duration_),n.preventDefault(),e=!0}return!e}}]),i}(ej),eV=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),t=t||{},e=n.call(this,t),t.handleDownEvent&&(e.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(e.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(e.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(e.handleUpEvent=t.handleUpEvent),t.stopDown&&(e.stopDown=t.stopDown),e.handlingDownUpSequence=!1,e.targetPointers=[],e}return(0,c.Z)(i,[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(t){return!1}},{key:"handleDragEvent",value:function(t){}},{key:"handleEvent",value:function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==tj.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==tj.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==tj.POINTERDOWN){var i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==tj.POINTERMOVE&&this.handleMoveEvent(t);return!e}},{key:"handleMoveEvent",value:function(t){}},{key:"handleUpEvent",value:function(t){return!1}},{key:"stopDown",value:function(t){return t}},{key:"updateTrackedPointers_",value:function(t){t.activePointers&&(this.targetPointers=t.activePointers)}}]),i}(ej);function eH(t){for(var e=t.length,n=0,i=0,r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return{clientX:n/e,clientY:i/e}}function eK(t){var e=arguments;return function(t){for(var n=!0,i=0,r=e.length;i<r&&(n=n&&e[i](t));++i);return n}}var eq=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},eJ=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},e$=function(t){var e=t.map.getTargetElement(),n=t.map.getOwnerDocument().activeElement;return e.contains(n)},eQ=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||e$(t)},e0=O.uX,e1=function(t){var e=t.originalEvent;return 0==e.button&&!(td.G$&&td.tK&&e.ctrlKey)},e2=O.Dv,e3=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},e5=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},e4=function(t){var e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},e6=function(t){var e=t.originalEvent;return(0,D.h)(void 0!==e,56),"mouse"==e.pointerType},e8=function(t){var e=t.originalEvent;return(0,D.h)(void 0!==e,56),e.isPrimary&&0===e.button},e7=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),e=n.call(this,{stopDown:O.Dv}),t=t||{},e.kinetic_=t.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1;var e,r=t.condition?t.condition:eK(e3,e8);return e.condition_=t.onFocusOnly?eK(eQ,r):r,e.noKinetic_=!1,e}return(0,c.Z)(i,[{key:"handleDragEvent",value:function(t){var e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());var n=this.targetPointers,i=e.getEventPixel(eH(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var r=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=t.map.getView();(0,te.bA)(r,o.getResolution()),(0,te.U1)(r,o.getRotation()),o.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),s=e.getCoordinateFromPixelInternal([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(s),duration:500,easing:en})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}]),i}(eV),e9=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),t=t||{},(e=n.call(this,{stopDown:O.Dv})).condition_=t.condition?t.condition:eJ,e.lastAngle_=void 0,e.duration_=void 0!==t.duration?t.duration:250,e}return(0,c.Z)(i,[{key:"handleDragEvent",value:function(t){if(e6(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==t9){var i=e.getSize(),r=t.pixel,o=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}}}},{key:"handleUpEvent",value:function(t){return!e6(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!!e6(t)&&!!(e1(t)&&this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)}}]),i}(eV),nt=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).geometry_=null,e.element_=document.createElement("div"),e.element_.style.position="absolute",e.element_.style.pointerEvents="auto",e.element_.className="ol-box "+t,e.map_=null,e.startPixel_=null,e.endPixel_=null,e}return(0,c.Z)(i,[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var t=this.startPixel_,e=this.endPixel_,n=this.element_.style;n.left=Math.min(t[0],e[0])+"px",n.top=Math.min(t[1],e[1])+"px",n.width=Math.abs(e[0]-t[0])+"px",n.height=Math.abs(e[1]-t[1])+"px"}},{key:"setMap",value:function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new eA([n])}},{key:"getGeometry",value:function(){return this.geometry_}}]),i}(b.Z);function ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var nn={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},ni=function(t){(0,h.Z)(n,t);var e=ne(n);function n(t,i,r){var o;return(0,u.Z)(this,n),(o=e.call(this,t)).coordinate=i,o.mapBrowserEvent=r,o}return(0,c.Z)(n)}(S.ZP),nr=function(t){(0,h.Z)(n,t);var e=ne(n);function n(t){var i;return(0,u.Z)(this,n),(i=e.call(this)).on,i.once,i.un,t=t||{},i.box_=new nt(t.className||"ol-dragbox"),i.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(i.onBoxEnd=t.onBoxEnd),i.startPixel_=null,i.condition_=t.condition?t.condition:e1,i.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:i.defaultBoxEndCondition,i}return(0,c.Z)(n,[{key:"defaultBoxEndCondition",value:function(t,e,n){var i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ni(nn.BOXDRAG,t.coordinate,t))}},{key:"handleUpEvent",value:function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new ni(e?nn.BOXEND:nn.BOXCANCEL,t.coordinate,t)),!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ni(nn.BOXSTART,t.coordinate,t)),!0)}},{key:"onBoxEnd",value:function(t){}}]),n}(eV),no=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=(t=t||{}).condition?t.condition:e5;return(e=n.call(this,{condition:r,className:t.className||"ol-dragzoom",minArea:t.minArea})).duration_=void 0!==t.duration?t.duration:200,e.out_=void 0!==t.out&&t.out,e}return(0,c.Z)(i,[{key:"onBoxEnd",value:function(t){var e=this.getMap().getView(),n=this.getGeometry();if(this.out_){var i=e.rotatedExtentForGeometry(n),r=e.getResolutionForExtentInternal(i),o=e.getResolution()/r;(n=n.clone()).scale(o*o)}e.fitInternal(n,{duration:this.duration_,easing:en})}}]),i}(nr),na={LEFT:37,UP:38,RIGHT:39,DOWN:40},ns=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),e=n.call(this),t=t||{},e.defaultCondition_=function(t){return e3(t)&&e4(t)},e.condition_=void 0!==t.condition?t.condition:e.defaultCondition_,e.duration_=void 0!==t.duration?t.duration:100,e.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128,e}return(0,c.Z)(i,[{key:"handleEvent",value:function(t){var e=!1;if(t.type==q.Z.KEYDOWN){var n=t.originalEvent,i=n.keyCode;if(this.condition_(t)&&(i==na.DOWN||i==na.LEFT||i==na.RIGHT||i==na.UP)){var r=t.map.getView(),o=r.getResolution()*this.pixelDelta_,a=0,s=0;i==na.DOWN?s=-o:i==na.LEFT?a=-o:i==na.RIGHT?a=o:s=o;var l=[a,s];(0,te.U1)(l,r.getRotation()),function(t,e,n){var i=t.getCenterInternal();if(i){var r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:er,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),n.preventDefault(),e=!0}}return!e}}]),i}(ej),nl=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),e=n.call(this),t=t||{},e.condition_=t.condition?t.condition:e4,e.delta_=t.delta?t.delta:1,e.duration_=void 0!==t.duration?t.duration:100,e}return(0,c.Z)(i,[{key:"handleEvent",value:function(t){var e=!1;if(t.type==q.Z.KEYDOWN||t.type==q.Z.KEYPRESS){var n=t.originalEvent,i=n.charCode;if(this.condition_(t)&&(43==i||45==i)){var r=t.map,o=43==i?this.delta_:-this.delta_;eW(r.getView(),o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}]),i}(ej),nu=function(){function t(e,n,i){(0,u.Z)(this,t),this.decay_=e,this.minVelocity_=n,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return(0,c.Z)(t,[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;var r=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/i,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}]),t}(),nc=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),t=t||{},(e=n.call(this,t)).totalDelta_=0,e.lastDelta_=0,e.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,e.duration_=void 0!==t.duration?t.duration:250,e.timeout_=void 0!==t.timeout?t.timeout:80,e.useAnchor_=void 0===t.useAnchor||t.useAnchor,e.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;var e,r=t.condition?t.condition:e0;return e.condition_=t.onFocusOnly?eK(eQ,r):r,e.lastAnchor_=null,e.startTime_=void 0,e.timeoutId_,e.mode_=void 0,e.trackpadEventGap_=400,e.trackpadTimeoutId_,e.deltaPerZoom_=300,e}return(0,c.Z)(i,[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.condition_(t)||t.type!==q.Z.WHEEL)return!0;var e,n=t.map,i=t.originalEvent;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==q.Z.WHEEL&&(e=i.deltaY,td.V&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=td.MP),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=4>Math.abs(e)?"trackpad":"wheel");var o=n.getView();if("trackpad"===this.mode_&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),a),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var n=-(0,F.uZ)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),eW(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}]),i}(ej),nh=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=t=t||{};return r.stopDown||(r.stopDown=O.Dv),(e=n.call(this,r)).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==t.threshold?t.threshold:.3,e.duration_=void 0!==t.duration?t.duration:250,e}return(0,c.Z)(i,[{key:"handleDragEvent",value:function(t){var e=0,n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var a=t.map,s=a.getView();s.getConstraints().rotation!==t9&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(eH(this.targetPointers))),this.rotating_&&(a.render(),s.adjustRotationInternal(e,this.anchor_)))}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}]),i}(eV),nf=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=t=t||{};return r.stopDown||(r.stopDown=O.Dv),(e=n.call(this,r)).anchor_=null,e.duration_=void 0!==t.duration?t.duration:400,e.lastDistance_=void 0,e.lastScaleDelta_=1,e}return(0,c.Z)(i,[{key:"handleDragEvent",value:function(t){var e=1,n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,o=n.clientY-i.clientY,a=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,l=s.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(eH(this.targetPointers))),s.render(),l.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}]),i}(eV);function nd(t){return t[0]>0&&t[1]>0}function nv(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}var ng=n(4155),np=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),p=n.call(this),t=t||{},p.on,p.once,p.un;var e,r,o,a,s,l,c,h,f,d,v,g,p,y=(s=null,void 0!==(e=t).keyboardEventTarget&&(s="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget),l={},c=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new tU({layers:e.layers}),l[tK.LAYERGROUP]=c,l[tK.TARGET]=e.target,l[tK.VIEW]=e.view instanceof eD?e.view:new eD,void 0!==e.controls&&(Array.isArray(e.controls)?r=new I(e.controls.slice()):((0,D.h)("function"==typeof e.controls.getArray,47),r=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?o=new I(e.interactions.slice()):((0,D.h)("function"==typeof e.interactions.getArray,48),o=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?a=new I(e.overlays.slice()):((0,D.h)("function"==typeof e.overlays.getArray,49),a=e.overlays):a=new I,{controls:r,interactions:o,keyboardEventTarget:s,overlays:a,values:l});p.renderComplete_,p.loaded_=!0,p.boundHandleBrowserEvent_=p.handleBrowserEvent.bind((0,E.Z)(p)),p.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,p.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:td.MP,p.postRenderTimeoutHandle_,p.animationDelayKey_,p.animationDelay_=p.animationDelay_.bind((0,E.Z)(p)),p.coordinateToPixelTransform_=(0,L.Ue)(),p.pixelToCoordinateTransform_=(0,L.Ue)(),p.frameIndex_=0,p.frameState_=null,p.previousExtent_=null,p.viewPropertyListenerKey_=null,p.viewChangeListenerKey_=null,p.layerGroupPropertyListenerKeys_=null,p.viewport_=document.createElement("div"),p.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),p.viewport_.style.position="relative",p.viewport_.style.overflow="hidden",p.viewport_.style.width="100%",p.viewport_.style.height="100%",p.overlayContainer_=document.createElement("div"),p.overlayContainer_.style.position="absolute",p.overlayContainer_.style.zIndex="0",p.overlayContainer_.style.width="100%",p.overlayContainer_.style.height="100%",p.overlayContainer_.style.pointerEvents="none",p.overlayContainer_.className="ol-overlaycontainer",p.viewport_.appendChild(p.overlayContainer_),p.overlayContainerStopEvent_=document.createElement("div"),p.overlayContainerStopEvent_.style.position="absolute",p.overlayContainerStopEvent_.style.zIndex="0",p.overlayContainerStopEvent_.style.width="100%",p.overlayContainerStopEvent_.style.height="100%",p.overlayContainerStopEvent_.style.pointerEvents="none",p.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",p.viewport_.appendChild(p.overlayContainerStopEvent_),p.mapBrowserEventHandler_=null,p.moveTolerance_=t.moveTolerance,p.keyboardEventTarget_=y.keyboardEventTarget,p.targetChangeHandlerKeys_=null,p.targetElement_=null,p.resizeObserver_=new ResizeObserver(function(){return p.updateSize()}),p.controls=y.controls||(h=h||{},f=new I,(void 0===h.zoom||h.zoom)&&f.push(new ez(h.zoomOptions)),(void 0===h.rotate||h.rotate)&&f.push(new eU(h.rotateOptions)),(void 0===h.attribution||h.attribution)&&f.push(new eG(h.attributionOptions)),f),p.interactions=y.interactions||(d=d={onFocusOnly:!0},v=new I,g=new nu(-.005,.05,100),(void 0===d.altShiftDragRotate||d.altShiftDragRotate)&&v.push(new e9),(void 0===d.doubleClickZoom||d.doubleClickZoom)&&v.push(new eY({delta:d.zoomDelta,duration:d.zoomDuration})),(void 0===d.dragPan||d.dragPan)&&v.push(new e7({onFocusOnly:d.onFocusOnly,kinetic:g})),(void 0===d.pinchRotate||d.pinchRotate)&&v.push(new nh),(void 0===d.pinchZoom||d.pinchZoom)&&v.push(new nf({duration:d.zoomDuration})),(void 0===d.keyboard||d.keyboard)&&(v.push(new ns),v.push(new nl({delta:d.zoomDelta,duration:d.zoomDuration}))),(void 0===d.mouseWheelZoom||d.mouseWheelZoom)&&v.push(new nc({onFocusOnly:d.onFocusOnly,duration:d.zoomDuration})),(void 0===d.shiftDragZoom||d.shiftDragZoom)&&v.push(new no({duration:d.zoomDuration})),v),p.overlays_=y.overlays,p.overlayIdIndex_={},p.renderer_=null,p.postRenderFunctions_=[],p.tileQueue_=new tQ(p.getTilePriority.bind((0,E.Z)(p)),p.handleTileChange_.bind((0,E.Z)(p))),p.addChangeListener(tK.LAYERGROUP,p.handleLayerGroupChanged_),p.addChangeListener(tK.VIEW,p.handleViewChanged_),p.addChangeListener(tK.SIZE,p.handleSizeChanged_),p.addChangeListener(tK.TARGET,p.handleTargetChanged_),p.setProperties(y.values);var _=(0,E.Z)(p);return!t.view||t.view instanceof eD||t.view.then(function(t){_.setView(new eD(t))}),p.controls.addEventListener(C.ADD,function(t){t.element.setMap((0,E.Z)(p))}),p.controls.addEventListener(C.REMOVE,function(t){t.element.setMap(null)}),p.interactions.addEventListener(C.ADD,function(t){t.element.setMap((0,E.Z)(p))}),p.interactions.addEventListener(C.REMOVE,function(t){t.element.setMap(null)}),p.overlays_.addEventListener(C.ADD,function(t){p.addOverlayInternal_(t.element)}),p.overlays_.addEventListener(C.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete p.overlayIdIndex_[e.toString()],t.element.setMap(null)}),p.controls.forEach(function(t){t.setMap((0,E.Z)(p))}),p.interactions.forEach(function(t){t.setMap((0,E.Z)(p))}),p.overlays_.forEach(p.addOverlayInternal_.bind((0,E.Z)(p))),p}return(0,c.Z)(i,[{key:"addControl",value:function(t){this.getControls().push(t)}},{key:"addInteraction",value:function(t){this.getInteractions().push(t)}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"handleLayerAdd_",value:function(t){!function t(e,n){if(e instanceof Q){e.setMapInternal(n);return}if(e instanceof tU)for(var i=e.getLayers().getArray(),r=0,o=i.length;r<o;++r)t(i[r],n)}(t.layer,this)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}},{key:"forEachFeatureAtPixel",value:function(t,e,n){if(this.frameState_&&this.renderer_){var i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,o=void 0!==n.layerFilter?n.layerFilter:O.uX,a=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,a,e,null,o,null)}}},{key:"getFeaturesAtPixel",value:function(t,e){var n=[];return this.forEachFeatureAtPixel(t,function(t){n.push(t)},e),n}},{key:"getAllLayers",value:function(){var t=[];return function e(n){n.forEach(function(n){n instanceof tU?e(n.getLayers()):t.push(n)})}(this.getLayers()),t}},{key:"hasFeatureAtPixel",value:function(t,e){if(!this.frameState_||!this.renderer_)return!1;var n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:O.uX,r=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,o,i,null)}},{key:"getEventCoordinate",value:function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}},{key:"getEventCoordinateInternal",value:function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}},{key:"getEventPixel",value:function(t){var e=this.viewport_.getBoundingClientRect(),n=this.getSize(),i=e.width/n[0],r=e.height/n[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-e.left)/i,(o.clientY-e.top)/r]}},{key:"getTarget",value:function(){return this.get(tK.TARGET)}},{key:"getTargetElement",value:function(){return this.targetElement_}},{key:"getCoordinateFromPixel",value:function(t){return(0,t2.lO)(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(t){var e=this.frameState_;return e?(0,L.nn)(e.pixelToCoordinateTransform,t.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(tK.LAYERGROUP)}},{key:"setLayers",value:function(t){var e=this.getLayerGroup();if(t instanceof I){e.setLayers(t);return}var n=e.getLayers();n.clear(),n.extend(t)}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e];if(i.visible){var r=i.layer.getRenderer();if(r&&!r.ready)return!0;var o=i.layer.getSource();if(o&&o.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(t){var e=(0,t2.Vs)(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}},{key:"getPixelFromCoordinateInternal",value:function(t){var e=this.frameState_;return e?(0,L.nn)(e.coordinateToPixelTransform,t.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(tK.SIZE)}},{key:"getView",value:function(){return this.get(tK.VIEW)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var t=this.getTargetElement();return t?t.ownerDocument:document}},{key:"getTilePriority",value:function(t,e,n,i){return function(t,e,n,i,r){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return tq;var o=t.viewState.center,a=i[0]-o[0],s=i[1]-o[1];return 65536*Math.log(r)+Math.sqrt(a*a+s*s)/r}(this.frameState_,t,e,n,i)}},{key:"handleBrowserEvent",value:function(t,e){e=e||t.type;var n=new tX(e,this,t);this.handleMapBrowserEvent(n)}},{key:"handleMapBrowserEvent",value:function(t){if(this.frameState_){var e=t.originalEvent,n=e.type;if(n===tW.POINTERDOWN||n===q.Z.WHEEL||n===q.Z.KEYDOWN){var i=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():i,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(r===i?i.documentElement:r).contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var a=this.getInteractions().getArray().slice(),s=a.length-1;s>=0;s--){var l=a[s];if(l.getMap()===this&&l.getActive()&&this.getTargetElement()&&(!l.handleEvent(t)||t.propagationStopped))break}}}},{key:"handlePostRender",value:function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,i=n;if(t){var r=t.viewHints;if(r[t0.ANIMATING]||r[t0.INTERACTING]){var o=Date.now()-t.time>8;n=o?0:8,i=o?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(J.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(J.RENDERCOMPLETE,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new tz(tH.LOADEND,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new tz(tH.LOADSTART,this,t))));for(var a=this.postRenderFunctions_,s=0,l=a.length;s<l;++s)a[s](this,t);a.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)(0,$.bN)(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(q.Z.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(q.Z.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,t_(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);var n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host)}var i=this.getTarget(),r="string"==typeof i?document.getElementById(i):i;if(this.targetElement_=r,r){for(var o in r.appendChild(this.viewport_),this.renderer_||(this.renderer_=new tF(this)),this.mapBrowserEventHandler_=new tV(this,this.moveTolerance_),tj)this.mapBrowserEventHandler_.addEventListener(tj[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(q.Z.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(q.Z.WHEEL,this.boundHandleBrowserEvent_,!!td.bM&&{passive:!1});var a=this.keyboardEventTarget_?this.keyboardEventTarget_:r;this.targetChangeHandlerKeys_=[(0,$.oL)(a,q.Z.KEYDOWN,this.handleBrowserEvent,this),(0,$.oL)(a,q.Z.KEYPRESS,this.handleBrowserEvent,this)];var s=r.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(r)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&((0,$.bN)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,$.bN)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=(0,$.oL)(t,tr.Z.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,$.oL)(t,q.Z.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach($.bN),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new tB("addlayer",t)),this.layerGroupPropertyListenerKeys_=[(0,$.oL)(t,tr.Z.PROPERTYCHANGE,this.render,this),(0,$.oL)(t,q.Z.CHANGE,this.render,this),(0,$.oL)(t,"addlayer",this.handleLayerAdd_,this),(0,$.oL)(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"animationDelay_",value:function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(t){return this.getControls().remove(t)}},{key:"removeInteraction",value:function(t){return this.getInteractions().remove(t)}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"handleLayerRemove_",value:function(t){!function t(e){if(e instanceof Q){e.setMapInternal(null);return}e instanceof tU&&e.getLayers().forEach(t)}(t.layer)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var e=this,n=this.getSize(),i=this.getView(),r=this.frameState_,o=null;if(void 0!==n&&nd(n)&&i&&i.isDef()){var a=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:(0,M.p8)(s.center,s.resolution,s.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:a,wantedTiles:{},mapId:(0,A.sq)(this),renderTargets:{}},s.nextCenter&&s.nextResolution){var l=isNaN(s.nextRotation)?s.rotation:s.nextRotation;o.nextExtent=(0,M.p8)(s.nextCenter,s.nextResolution,l,n)}}this.frameState_=o,this.renderer_.renderFrame(o),!o||(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),!r||this.previousExtent_&&((0,M.xb)(this.previousExtent_)||(0,M.fS)(o.extent,this.previousExtent_))||(this.dispatchEvent(new tz(tH.MOVESTART,this,r)),this.previousExtent_=(0,M.YN)(this.previousExtent_)),!this.previousExtent_||o.viewHints[t0.ANIMATING]||o.viewHints[t0.INTERACTING]||(0,M.fS)(o.extent,this.previousExtent_)||(this.dispatchEvent(new tz(tH.MOVEEND,this,o)),(0,M.d9)(o.extent,this.previousExtent_))),this.dispatchEvent(new tz(tH.POSTRENDER,this,o)),this.renderComplete_=this.hasListener(tH.LOADSTART)||this.hasListener(tH.LOADEND)||this.hasListener(J.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()},0))}},{key:"setLayerGroup",value:function(t){var e=this.getLayerGroup();e&&this.handleLayerRemove_(new tB("removelayer",e)),this.set(tK.LAYERGROUP,t)}},{key:"setSize",value:function(t){this.set(tK.SIZE,t)}},{key:"setTarget",value:function(t){this.set(tK.TARGET,t)}},{key:"setView",value:function(t){if(!t||t instanceof eD){this.set(tK.VIEW,t);return}this.set(tK.VIEW,new eD);var e=this;t.then(function(t){e.setView(new eD(t))})}},{key:"updateSize",value:function(){var t=this.getTargetElement(),e=void 0;if(t){var n=getComputedStyle(t),i=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),r=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(i)&&!isNaN(r)&&!nd(e=[i,r])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&(0,ng.ZK)("No map visible because the map container's width or height are 0.")}var o=this.getSize();!e||o&&(0,t4.fS)(e,o)||(this.setSize(e),this.updateViewportSize_())}},{key:"updateViewportSize_",value:function(){var t=this.getView();if(t){var e=void 0,n=getComputedStyle(this.viewport_);n.width&&n.height&&(e=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(e)}}}]),i}(k.Z),ny=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,t)).updateView=function(t){var n,i=e.ol.getView();"function"==typeof(null===(n=e.props)||void 0===n?void 0:n.view[1])&&e.props.view[1]({center:i.getCenter(),zoom:i.getZoom(),resolution:i.getResolution()})},e.target=v.createRef(),e.ol=new np({controls:t.noDefaultControls?[]:void 0,interactions:t.noDefaultInteractions?[]:void 0,view:new eD({projection:t.projection,center:t.initial.center,zoom:void 0===t.initial.resolution?t.initial.zoom:void 0,resolution:t.initial.resolution,extent:t.extent,minResolution:t.minResolution,maxResolution:t.maxResolution,constrainResolution:t.constrainResolution,minZoom:t.minZoom,maxZoom:t.maxZoom,enableRotation:t.enableRotation,constrainRotation:t.constrainRotation})}),e.props.view&&e.ol.on("moveend",e.updateView),e}return(0,c.Z)(i,[{key:"componentDidMount",value:function(){R((0,d.Z)(i.prototype),"componentDidMount",this).call(this),this.ol.setTarget(this.target.current)}},{key:"refresh",value:function(t){R((0,d.Z)(i.prototype),"refresh",this).call(this,t);for(var e=this.ol.getView(),n=0,r=["minZoom","maxZoom","constrainResolution"];n<r.length;n++){var o=r[n],a=o.charAt(0).toUpperCase()+o.substring(1);t&&this.props[o]===t[o]||e["set"+a](this.props[o])}this.props.view&&(e.setCenter(this.props.view[0].center),void 0===this.props.view[0].resolution?e.setZoom(this.props.view[0].zoom):e.setResolution(this.props.view[0].resolution)),this.props.properties&&this.ol.setProperties(this.props.properties),this.props.view?this.ol.on("moveend",this.updateView):this.ol.un("moveend",this.updateView)}},{key:"render",value:function(){return v.createElement("div",{className:this.props.className,style:{width:this.props.width,height:this.props.height},ref:this.target},v.createElement(g.Provider,{value:{map:this.ol}},this.props.children))}}]),i}(x),n_=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r,o,a;if((0,u.Z)(this,i),!(null===(a=null===(o=(r=n.call(this,t,e)).context)||void 0===o?void 0:o.map)||void 0===a?void 0:a.addLayer))throw Error("A layer must be part of a map");return r}return(0,c.Z)(i,[{key:"refresh",value:function(t){R((0,d.Z)(i.prototype),"refresh",this).call(this,t);for(var e=0,n=["visible","opacity","zIndex","minResolution","maxResolution","minZoom","maxZoom"];e<n.length;e++){var r=n[e];if(void 0!==this.props[r]){var o=r.charAt(0).toUpperCase()+r.substring(1);this.props[r]!==(t&&t[r])&&this.ol["set"+o](this.props[r])}}this.source&&this.props.attributions&&this.source.setAttributions(this.props.attributions),this.props.properties&&this.ol.setProperties(this.props.properties)}},{key:"componentDidMount",value:function(){R((0,d.Z)(i.prototype),"componentDidMount",this).call(this),this.context.map.addLayer(this.ol)}},{key:"componentWillUnmount",value:function(){R((0,d.Z)(i.prototype),"componentWillUnmount",this).call(this),this.context.map.removeLayer(this.ol)}},{key:"render",value:function(){return v.createElement("div",{className:"_rlayers_RLayer"},v.createElement(g.Provider,{value:Object.assign(Object.assign({},this.context),{layer:this.ol,source:this.source})},this.props.children))}}]),i}(x),nm={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},nx=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=Object.assign({},t=t||{});return delete r.preload,delete r.useInterimTilesOnError,(e=n.call(this,r)).on,e.once,e.un,e.setPreload(void 0!==t.preload?t.preload:0),e.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),e}return(0,c.Z)(i,[{key:"getPreload",value:function(){return this.get(nm.PRELOAD)}},{key:"setPreload",value:function(t){this.set(nm.PRELOAD,t)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(nm.USE_INTERIM_TILES_ON_ERROR)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(nm.USE_INTERIM_TILES_ON_ERROR,t)}},{key:"getData",value:function(t){return R((0,d.Z)(i.prototype),"getData",this).call(this,t)}}]),i}(Q),nR={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},nE=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).ready=!0,e.boundHandleImageChange_=e.handleImageChange_.bind((0,E.Z)(e)),e.layer_=t,e.declutterExecutorGroup=null,e}return(0,c.Z)(i,[{key:"getFeatures",value:function(t){return(0,A.O3)()}},{key:"getData",value:function(t){return null}},{key:"prepareFrame",value:function(t){return(0,A.O3)()}},{key:"renderFrame",value:function(t,e){return(0,A.O3)()}},{key:"loadedTileCallback",value:function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}},{key:"createLoadedTileFinder",value:function(t,e,n){var i=this;return function(r,o){var a=i.loadedTileCallback.bind(i,n,r);return t.forEachLoadedTile(e,r,o,a)}}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r){}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){t.target.getState()===nR.LOADED&&this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var e=t.getState();return e!=nR.LOADED&&e!=nR.ERROR&&t.addEventListener(q.Z.CHANGE,this.boundHandleImageChange_),e==nR.IDLE&&(t.load(),e=t.getState()),e==nR.LOADED}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}},{key:"disposeInternal",value:function(){delete this.layer_,R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}}]),i}(n(6441).Z),nk=[],nT=null,nC=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,t)).container=null,e.renderedResolution,e.tempTransform=(0,L.Ue)(),e.pixelTransform=(0,L.Ue)(),e.inversePixelTransform=(0,L.Ue)(),e.context=null,e.containerReused=!1,e.pixelContext_=null,e.frameState=null,e}return(0,c.Z)(i,[{key:"getImageData",value:function(t,e,n){var i;nT||(nT=tg(1,1,void 0,{willReadFrequently:!0})),nT.clearRect(0,0,1,1);try{nT.drawImage(t,e,n,1,1,0,0,1,1),i=nT.getImageData(0,0,1,1).data}catch(t){return nT=null,null}return i}},{key:"getBackground",value:function(t){var e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}},{key:"useContainer",value:function(t,e,n){var i,r,o=this.getLayer().getClassName();if(t&&t.className===o&&(!n||t&&t.style.backgroundColor&&(0,t4.fS)(X(t.style.backgroundColor),X(n)))){var a=t.firstElementChild;a instanceof HTMLCanvasElement&&(r=a.getContext("2d"))}if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(i=document.createElement("div")).className=o;var s=i.style;s.position="absolute",s.width="100%",s.height="100%";var l=(r=tg()).canvas;i.appendChild(l),(s=l.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=i,this.context=r}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}},{key:"clipUnrotated",value:function(t,e,n){var i=(0,M.rL)(n),r=(0,M.Xv)(n),o=(0,M.w$)(n),a=(0,M.hC)(n);(0,L.nn)(e.coordinateToPixelTransform,i),(0,L.nn)(e.coordinateToPixelTransform,r),(0,L.nn)(e.coordinateToPixelTransform,o),(0,L.nn)(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;(0,L.nn)(s,i),(0,L.nn)(s,r),(0,L.nn)(s,o),(0,L.nn)(s,a),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}},{key:"dispatchRenderEvent_",value:function(t,e,n){var i=this.getLayer();if(i.hasListener(t)){var r=new to(t,this.inversePixelTransform,n,e);i.dispatchEvent(r)}}},{key:"preRender",value:function(t,e){this.frameState=e,this.dispatchRenderEvent_(J.PRERENDER,t,e)}},{key:"postRender",value:function(t,e){this.dispatchRenderEvent_(J.POSTRENDER,t,e)}},{key:"getRenderTransform",value:function(t,e,n,i,r,o,a){var s=i/e,l=-t[0]+a,u=-t[1];return(0,L.qC)(this.tempTransform,r/2,o/2,s,-s,-n,l,u)}},{key:"disposeInternal",value:function(){delete this.frameState,R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}}]),i}(nE),nS=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r){var o;return(0,u.Z)(this,i),o=n.call(this),r=r||{},o.tileCoord=t,o.state=e,o.interimTile=null,o.key="",o.transition_=void 0===r.transition?250:r.transition,o.transitionStarts_={},o.interpolate=!!r.interpolate,o}return(0,c.Z)(i,[{key:"changed",value:function(){this.dispatchEvent(q.Z.CHANGE)}},{key:"release",value:function(){this.state===t$.ERROR&&this.setState(t$.EMPTY)}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==t$.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}},{key:"refreshInterimChain",value:function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==t$.LOADED){t.interimTile=null;break}t.getState()==t$.LOADING?e=t:t.getState()==t$.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(this.state!==t$.ERROR&&this.state>t)throw Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){(0,A.O3)()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var i=e-n+1e3/60;return i>=this.transition_?1:ee(i/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}]),i}(tY.Z),nw=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){var a;return(0,u.Z)(this,i),(a=n.call(this)).extent=t,a.pixelRatio_=r,a.resolution=e,a.state=o,a}return(0,c.Z)(i,[{key:"changed",value:function(){this.dispatchEvent(q.Z.CHANGE)}},{key:"getExtent",value:function(){return this.extent}},{key:"getImage",value:function(){return(0,A.O3)()}},{key:"getPixelRatio",value:function(){return this.pixelRatio_}},{key:"getResolution",value:function(){return this.resolution}},{key:"getState",value:function(){return this.state}},{key:"load",value:function(){(0,A.O3)()}}]),i}(tY.Z);function nP(t,e,n){var i=!0,r=!1,o=!1,a=[(0,$.Vx)(t,q.Z.LOAD,function(){o=!0,r||e()})];return t.src&&td.Tp?(r=!0,t.decode().then(function(){i&&e()}).catch(function(t){i&&(o?e():n())})):a.push((0,$.Vx)(t,q.Z.ERROR,n)),function(){i=!1,a.forEach($.bN)}}var nZ=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a,s){var l;return(0,u.Z)(this,i),(l=n.call(this,t,e,s)).crossOrigin_=o,l.src_=r,l.key=r,l.image_=new Image,null!==o&&(l.image_.crossOrigin=o),l.unlisten_=null,l.tileLoadFunction_=a,l}return(0,c.Z)(i,[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t,this.state=t$.LOADED,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){var t;this.state=t$.ERROR,this.unlistenImage_(),this.image_=((t=tg(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}},{key:"handleImageLoad_",value:function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=t$.LOADED:this.state=t$.EMPTY,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state==t$.ERROR&&(this.state=t$.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==t$.IDLE&&(this.state=t$.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=nP(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}]),i}(nS),nI=function(){function t(e,n,i,r,o,a){var s=this;(0,u.Z)(this,t),this.sourceProj_=e,this.targetProj_=n;var l={},c=(0,t2.Ck)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return l[e]||(l[e]=c(t)),l[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&(0,M.dz)(r)==(0,M.dz)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,M.dz)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,M.dz)(this.targetProj_.getExtent()):null;var h=(0,M.rL)(i),f=(0,M.Xv)(i),d=(0,M.w$)(i),v=(0,M.hC)(i),g=this.transformInv_(h),p=this.transformInv_(f),y=this.transformInv_(d),_=this.transformInv_(v),m=10+(a?Math.max(0,Math.ceil(Math.log2((0,M.bg)(i)/(a*a*65536)))):0);if(this.addQuad_(h,f,d,v,g,p,y,_,m),this.wrapsXInSource_){var x=1/0;this.triangles_.forEach(function(t,e,n){x=Math.min(x,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-x>s.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-x>s.sourceWorldWidth_/2&&(e[0][0]-=s.sourceWorldWidth_),e[1][0]-x>s.sourceWorldWidth_/2&&(e[1][0]-=s.sourceWorldWidth_),e[2][0]-x>s.sourceWorldWidth_/2&&(e[2][0]-=s.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<s.sourceWorldWidth_/2&&(t.source=e)}})}l={}}return(0,c.Z)(t,[{key:"addTriangle_",value:function(t,e,n,i,r,o){this.triangles_.push({source:[i,r,o],target:[t,e,n]})}},{key:"addQuad_",value:function(t,e,n,i,r,o,a,s,l){var u=(0,M.hI)([r,o,a,s]),c=this.sourceWorldWidth_?(0,M.dz)(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&c>.5&&c<1,d=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var v=(0,M.hI)([t,e,n,i]);d=(0,M.dz)(v)/this.targetWorldWidth_>.25||d}!f&&this.sourceProj_.isGlobal()&&c&&(d=c>.25||d)}if(!(!d&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!(0,M.kK)(u,this.maxSourceExtent_))){var g=0;if(!d&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(s[0])||!isFinite(s[1]))){if(l>0)d=!0;else if(1!=(g=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(s[0])&&isFinite(s[1])?0:1))&&2!=g&&4!=g&&8!=g)return}if(l>0){if(!d){var p,y=[(t[0]+n[0])/2,(t[1]+n[1])/2],_=this.transformInv_(y);p=f?((0,F.$W)(r[0],h)+(0,F.$W)(a[0],h))/2-(0,F.$W)(_[0],h):(r[0]+a[0])/2-_[0];var m=(r[1]+a[1])/2-_[1];d=p*p+m*m>this.errorThresholdSquared_}if(d){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var x=[(e[0]+n[0])/2,(e[1]+n[1])/2],R=this.transformInv_(x),E=[(i[0]+t[0])/2,(i[1]+t[1])/2],k=this.transformInv_(E);this.addQuad_(t,e,x,E,r,o,R,k,l-1),this.addQuad_(E,x,n,i,k,R,a,s,l-1)}else{var T=[(t[0]+e[0])/2,(t[1]+e[1])/2],C=this.transformInv_(T),S=[(n[0]+i[0])/2,(n[1]+i[1])/2],w=this.transformInv_(S);this.addQuad_(t,T,S,i,r,C,w,s,l-1),this.addQuad_(T,e,n,S,C,o,a,w,l-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(11&g)==0&&this.addTriangle_(t,n,i,r,a,s),(14&g)==0&&this.addTriangle_(t,n,e,r,a,o),g&&((13&g)==0&&this.addTriangle_(e,i,t,o,s,r),(7&g)==0&&this.addTriangle_(e,i,n,o,s,a))}}},{key:"calculateSourceExtent",value:function(){var t=(0,M.lJ)();return this.triangles_.forEach(function(e,n,i){var r=e.source;(0,M.Wj)(t,r[0]),(0,M.Wj)(t,r[1]),(0,M.Wj)(t,r[2])}),t}},{key:"getTriangles",value:function(){return this.triangles_}}]),t}(),nb=[];function nO(t,e,n,i,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(i,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,i)+1,Math.max(n,r)),t.restore()}function nA(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function nL(t,e,n,i){var r=(0,t2.vs)(n,e,t),o=(0,t2._Q)(e,i,n),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var s=t.getMetersPerUnit();void 0!==s&&(o/=s);var l=t.getExtent();if(!l||(0,M.b8)(l,r)){var u=(0,t2._Q)(t,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o}function nM(t,e,n,i){var r=nL(t,e,(0,M.qg)(n),i);return(!isFinite(r)||r<=0)&&(0,M.H6)(n,function(n){return isFinite(r=nL(t,e,n,i))&&r>0}),r}function nD(t,e,n,i,r,o,a,l,u,c,h,f){var d=tg(Math.round(n*t),Math.round(n*e),nb);if(f||(d.imageSmoothingEnabled=!1),0===u.length)return d.canvas;function v(t){return Math.round(t*n)/n}d.scale(n,n),d.globalCompositeOperation="lighter";var g=(0,M.lJ)();u.forEach(function(t,e,n){(0,M.l7)(g,t.extent)});var p=tg(Math.round(n*(0,M.dz)(g)/i),Math.round(n*(0,M.Cr)(g)/i),nb);f||(p.imageSmoothingEnabled=!1);var y=n/i;u.forEach(function(t,e,n){var i=t.extent[0]-g[0],r=-(t.extent[3]-g[3]),o=(0,M.dz)(t.extent),a=(0,M.Cr)(t.extent);t.image.width>0&&t.image.height>0&&p.drawImage(t.image,c,c,t.image.width-2*c,t.image.height-2*c,i*y,r*y,o*y,a*y)});var _=(0,M.rL)(a);return l.getTriangles().forEach(function(t,e,r){var a=t.source,l=t.target,u=a[0][0],c=a[0][1],h=a[1][0],y=a[1][1],m=a[2][0],x=a[2][1],R=v((l[0][0]-_[0])/o),E=v(-(l[0][1]-_[1])/o),k=v((l[1][0]-_[0])/o),T=v(-(l[1][1]-_[1])/o),C=v((l[2][0]-_[0])/o),S=v(-(l[2][1]-_[1])/o),w=u,P=c;u=0,c=0;var Z=[[h-=w,y-=P,0,0,k-R],[m-=w,x-=P,0,0,C-R],[0,0,h,y,T-E],[0,0,m,x,S-E]],I=(0,F.SV)(Z);if(I){if(d.save(),d.beginPath(),function(){if(void 0===s){var t=tg(6,6,nb);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",nO(t,4,5,4,0),nO(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;s=nA(e,0)||nA(e,4)||nA(e,8),tp(t),nb.push(t.canvas)}return s}()||!f){d.moveTo(k,T);for(var b=R-k,O=E-T,A=0;A<4;A++)d.lineTo(k+v((A+1)*b/4),T+v(A*O/3)),3!=A&&d.lineTo(k+v((A+1)*b/4),T+v((A+1)*O/3));d.lineTo(C,S)}else d.moveTo(k,T),d.lineTo(R,E),d.lineTo(C,S);d.clip(),d.transform(I[0],I[2],I[1],I[3],R,E),d.translate(g[0]-w,g[3]-P),d.scale(i/n,-i/n),d.drawImage(p.canvas,0,0),d.restore()}}),tp(p),nb.push(p.canvas),h&&(d.save(),d.globalCompositeOperation="source-over",d.strokeStyle="black",d.lineWidth=1,l.getTriangles().forEach(function(t,e,n){var i=t.target,r=(i[0][0]-_[0])/o,a=-(i[0][1]-_[1])/o,s=(i[1][0]-_[0])/o,l=-(i[1][1]-_[1])/o,u=(i[2][0]-_[0])/o,c=-(i[2][1]-_[1])/o;d.beginPath(),d.moveTo(s,l),d.lineTo(r,a),d.lineTo(u,c),d.closePath(),d.stroke()}),d.restore()),d.canvas}var nF=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a,s,l,c,h,d,v,g){(0,u.Z)(this,i),(p=n.call(this,a,t$.IDLE,{interpolate:!!g})).renderEdges_=void 0!==v&&v,p.pixelRatio_=l,p.gutter_=c,p.canvas_=null,p.sourceTileGrid_=e,p.targetTileGrid_=o,p.wrappedTileCoord_=s||a,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0;var p,y=o.getTileCoordExtent(p.wrappedTileCoord_),_=p.targetTileGrid_.getExtent(),m=p.sourceTileGrid_.getExtent(),x=_?(0,M.Ed)(y,_):y;if(0===(0,M.bg)(x))return p.state=t$.EMPTY,(0,f.Z)(p);var R=t.getExtent();R&&(m=m?(0,M.Ed)(m,R):R);var E=o.getResolution(p.wrappedTileCoord_[0]),k=nM(t,r,x,E);if(!isFinite(k)||k<=0||(p.triangulation_=new nI(t,r,x,m,k*(void 0!==d?d:.5),E),0===p.triangulation_.getTriangles().length))return p.state=t$.EMPTY,(0,f.Z)(p);p.sourceZ_=e.getZForResolution(k);var T=p.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(T[1]=(0,F.uZ)(T[1],m[1],m[3]),T[3]=(0,F.uZ)(T[3],m[1],m[3])):T=(0,M.Ed)(T,m)),(0,M.bg)(T)){for(var C=e.getTileRangeForExtentAndZ(T,p.sourceZ_),S=C.minX;S<=C.maxX;S++)for(var w=C.minY;w<=C.maxY;w++){var P=h(p.sourceZ_,S,w,l);P&&p.sourceTiles_.push(P)}0===p.sourceTiles_.length&&(p.state=t$.EMPTY)}else p.state=t$.EMPTY;return p}return(0,c.Z)(i,[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var t=this,e=[];if(this.sourceTiles_.forEach(function(n){n&&n.getState()==t$.LOADED&&e.push({extent:t.sourceTileGrid_.getTileCoordExtent(n.tileCoord),image:n.getImage()})}),this.sourceTiles_.length=0,0===e.length)this.state=t$.ERROR;else{var n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),r="number"==typeof i?i:i[0],o="number"==typeof i?i:i[1],a=this.targetTileGrid_.getResolution(n),s=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=nD(r,o,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=t$.LOADED}this.changed()}},{key:"load",value:function(){var t=this;if(this.state==t$.IDLE){this.state=t$.LOADING,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n){var i=n.getState();if(i==t$.IDLE||i==t$.LOADING){e++;var r=(0,$.oL)(n,q.Z.CHANGE,function(t){var i=n.getState();(i==t$.LOADED||i==t$.ERROR||i==t$.EMPTY)&&((0,$.bN)(r),0==--e&&(this.unlistenSources_(),this.reproject_()))},t);t.sourcesListenerKeys_.push(r)}}),0===e?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,e,n){t.getState()==t$.IDLE&&t.load()})}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach($.bN),this.sourcesListenerKeys_=null}},{key:"release",value:function(){this.canvas_&&(tp(this.canvas_.getContext("2d")),nb.push(this.canvas_),this.canvas_=null),R((0,d.Z)(i.prototype),"release",this).call(this)}}]),i}(nS),nN=function(){function t(e,n,i,r){(0,u.Z)(this,t),this.minX=e,this.maxX=n,this.minY=i,this.maxY=r}return(0,c.Z)(t,[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}]),t}();function nB(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new nN(t,e,n,i)}var nG=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,t)).extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=(0,M.lJ)(),e.tmpTileRange_=new nN(0,0,0,0),e}return(0,c.Z)(i,[{key:"isDrawableTile",value:function(t){var e=this.getLayer(),n=t.getState(),i=e.getUseInterimTilesOnError();return n==t$.LOADED||n==t$.EMPTY||n==t$.ERROR&&!i}},{key:"getTile",value:function(t,e,n,i){var r=i.pixelRatio,o=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(t,e,n,r,o);return s.getState()==t$.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(s)||(s=s.getInterimTile()),s}},{key:"getData",value:function(t){var e=this.frameState;if(!e)return null;var n=this.getLayer(),i=(0,L.nn)(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!(0,M.b8)(r,i))return null;for(var o=e.pixelRatio,a=e.viewState.projection,s=e.viewState,l=n.getRenderSource(),u=l.getTileGridForProjection(s.projection),c=l.getTilePixelRatio(e.pixelRatio),h=u.getZForResolution(s.resolution);h>=u.getMinZoom();--h){var f=u.getTileCoordForCoordAndZ(i,h),d=l.getTile(h,f[1],f[2],o,a);if(!(d instanceof nZ||d instanceof nF)||d instanceof nF&&d.getState()===t$.EMPTY)break;if(d.getState()===t$.LOADED){var v=u.getOrigin(h),g=nv(u.getTileSize(h)),p=u.getResolution(h),y=Math.floor(c*((i[0]-v[0])/p-f[1]*g[0])),_=Math.floor(c*((v[1]-i[1])/p-f[2]*g[1])),m=Math.round(c*l.getGutterForProjection(s.projection));return this.getImageData(d.getImage(),y+m,_+m)}}return null}},{key:"loadedTileCallback",value:function(t,e,n){return!!this.isDrawableTile(n)&&R((0,d.Z)(i.prototype),"loadedTileCallback",this).call(this,t,e,n)}},{key:"prepareFrame",value:function(t){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(t,e){var n,i,r,o=t.layerStatesArray[t.layerIndex],a=t.viewState,s=a.projection,l=a.resolution,u=a.center,c=a.rotation,h=t.pixelRatio,f=this.getLayer(),d=f.getSource(),v=d.getRevision(),g=d.getTileGridForProjection(s),p=g.getZForResolution(l,d.zDirection),y=g.getResolution(p),_=t.extent,m=t.viewState.resolution,x=d.getTilePixelRatio(h),R=Math.round((0,M.dz)(_)/m*h),E=Math.round((0,M.Cr)(_)/m*h),k=o.extent&&(0,t2.dY)(o.extent,s);k&&(_=(0,M.Ed)(_,(0,t2.dY)(o.extent,s)));var T=y*R/2/x,C=y*E/2/x,S=[u[0]-T,u[1]-C,u[0]+T,u[1]+C],w=g.getTileRangeForExtentAndZ(_,p),P={};P[p]={};var Z=this.createLoadedTileFinder(d,s,P),I=this.tmpExtent,b=this.tmpTileRange_;this.newTiles_=!1;for(var O=c?(0,M.dY)(a.center,m,c,t.size):void 0,D=w.minX;D<=w.maxX;++D)for(var F=w.minY;F<=w.maxY;++F)if(!c||g.tileCoordIntersectsViewport([p,D,F],O)){var N=this.getTile(p,D,F,t);if(this.isDrawableTile(N)){var B=(0,A.sq)(this);if(N.getState()==t$.LOADED){P[p][N.tileCoord.toString()]=N;var G=N.inTransition(B);G&&1!==o.opacity&&(N.endTransition(B),G=!1),this.newTiles_||!G&&this.renderedTiles.includes(N)||(this.newTiles_=!0)}if(1===N.getAlpha(B,t.time))continue}var U=g.getTileCoordChildTileRange(N.tileCoord,b,I),z=!1;U&&(z=Z(p+1,U)),z||g.forEachTileCoordParentTileRange(N.tileCoord,Z,b,I)}var X=y/l*h/x;(0,L.qC)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,c,-R/2,-E/2);var j=(0,L.BB)(this.pixelTransform);this.useContainer(e,j,this.getBackground(t));var W=this.context,Y=W.canvas;(0,L.nb)(this.inversePixelTransform,this.pixelTransform),(0,L.qC)(this.tempTransform,R/2,E/2,X,X,0,-R/2,-E/2),Y.width!=R||Y.height!=E?(Y.width=R,Y.height=E):this.containerReused||W.clearRect(0,0,R,E),k&&this.clipUnrotated(W,t,k),d.getInterpolate()||(W.imageSmoothingEnabled=!1),this.preRender(W,t),this.renderedTiles.length=0;var V=Object.keys(P).map(Number);V.sort(t4.j2),1===o.opacity&&(!this.containerReused||d.getOpaque(t.viewState.projection))?V=V.reverse():(n=[],i=[]);for(var H=V.length-1;H>=0;--H){var K=V[H],q=d.getTilePixelSize(K,h,s),J=g.getResolution(K)/y,$=q[0]*J*X,Q=q[1]*J*X,tt=g.getTileCoordForCoordAndZ((0,M.rL)(S),K),te=g.getTileCoordExtent(tt),tn=(0,L.nn)(this.tempTransform,[x*(te[0]-S[0])/y,x*(S[3]-te[3])/y]),ti=x*d.getGutterForProjection(s),tr=P[K];for(var to in tr){var ta=tr[to],ts=ta.tileCoord,tl=tt[1]-ts[1],tu=Math.round(tn[0]-(tl-1)*$),tc=tt[2]-ts[2],th=Math.round(tn[1]-(tc-1)*Q),tf=Math.round(tn[0]-tl*$),td=Math.round(tn[1]-tc*Q),tv=tu-tf,tg=th-td,tp=p===K,ty=tp&&1!==ta.getAlpha((0,A.sq)(this),t.time),t_=!1;if(!ty){if(n){r=[tf,td,tf+tv,td,tf+tv,td+tg,tf,td+tg];for(var tm=0,tx=n.length;tm<tx;++tm)if(p!==K&&K<i[tm]){var tR=n[tm];(0,M.kK)([tf,td,tf+tv,td+tg],[tR[0],tR[3],tR[4],tR[7]])&&(t_||(W.save(),t_=!0),W.beginPath(),W.moveTo(r[0],r[1]),W.lineTo(r[2],r[3]),W.lineTo(r[4],r[5]),W.lineTo(r[6],r[7]),W.moveTo(tR[6],tR[7]),W.lineTo(tR[4],tR[5]),W.lineTo(tR[2],tR[3]),W.lineTo(tR[0],tR[1]),W.clip())}n.push(r),i.push(K)}else W.clearRect(tf,td,tv,tg)}this.drawTileImage(ta,t,tf,td,tv,tg,ti,tp),n&&!ty?(t_&&W.restore(),this.renderedTiles.unshift(ta)):this.renderedTiles.push(ta),this.updateUsedTiles(t.usedTiles,d,ta)}}return this.renderedRevision=v,this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!(0,M.fS)(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=h,this.renderedProjection=s,this.manageTilePyramid(t,d,g,h,s,_,p,f.getPreload()),this.scheduleExpireCache(t,d),this.postRender(W,t),o.extent&&W.restore(),W.imageSmoothingEnabled=!0,j!==Y.style.transform&&(Y.style.transform=j),this.container}},{key:"drawTileImage",value:function(t,e,n,i,r,o,a,s){var l=this.getTileImage(t);if(l){var u=(0,A.sq)(this),c=e.layerStatesArray[e.layerIndex],h=c.opacity*(s?t.getAlpha(u,e.time):1),f=h!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,n,i,r,o),f&&this.context.restore(),h!==c.opacity?e.animate=!0:s&&t.endTransition(u)}}},{key:"getImage",value:function(){var t=this.context;return t?t.canvas:null}},{key:"getTileImage",value:function(t){return t.getImage()}},{key:"scheduleExpireCache",value:function(t,e){if(e.canExpireCache()){var n=(function(t,e,n){var i=(0,A.sq)(t);i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}).bind(null,e);t.postRenderFunctions.push(n)}}},{key:"updateUsedTiles",value:function(t,e,n){var i=(0,A.sq)(e);i in t||(t[i]={}),t[i][n.getKey()]=!0}},{key:"manageTilePyramid",value:function(t,e,n,i,r,o,a,s,l){var u,c,h,f,d,v,g=(0,A.sq)(e);g in t.wantedTiles||(t.wantedTiles[g]={});var p=t.wantedTiles[g],y=t.tileQueue,_=n.getMinZoom(),m=t.viewState.rotation,x=m?(0,M.dY)(t.viewState.center,t.viewState.resolution,m,t.size):void 0,R=0;for(v=_;v<=a;++v)for(c=n.getTileRangeForExtentAndZ(o,v,c),h=n.getResolution(v),f=c.minX;f<=c.maxX;++f)for(d=c.minY;d<=c.maxY;++d)(!m||n.tileCoordIntersectsViewport([v,f,d],x))&&(a-v<=s?(++R,(u=e.getTile(v,f,d,i,r)).getState()!=t$.IDLE||(p[u.getKey()]=!0,y.isKeyQueued(u.getKey())||y.enqueue([u,g,n.getTileCoordCenter(u.tileCoord),h])),void 0!==l&&l(u)):e.useTile(v,f,d,r));e.updateCacheSize(R,r)}}]),i}(nC),nU=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){return(0,u.Z)(this,i),n.call(this,t)}return(0,c.Z)(i,[{key:"createRenderer",value:function(){return new nG(this)}}]),i}(nx),nz=function(){function t(e){(0,u.Z)(this,t),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return(0,c.Z)(t,[{key:"canExpireCache",value:function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(t){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(t){return this.entries_.hasOwnProperty(t)}},{key:"forEach",value:function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer}},{key:"get",value:function(t,e){var n=this.entries_[t];return(0,D.h)(void 0!==n,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}},{key:"remove",value:function(t){var e=this.entries_[t];return(0,D.h)(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){var t,e=Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e}},{key:"getValues",value:function(){var t,e=Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"peek",value:function(t){if(this.containsKey(t))return this.entries_[t].value_}},{key:"pop",value:function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}},{key:"replace",value:function(t,e){this.get(t),this.entries_[t].value_=e}},{key:"set",value:function(t,e){(0,D.h)(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}},{key:"setSize",value:function(t){this.highWaterMark=t}}]),t}();function nX(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function nj(t,e,n){return t+"/"+e+"/"+n}function nW(t){return nj(t[0],t[1],t[2])}n(6835);var nY=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"clear",value:function(){for(;this.getCount()>0;)this.pop().release();R((0,d.Z)(i.prototype),"clear",this).call(this)}},{key:"expireCache",value:function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey() in t);)this.pop().release()}},{key:"pruneExceptNewestZ",value:function(){var t=this;if(0!==this.getCount()){var e=this.peekFirstKey().split("/").map(Number)[0];this.forEach(function(n){n.tileCoord[0]!==e&&(t.remove(nW(n.tileCoord)),n.release())})}}}]),i}(nz),nV={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},nH=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),(e=n.call(this)).projection=(0,t2.U2)(t.projection),e.attributions_=nK(t.attributions),e.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,e.loading=!1,e.state_=void 0!==t.state?t.state:"ready",e.wrapX_=void 0!==t.wrapX&&t.wrapX,e.interpolate_=!!t.interpolate,e.viewResolver=null,e.viewRejector=null;var e,r=(0,E.Z)(e);return e.viewPromise_=new Promise(function(t,e){r.viewResolver=t,r.viewRejector=e}),e}return(0,c.Z)(i,[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(t){return null}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=nK(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}]),i}(k.Z);function nK(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var nq=[0,0,0],nJ=function(){function t(e){if((0,u.Z)(this,t),this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,(0,D.h)((0,t4.pT)(this.resolutions_,function(t,e){return e-t},!0),17),!e.origins)for(var n,i=0,r=this.resolutions_.length-1;i<r;++i)if(n){if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}else n=this.resolutions_[i]/this.resolutions_[i+1];this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,(0,D.h)(this.origins_.length==this.resolutions_.length,20));var o=e.extent;void 0===o||this.origin_||this.origins_||(this.origin_=(0,M.rL)(o)),(0,D.h)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,(0,D.h)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:256,(0,D.h)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==o?o:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map(function(t,e){var n=new nN(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(o){var i=this.getTileRangeForExtentAndZ(o,e);n.minX=Math.max(i.minX,n.minX),n.maxX=Math.min(i.maxX,n.maxX),n.minY=Math.max(i.minY,n.minY),n.maxY=Math.min(i.maxY,n.maxY)}return n},this):o&&this.calculateTileRanges_(o)}return(0,c.Z)(t,[{key:"forEachTileCoord",value:function(t,e,n){for(var i=this.getTileRangeForExtentAndZ(t,e),r=i.minX,o=i.maxX;r<=o;++r)for(var a=i.minY,s=i.maxY;a<=s;++a)n([e,r,a])}},{key:"forEachTileCoordParentTileRange",value:function(t,e,n,i){var r,o,a,s=null,l=t[0]-1;for(2===this.zoomFactor_?(o=t[1],a=t[2]):s=this.getTileCoordExtent(t,i);l>=this.minZoom;){if(r=2===this.zoomFactor_?nB(o=Math.floor(o/2),o,a=Math.floor(a/2),a,n):this.getTileRangeForExtentAndZ(s,l,n),e(l,r))return!0;--l}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(t){return this.origin_?this.origin_:this.origins_[t]}},{key:"getResolution",value:function(t){return this.resolutions_[t]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var i=2*t[1],r=2*t[2];return nB(i,i+1,r,r+1,e)}var o=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null}},{key:"getTileRangeForTileCoordAndZ",value:function(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;var i=t[0],r=t[1],o=t[2];if(e===i)return nB(r,o,r,o,n);if(this.zoomFactor_){var a=Math.pow(this.zoomFactor_,e-i),s=Math.floor(r*a),l=Math.floor(o*a);return e<i?nB(s,s,l,l,n):nB(s,Math.floor(a*(r+1))-1,l,Math.floor(a*(o+1))-1,n)}var u=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(u,e,n)}},{key:"getTileRangeExtent",value:function(t,e,n){var i=this.getOrigin(t),r=this.getResolution(t),o=nv(this.getTileSize(t),this.tmpSize_),a=i[0]+e.minX*o[0]*r,s=i[0]+(e.maxX+1)*o[0]*r,l=i[1]+e.minY*o[1]*r,u=i[1]+(e.maxY+1)*o[1]*r;return(0,M.T9)(a,l,s,u,n)}},{key:"getTileRangeForExtentAndZ",value:function(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,nq);var i=nq[1],r=nq[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,nq),nB(i,nq[1],r,nq[2],n)}},{key:"getTileCoordCenter",value:function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=nv(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]}},{key:"getTileCoordExtent",value:function(t,e){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=nv(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*i,a=n[1]-(t[2]+1)*r[1]*i,s=o+r[0]*i,l=a+r[1]*i;return(0,M.T9)(o,a,s,l,e)}},{key:"getTileCoordForCoordAndResolution",value:function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}},{key:"getTileCoordForXYAndResolution_",value:function(t,e,n,i,r){var o=this.getZForResolution(n),a=n/this.getResolution(o),s=this.getOrigin(o),l=nv(this.getTileSize(o),this.tmpSize_),u=a*(t-s[0])/n/l[0],c=a*(s[1]-e)/n/l[1];return i?(u=(0,F.mD)(u,5)-1,c=(0,F.mD)(c,5)-1):(u=(0,F.GW)(u,5),c=(0,F.GW)(c,5)),nX(o,u,c,r)}},{key:"getTileCoordForXYAndZ_",value:function(t,e,n,i,r){var o=this.getOrigin(n),a=this.getResolution(n),s=nv(this.getTileSize(n),this.tmpSize_),l=(t-o[0])/a/s[0],u=(o[1]-e)/a/s[1];return i?(l=(0,F.mD)(l,5)-1,u=(0,F.mD)(u,5)-1):(l=(0,F.GW)(l,5),u=(0,F.GW)(u,5)),nX(n,l,u,r)}},{key:"getTileCoordForCoordAndZ",value:function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}},{key:"getTileCoordResolution",value:function(t){return this.resolutions_[t[0]]}},{key:"getTileSize",value:function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}},{key:"getFullTileRange",value:function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}},{key:"getZForResolution",value:function(t,e){var n=(0,t4.h7)(this.resolutions_,t,e||0);return(0,F.uZ)(n,this.minZoom,this.maxZoom)}},{key:"tileCoordIntersectsViewport",value:function(t,e){return ew(e,0,e.length,2,this.getTileCoordExtent(t))}},{key:"calculateTileRanges_",value:function(t){for(var e=this.resolutions_.length,n=Array(e),i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n}}]),t}();function n$(t){var e,n,i,r,o,a,s=t.getDefaultTileGrid();return s||(r=n0(t),o=void 0,o="top-left",a=nQ(r,void 0,n),s=new nJ({extent:r,origin:(0,M.g0)(r,o),resolutions:a,tileSize:n}),t.setDefaultTileGrid(s)),s}function nQ(t,e,n,i){e=void 0!==e?e:42,n=nv(void 0!==n?n:256);var r=(0,M.Cr)(t),o=(0,M.dz)(t);i=i>0?i:Math.max(o/n[0],r/n[1]);for(var a=e+1,s=Array(a),l=0;l<a;++l)s[l]=i/Math.pow(2,l);return s}function n0(t){var e=(t=(0,t2.U2)(t)).getExtent();if(!e){var n=180*t2.Wm.degrees/t.getMetersPerUnit();e=(0,M.T9)(-n,-n,n,n)}return e}function n1(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var n2=function(t){(0,h.Z)(n,t);var e=n1(n);function n(t){var i;return(0,u.Z)(this,n),(i=e.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})).on,i.once,i.un,i.opaque_=void 0!==t.opaque&&t.opaque,i.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,i.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,i.tileGrid&&nv(i.tileGrid.getTileSize(i.tileGrid.getMinZoom()),[256,256]),i.tileCache=new nY(t.cacheSize||0),i.tmpSize=[0,0],i.key_=t.key||"",i.tileOptions={transition:t.transition,interpolate:t.interpolate},i.zDirection=t.zDirection?t.zDirection:0,i}return(0,c.Z)(n,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}},{key:"forEachLoadedTile",value:function(t,e,n,i){var r,o,a,s=this.getTileCacheForProjection(t);if(!s)return!1;for(var l=!0,u=n.minX;u<=n.maxX;++u)for(var c=n.minY;c<=n.maxY;++c)o=nj(e,u,c),a=!1,s.containsKey(o)&&(a=(r=s.get(o)).getState()===t$.LOADED)&&(a=!1!==i(r)),a||(l=!1);return l}},{key:"getGutterForProjection",value:function(t){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(t){this.key_!==t&&(this.key_=t,this.changed())}},{key:"getOpaque",value:function(t){return this.opaque_}},{key:"getResolutions",value:function(t){var e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}},{key:"getTile",value:function(t,e,n,i,r){return(0,A.O3)()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(t){return this.tileGrid?this.tileGrid:n$(t)}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();return(0,D.h)(null===e||(0,t2.OP)(e,t),68),this.tileCache}},{key:"getTilePixelRatio",value:function(t){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(t,e,n){var i,r,o,a=this.getTileGridForProjection(n),s=this.getTilePixelRatio(e),l=nv(a.getTileSize(t),this.tmpSize);return 1==s?l:(i=l,r=s,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=i[0]*r+.5|0,o[1]=i[1]*r+.5|0,o)}},{key:"getTileCoordForTileUrlFunction",value:function(t,e){e=void 0!==e?e:this.getProjection();var n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,n){var i=e[0],r=t.getTileCoordCenter(e),o=n0(n);if(!(0,M.b8)(o,r)){var a=(0,M.dz)(o),s=Math.ceil((o[0]-r[0])/a);return r[0]+=a*s,t.getTileCoordForCoordAndZ(r,i)}return e}(n,t,e)),!function(t,e){var n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o=e.getFullTileRange(n);return!o||o.containsXY(i,r)}(t,n)?null:t}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),R((0,d.Z)(n.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(t,e){var n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}},{key:"useTile",value:function(t,e,n,i){}}]),n}(nH),n3=function(t){(0,h.Z)(n,t);var e=n1(n);function n(t,i){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).tile=i,r}return(0,c.Z)(n)}(S.ZP);function n5(t,e){t.getImage().src=e}var n4=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r,o,a,s=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",l=void 0!==t.tileGrid?t.tileGrid:(o={extent:r=(e={extent:n0(s),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize}).extent||(0,t2.U2)("EPSG:3857").getExtent(),minZoom:e.minZoom,tileSize:e.tileSize,resolutions:nQ(r,e.maxZoom,e.tileSize,e.maxResolution)},new nJ(o));return(a=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:s,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:l,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).gutter_=void 0!==t.gutter?t.gutter:0,a}return(0,c.Z)(i,[{key:"getGutter",value:function(){return this.gutter_}}]),i}(function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:n5,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,e.tileClass=void 0!==t.tileClass?t.tileClass:nZ,e.tileCacheForProjection={},e.tileGridForProjection={},e.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,e.renderReprojectionEdges_=!1,e}return(0,c.Z)(i,[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(t,e){var n=this.getTileCacheForProjection(t);for(var i in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[i];r.expireCache(r==n?e:{})}}},{key:"getGutterForProjection",value:function(t){return this.getProjection()&&t&&!(0,t2.OP)(this.getProjection(),t)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var t=R((0,d.Z)(i.prototype),"getKey",this).call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t}},{key:"getOpaque",value:function(t){return(!this.getProjection()||!t||!!(0,t2.OP)(this.getProjection(),t))&&R((0,d.Z)(i.prototype),"getOpaque",this).call(this,t)}},{key:"getTileGridForProjection",value:function(t){var e=this.getProjection();if(this.tileGrid&&(!e||(0,t2.OP)(e,t)))return this.tileGrid;var n=(0,A.sq)(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=n$(t)),this.tileGridForProjection[n]}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();if(!e||(0,t2.OP)(e,t))return this.tileCache;var n=(0,A.sq)(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new nY(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}},{key:"createTile_",value:function(t,e,n,i,r,o){var a=[t,e,n],s=this.getTileCoordForTileUrlFunction(a,r),l=s?this.tileUrlFunction(s,i,r):void 0,u=new this.tileClass(a,void 0!==l?t$.IDLE:t$.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(q.Z.CHANGE,this.handleTileChange.bind(this)),u}},{key:"getTile",value:function(t,e,n,i,r){var o,a=this,s=this.getProjection();if(!s||!r||(0,t2.OP)(s,r))return this.getTileInternal(t,e,n,i,s||r);var l=this.getTileCacheForProjection(r),u=[t,e,n],c=nW(u);l.containsKey(c)&&(o=l.get(c));var h=this.getKey();if(o&&o.key==h)return o;var f=this.getTileGridForProjection(s),d=this.getTileGridForProjection(r),v=this.getTileCoordForTileUrlFunction(u,r),g=new nF(s,f,r,d,u,v,this.getTilePixelRatio(i),this.getGutter(),function(t,e,n,i){return a.getTileInternal(t,e,n,i,s)},this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return g.key=h,o?(g.interimTile=o,g.refreshInterimChain(),l.replace(c,g)):l.set(c,g),g}},{key:"getTileInternal",value:function(t,e,n,i,r){var o=null,a=nj(t,e,n),s=this.getKey();if(this.tileCache.containsKey(a)){if((o=this.tileCache.get(a)).key!=s){var l=o;o=this.createTile_(t,e,n,i,r,s),l.getState()==t$.IDLE?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,n,i,r,s),this.tileCache.set(a,o);return o}},{key:"setRenderReprojectionEdges",value:function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(t,e){var n=(0,t2.U2)(t);if(n){var i=(0,A.sq)(n);i in this.tileGridForProjection||(this.tileGridForProjection[i]=e)}}},{key:"clear",value:function(){for(var t in R((0,d.Z)(i.prototype),"clear",this).call(this),this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}]),i}(function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).generateTileUrlFunction_=e.tileUrlFunction===i.prototype.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(e.tileUrlFunction=t.tileUrlFunction),e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.tileLoadingKeys_={},e}return(0,c.Z)(i,[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(t){var e,n=t.target,i=(0,A.sq)(n),r=n.getState();r==t$.LOADING?(this.tileLoadingKeys_[i]=!0,e=nV.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],e=r==t$.ERROR?nV.TILELOADERROR:r==t$.LOADED?nV.TILELOADEND:void 0),void 0!=e&&this.dispatchEvent(new n3(e,n))}},{key:"setTileLoadFunction",value:function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}},{key:"setTileUrlFunction",value:function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}},{key:"setUrl",value:function(t){var e=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var i,r=n[1].charCodeAt(0),o=n[2].charCodeAt(0);for(i=r;i<=o;++i)e.push(t.replace(n[0],String.fromCharCode(i)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),s=parseInt(n[1],10);s<=a;s++)e.push(t.replace(n[0],s.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}},{key:"setUrls",value:function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var n=t.length,i=Array(n),r=0;r<n;++r)i[r]=function(t,e){var n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(a,s,l){if(a)return t.replace(n,a[0].toString()).replace(i,a[1].toString()).replace(r,a[2].toString()).replace(o,function(){var t=a[0],n=e.getFullTileRange(t);return(0,D.h)(n,55),(n.getHeight()-a[2]-1).toString()})}}(t[r],e);return function(t){return 1===t.length?t[0]:function(e,n,i){if(e){var r,o=((r=e)[1]<<r[0])+r[2],a=(0,F.$W)(o,t.length);return t[a](e,n,i)}}}(i)}(t,this.tileGrid),e):this.setKey(e)}},{key:"tileUrlFunction",value:function(t,e,n){}},{key:"useTile",value:function(t,e,n){var i=nj(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)}}]),i}(n2))),n6=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i)}(n_),n8=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).on,e.once,e.un,e.id_=void 0,e.geometryName_="geometry",e.style_=null,e.styleFunction_=void 0,e.geometryChangeKey_=null,e.addChangeListener(e.geometryName_,e.handleGeometryChanged_),t&&("function"==typeof t.getSimplifiedGeometry?e.setGeometry(t):e.setProperties(t)),e}return(0,c.Z)(i,[{key:"clone",value:function(){var t=new i(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var n=this.getStyle();return n&&t.setStyle(n),t}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&((0,$.bN)(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=(0,$.oL)(t,q.Z.CHANGE,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(t){this.set(this.geometryName_,t)}},{key:"setStyle",value:function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;if(Array.isArray(t))e=t;else{var e;(0,D.h)("function"==typeof t.getZIndex,41),e=[t]}return function(){return e}}(t):void 0,this.changed()}},{key:"setId",value:function(t){this.id_=t,this.changed()}},{key:"setGeometryName",value:function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}]),i}(k.Z),n7=n(3935),n9=n(46);let it="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,ie="function"==typeof AbortController,ii=ie?AbortController:class{constructor(){this.signal=new ia}abort(t=Error("This operation was aborted")){this.signal.reason=this.signal.reason||t,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},ir="function"==typeof AbortSignal,io="function"==typeof ii.AbortSignal,ia=ir?AbortSignal:io?ii.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(t){"abort"===t.type&&(this.aborted=!0,this.onabort(t),this._listeners.forEach(e=>e(t),this))}onabort(){}addEventListener(t,e){"abort"===t&&this._listeners.push(e)}removeEventListener(t,e){"abort"===t&&(this._listeners=this._listeners.filter(t=>t!==e))}},is=new Set,il=(t,e)=>{let n=`LRU_CACHE_OPTION_${t}`;id(n)&&iv(n,`${t} option`,`options.${e}`,im)},iu=(t,e)=>{let n=`LRU_CACHE_METHOD_${t}`;if(id(n)){let{prototype:i}=im,{get:r}=Object.getOwnPropertyDescriptor(i,t);iv(n,`${t} method`,`cache.${e}()`,r)}},ic=(t,e)=>{let n=`LRU_CACHE_PROPERTY_${t}`;if(id(n)){let{prototype:i}=im,{get:r}=Object.getOwnPropertyDescriptor(i,t);iv(n,`${t} property`,`cache.${e}`,r)}},ih=(...t)=>{"object"==typeof n9&&n9&&"function"==typeof n9.emitWarning?n9.emitWarning(...t):console.error(...t)},id=t=>!is.has(t),iv=(t,e,n,i)=>{is.add(t);let r=`The ${e} is deprecated. Please use ${n} instead.`;ih(r,"DeprecationWarning",t,i)},ig=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),ip=t=>ig(t)?t<=256?Uint8Array:t<=65536?Uint16Array:t<=4294967296?Uint32Array:t<=Number.MAX_SAFE_INTEGER?iy:null:null;class iy extends Array{constructor(t){super(t),this.fill(0)}}class i_{constructor(t){if(0===t)return[];let e=ip(t);this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class im{constructor(t={}){let{max:e=0,ttl:n,ttlResolution:i=1,ttlAutopurge:r,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:s,dispose:l,disposeAfter:u,noDisposeOnSet:c,noUpdateTTL:h,maxSize:f=0,maxEntrySize:d=0,sizeCalculation:v,fetchMethod:g,fetchContext:p,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:_,allowStaleOnFetchRejection:m,allowStaleOnFetchAbort:x,ignoreFetchAbort:R}=t,{length:E,maxAge:k,stale:T}=t instanceof im?{}:t;if(0!==e&&!ig(e))throw TypeError("max option must be a nonnegative integer");let C=e?ip(e):Array;if(!C)throw Error("invalid max value: "+e);if(this.max=e,this.maxSize=f,this.maxEntrySize=d||this.maxSize,this.sizeCalculation=v||E,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=g||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw TypeError("fetchMethod must be a function if specified");if(this.fetchContext=p,!this.fetchMethod&&void 0!==p)throw TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=Array(e).fill(null),this.valList=Array(e).fill(null),this.next=new C(e),this.prev=new C(e),this.head=0,this.tail=0,this.free=new i_(e),this.initialFill=1,this.size=0,"function"==typeof l&&(this.dispose=l),"function"==typeof u?(this.disposeAfter=u,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!c,this.noUpdateTTL=!!h,this.noDeleteOnFetchRejection=!!y,this.allowStaleOnFetchRejection=!!m,this.allowStaleOnFetchAbort=!!x,this.ignoreFetchAbort=!!R,0!==this.maxEntrySize){if(0!==this.maxSize&&!ig(this.maxSize))throw TypeError("maxSize must be a positive integer if specified");if(!ig(this.maxEntrySize))throw TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!s||!!T,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=ig(i)||0===i?i:1,this.ttlAutopurge=!!r,this.ttl=n||k||0,this.ttl){if(!ig(this.ttl))throw TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let t="LRU_CACHE_UNBOUNDED";id(t)&&(is.add(t),ih("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",t,im))}T&&il("stale","allowStale"),k&&il("maxAge","ttl"),E&&il("length","sizeCalculation")}getRemainingTTL(t){return this.has(t,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new iy(this.max),this.starts=new iy(this.max),this.setItemTTL=(t,e,n=it.now())=>{if(this.starts[t]=0!==e?n:0,this.ttls[t]=e,0!==e&&this.ttlAutopurge){let n=setTimeout(()=>{this.isStale(t)&&this.delete(this.keyList[t])},e+1);n.unref&&n.unref()}},this.updateItemAge=t=>{this.starts[t]=0!==this.ttls[t]?it.now():0},this.statusTTL=(n,i)=>{n&&(n.ttl=this.ttls[i],n.start=this.starts[i],n.now=t||e(),n.remainingTTL=n.now+n.ttl-n.start)};let t=0,e=()=>{let e=it.now();if(this.ttlResolution>0){t=e;let n=setTimeout(()=>t=0,this.ttlResolution);n.unref&&n.unref()}return e};this.getRemainingTTL=n=>{let i=this.keyMap.get(n);return void 0===i?0:0===this.ttls[i]||0===this.starts[i]?1/0:this.starts[i]+this.ttls[i]-(t||e())},this.isStale=n=>0!==this.ttls[n]&&0!==this.starts[n]&&(t||e())-this.starts[n]>this.ttls[n]}updateItemAge(t){}statusTTL(t,e){}setItemTTL(t,e,n){}isStale(t){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new iy(this.max),this.removeItemSize=t=>{this.calculatedSize-=this.sizes[t],this.sizes[t]=0},this.requireSize=(t,e,n,i)=>{if(this.isBackgroundFetch(e))return 0;if(!ig(n)){if(i){if("function"!=typeof i)throw TypeError("sizeCalculation must be a function");if(!ig(n=i(e,t)))throw TypeError("sizeCalculation return invalid (expect positive integer)")}else throw TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.")}return n},this.addItemSize=(t,e,n)=>{if(this.sizes[t]=e,this.maxSize){let e=this.maxSize-this.sizes[t];for(;this.calculatedSize>e;)this.evict(!0)}this.calculatedSize+=this.sizes[t],n&&(n.entrySize=e,n.totalCalculatedSize=this.calculatedSize)}}removeItemSize(t){}addItemSize(t,e){}requireSize(t,e,n,i){if(n||i)throw TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:t=this.allowStale}={}){if(this.size)for(let e=this.tail;this.isValidIndex(e)&&((t||!this.isStale(e))&&(yield e),e!==this.head);)e=this.prev[e]}*rindexes({allowStale:t=this.allowStale}={}){if(this.size)for(let e=this.head;this.isValidIndex(e)&&((t||!this.isStale(e))&&(yield e),e!==this.tail);)e=this.next[e]}isValidIndex(t){return void 0!==t&&this.keyMap.get(this.keyList[t])===t}*entries(){for(let t of this.indexes())void 0===this.valList[t]||void 0===this.keyList[t]||this.isBackgroundFetch(this.valList[t])||(yield[this.keyList[t],this.valList[t]])}*rentries(){for(let t of this.rindexes())void 0===this.valList[t]||void 0===this.keyList[t]||this.isBackgroundFetch(this.valList[t])||(yield[this.keyList[t],this.valList[t]])}*keys(){for(let t of this.indexes())void 0===this.keyList[t]||this.isBackgroundFetch(this.valList[t])||(yield this.keyList[t])}*rkeys(){for(let t of this.rindexes())void 0===this.keyList[t]||this.isBackgroundFetch(this.valList[t])||(yield this.keyList[t])}*values(){for(let t of this.indexes())void 0===this.valList[t]||this.isBackgroundFetch(this.valList[t])||(yield this.valList[t])}*rvalues(){for(let t of this.rindexes())void 0===this.valList[t]||this.isBackgroundFetch(this.valList[t])||(yield this.valList[t])}[Symbol.iterator](){return this.entries()}find(t,e){for(let n of this.indexes()){let i=this.valList[n],r=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(void 0!==r&&t(r,this.keyList[n],this))return this.get(this.keyList[n],e)}}forEach(t,e=this){for(let n of this.indexes()){let i=this.valList[n],r=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;void 0!==r&&t.call(e,r,this.keyList[n],this)}}rforEach(t,e=this){for(let n of this.rindexes()){let i=this.valList[n],r=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;void 0!==r&&t.call(e,r,this.keyList[n],this)}}get prune(){return iu("prune","purgeStale"),this.purgeStale}purgeStale(){let t=!1;for(let e of this.rindexes({allowStale:!0}))this.isStale(e)&&(this.delete(this.keyList[e]),t=!0);return t}dump(){let t=[];for(let e of this.indexes({allowStale:!0})){let n=this.keyList[e],i=this.valList[e],r=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(void 0===r)continue;let o={value:r};if(this.ttls){o.ttl=this.ttls[e];let t=it.now()-this.starts[e];o.start=Math.floor(Date.now()-t)}this.sizes&&(o.size=this.sizes[e]),t.unshift([n,o])}return t}load(t){for(let[e,n]of(this.clear(),t)){if(n.start){let t=Date.now()-n.start;n.start=it.now()-t}this.set(e,n.value,n)}}dispose(t,e,n){}set(t,e,{ttl:n=this.ttl,start:i,noDisposeOnSet:r=this.noDisposeOnSet,size:o=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:s=this.noUpdateTTL,status:l}={}){if(o=this.requireSize(t,e,o,a),this.maxEntrySize&&o>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),this.delete(t),this;let u=0===this.size?void 0:this.keyMap.get(t);if(void 0===u)u=this.newIndex(),this.keyList[u]=t,this.valList[u]=e,this.keyMap.set(t,u),this.next[this.tail]=u,this.prev[u]=this.tail,this.tail=u,this.size++,this.addItemSize(u,o,l),l&&(l.set="add"),s=!1;else{this.moveToTail(u);let n=this.valList[u];if(e!==n){if(this.isBackgroundFetch(n)?n.__abortController.abort(Error("replaced")):!r&&(this.dispose(n,t,"set"),this.disposeAfter&&this.disposed.push([n,t,"set"])),this.removeItemSize(u),this.valList[u]=e,this.addItemSize(u,o,l),l){l.set="replace";let t=n&&this.isBackgroundFetch(n)?n.__staleWhileFetching:n;void 0!==t&&(l.oldValue=t)}}else l&&(l.set="update")}if(0===n||0!==this.ttl||this.ttls||this.initializeTTLTracking(),s||this.setItemTTL(u,n,i),this.statusTTL(l,u),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){let t=this.valList[this.head];return this.evict(!0),t}}evict(t){let e=this.head,n=this.keyList[e],i=this.valList[e];return this.isBackgroundFetch(i)?i.__abortController.abort(Error("evicted")):(this.dispose(i,n,"evict"),this.disposeAfter&&this.disposed.push([i,n,"evict"])),this.removeItemSize(e),t&&(this.keyList[e]=null,this.valList[e]=null,this.free.push(e)),this.head=this.next[e],this.keyMap.delete(n),this.size--,e}has(t,{updateAgeOnHas:e=this.updateAgeOnHas,status:n}={}){let i=this.keyMap.get(t);if(void 0!==i){if(!this.isStale(i))return e&&this.updateItemAge(i),n&&(n.has="hit"),this.statusTTL(n,i),!0;n&&(n.has="stale",this.statusTTL(n,i))}else n&&(n.has="miss");return!1}peek(t,{allowStale:e=this.allowStale}={}){let n=this.keyMap.get(t);if(void 0!==n&&(e||!this.isStale(n))){let t=this.valList[n];return this.isBackgroundFetch(t)?t.__staleWhileFetching:t}}backgroundFetch(t,e,n,i){let r=void 0===e?void 0:this.valList[e];if(this.isBackgroundFetch(r))return r;let o=new ii;n.signal&&n.signal.addEventListener("abort",()=>o.abort(n.signal.reason));let a={signal:o.signal,options:n,context:i},s=(i,r=!1)=>{let{aborted:s}=o.signal,l=n.ignoreFetchAbort&&void 0!==i;return(n.status&&(s&&!r?(n.status.fetchAborted=!0,n.status.fetchError=o.signal.reason,l&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),!s||l||r)?(this.valList[e]===h&&(void 0===i?h.__staleWhileFetching?this.valList[e]=h.__staleWhileFetching:this.delete(t):(n.status&&(n.status.fetchUpdated=!0),this.set(t,i,a.options))),i):u(o.signal.reason)},l=t=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=t),u(t)),u=i=>{let{aborted:r}=o.signal,a=r&&n.allowStaleOnFetchAbort,s=a||n.allowStaleOnFetchRejection,l=s||n.noDeleteOnFetchRejection;if(this.valList[e]===h){let n=!l||void 0===h.__staleWhileFetching;n?this.delete(t):a||(this.valList[e]=h.__staleWhileFetching)}if(s)return n.status&&void 0!==h.__staleWhileFetching&&(n.status.returnedStale=!0),h.__staleWhileFetching;if(h.__returned===h)throw i},c=(e,i)=>{this.fetchMethod(t,r,a).then(t=>e(t),i),o.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(e(),n.allowStaleOnFetchAbort&&(e=t=>s(t,!0)))})};n.status&&(n.status.fetchDispatched=!0);let h=new Promise(c).then(s,l);return h.__abortController=o,h.__staleWhileFetching=r,h.__returned=null,void 0===e?(this.set(t,h,{...a.options,status:void 0}),e=this.keyMap.get(t)):this.valList[e]=h,h}isBackgroundFetch(t){return t&&"object"==typeof t&&"function"==typeof t.then&&Object.prototype.hasOwnProperty.call(t,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(t,"__returned")&&(t.__returned===t||null===t.__returned)}async fetch(t,{allowStale:e=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:r=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:a=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:f=this.allowStaleOnFetchAbort,fetchContext:d=this.fetchContext,forceRefresh:v=!1,status:g,signal:p}={}){if(!this.fetchMethod)return g&&(g.fetch="get"),this.get(t,{allowStale:e,updateAgeOnGet:n,noDeleteOnStaleGet:i,status:g});let y={allowStale:e,updateAgeOnGet:n,noDeleteOnStaleGet:i,ttl:r,noDisposeOnSet:o,size:a,sizeCalculation:s,noUpdateTTL:l,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:f,ignoreFetchAbort:h,status:g,signal:p},_=this.keyMap.get(t);if(void 0===_){g&&(g.fetch="miss");let e=this.backgroundFetch(t,_,y,d);return e.__returned=e}{let i=this.valList[_];if(this.isBackgroundFetch(i)){let t=e&&void 0!==i.__staleWhileFetching;return g&&(g.fetch="inflight",t&&(g.returnedStale=!0)),t?i.__staleWhileFetching:i.__returned=i}let r=this.isStale(_);if(!v&&!r)return g&&(g.fetch="hit"),this.moveToTail(_),n&&this.updateItemAge(_),this.statusTTL(g,_),i;let o=this.backgroundFetch(t,_,y,d),a=void 0!==o.__staleWhileFetching,s=a&&e;return g&&(g.fetch=a&&r?"stale":"refresh",s&&r&&(g.returnedStale=!0)),s?o.__staleWhileFetching:o.__returned=o}}get(t,{allowStale:e=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:r}={}){let o=this.keyMap.get(t);if(void 0!==o){let a=this.valList[o],s=this.isBackgroundFetch(a);return(this.statusTTL(r,o),this.isStale(o))?(r&&(r.get="stale"),s)?(r&&(r.returnedStale=e&&void 0!==a.__staleWhileFetching),e?a.__staleWhileFetching:void 0):(i||this.delete(t),r&&(r.returnedStale=e),e?a:void 0):(r&&(r.get="hit"),s)?a.__staleWhileFetching:(this.moveToTail(o),n&&this.updateItemAge(o),a)}r&&(r.get="miss")}connect(t,e){this.prev[e]=t,this.next[t]=e}moveToTail(t){t!==this.tail&&(t===this.head?this.head=this.next[t]:this.connect(this.prev[t],this.next[t]),this.connect(this.tail,t),this.tail=t)}get del(){return iu("del","delete"),this.delete}delete(t){let e=!1;if(0!==this.size){let n=this.keyMap.get(t);if(void 0!==n){if(e=!0,1===this.size)this.clear();else{this.removeItemSize(n);let e=this.valList[n];this.isBackgroundFetch(e)?e.__abortController.abort(Error("deleted")):(this.dispose(e,t,"delete"),this.disposeAfter&&this.disposed.push([e,t,"delete"])),this.keyMap.delete(t),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return e}clear(){for(let t of this.rindexes({allowStale:!0})){let e=this.valList[t];if(this.isBackgroundFetch(e))e.__abortController.abort(Error("deleted"));else{let n=this.keyList[t];this.dispose(e,n,"delete"),this.disposeAfter&&this.disposed.push([e,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return iu("reset","clear"),this.clear}get length(){return ic("length","size"),this.size}static get AbortController(){return ii}static get AbortSignal(){return ia}}var ix=function(){function t(e){(0,u.Z)(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=nv(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}return(0,c.Z)(t,[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"getAnchor",value:function(){return(0,A.O3)()}},{key:"getImage",value:function(t){return(0,A.O3)()}},{key:"getHitDetectionImage",value:function(){return(0,A.O3)()}},{key:"getPixelRatio",value:function(t){return 1}},{key:"getImageState",value:function(){return(0,A.O3)()}},{key:"getImageSize",value:function(){return(0,A.O3)()}},{key:"getOrigin",value:function(){return(0,A.O3)()}},{key:"getSize",value:function(){return(0,A.O3)()}},{key:"setDisplacement",value:function(t){this.displacement_=t}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=nv(t)}},{key:"listenImageChange",value:function(t){(0,A.O3)()}},{key:"load",value:function(){(0,A.O3)()}},{key:"unlistenImageChange",value:function(t){(0,A.O3)()}}]),t}();function iR(t){return Array.isArray(t)?W(t):t}var iE=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=void 0!==t.rotateWithView&&t.rotateWithView;return(e=n.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})).canvas_=void 0,e.hitDetectionCanvas_=null,e.fill_=void 0!==t.fill?t.fill:null,e.origin_=[0,0],e.points_=t.points,e.radius_=void 0!==t.radius?t.radius:t.radius1,e.radius2_=t.radius2,e.angle_=void 0!==t.angle?t.angle:0,e.stroke_=void 0!==t.stroke?t.stroke:null,e.size_=null,e.renderOptions_=null,e.render(),e}return(0,c.Z)(i,[{key:"clone",value:function(){var t=this.getScale(),e=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},{key:"getAnchor",value:function(){var t=this.size_;if(!t)return null;var e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t,this.render()}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}},{key:"getImage",value:function(t){var e=this.canvas_[t];if(!e){var n=this.renderOptions_,i=tg(n.size*t,n.size*t);this.draw_(n,i,t),e=i.canvas,this.canvas_[t]=e}return e}},{key:"getPixelRatio",value:function(t){return t}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return nR.LOADED}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius_}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t,this.render()}},{key:"listenImageChange",value:function(t){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(t){}},{key:"calculateLineJoinSize_",value:function(t,e,n){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;var i=this.radius_,r=void 0===this.radius2_?i:this.radius2_;if(i<r){var o=i;i=r,r=o}var a=2*Math.PI/(void 0===this.radius2_?this.points_:2*this.points_),s=r*Math.sin(a),l=i-Math.sqrt(r*r-s*s),u=Math.sqrt(s*s+l*l),c=u/s;if("miter"===t&&c<=n)return c*e;var h=e/2/c,f=e/2*(l/u),d=Math.sqrt((i+h)*(i+h)+f*f)-i;if(void 0===this.radius2_||"bevel"===t)return 2*d;var v=i*Math.sin(a),g=r-Math.sqrt(i*i-v*v),p=Math.sqrt(v*v+g*g)/v;return p<=n?2*Math.max(d,p*e/2-r-i):2*d}},{key:"createRenderOptions",value:function(){var t,e=tT,n=0,i=null,r=0,o=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=tC),t=iR(t),void 0===(o=this.stroke_.getWidth())&&(o=1),i=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=tT),void 0===(n=this.stroke_.getMiterLimit())&&(n=10));var a=this.calculateLineJoinSize_(e,o,n);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*Math.max(this.radius_,this.radius2_||0)+a),lineDash:i,lineDashOffset:r,lineJoin:e,miterLimit:n}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]}},{key:"draw_",value:function(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){var i=this.fill_.getColor();null===i&&(i=tR),e.fillStyle=iR(i),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}},{key:"createHitDetectionCanvas_",value:function(t){if(this.fill_){var e=this.fill_.getColor(),n=0;if("string"==typeof e&&(e=X(e)),null===e?n=1:Array.isArray(e)&&(n=4===e.length?e[3]:1),0===n){var i=tg(t.size,t.size);this.hitDetectionCanvas_=i.canvas,this.drawHitDetectionCanvas_(t,i)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}},{key:"createPath_",value:function(t){var e=this.points_,n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{var i=void 0===this.radius2_?n:this.radius2_;void 0!==this.radius2_&&(e*=2);for(var r=this.angle_-Math.PI/2,o=2*Math.PI/e,a=0;a<e;a++){var s=r+a*o,l=a%2==0?n:i;t.lineTo(l*Math.cos(s),l*Math.sin(s))}t.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=tR,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}]),i}(ix),ik=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){return(0,u.Z)(this,i),t=t||{radius:5},n.call(this,{points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}return(0,c.Z)(i,[{key:"clone",value:function(){var t=this.getScale(),e=new i({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},{key:"setRadius",value:function(t){this.radius_=t,this.render()}}]),i}(iE),iT=function(){function t(e){(0,u.Z)(this,t),e=e||{},this.color_=void 0!==e.color?e.color:null}return(0,c.Z)(t,[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(t){this.color_=t}}]),t}(),iC=function(){function t(e){(0,u.Z)(this,t),e=e||{},this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return(0,c.Z)(t,[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(t){this.color_=t}},{key:"setLineCap",value:function(t){this.lineCap_=t}},{key:"setLineDash",value:function(t){this.lineDash_=t}},{key:"setLineDashOffset",value:function(t){this.lineDashOffset_=t}},{key:"setLineJoin",value:function(t){this.lineJoin_=t}},{key:"setMiterLimit",value:function(t){this.miterLimit_=t}},{key:"setWidth",value:function(t){this.width_=t}}]),t}(),iS=function(){function t(e){(0,u.Z)(this,t),e=e||{},this.geometry_=null,this.geometryFunction_=iI,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return(0,c.Z)(t,[{key:"clone",value:function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(t){this.renderer_=t}},{key:"setHitDetectionRenderer",value:function(t){this.hitDetectionRenderer_=t}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(t){this.text_=t}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=iI,this.geometry_=t}},{key:"setZIndex",value:function(t){this.zIndex_=t}}]),t}(),iw=null;function iP(t,e){if(!iw){var n=new iT({color:"rgba(255,255,255,0.4)"}),i=new iC({color:"#3399CC",width:1.25});iw=[new iS({image:new ik({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return iw}function iZ(){var t={},e=[255,255,255,1],n=[0,153,255,1];return t.Polygon=[new iS({fill:new iT({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new iS({stroke:new iC({color:e,width:5})}),new iS({stroke:new iC({color:n,width:3})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new iS({image:new ik({radius:6,fill:new iT({color:n}),stroke:new iC({color:e,width:1.5})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function iI(t){return t.getGeometry()}var ib=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),(r=n.call(this,t,e)).style=function(t,e){if(r.ol!==r.style)return r.ol;if(r.cache){n=r.props.cacheId(t,e);var n,i=r.cache.get(n);if(i)return i}var o=new iS({zIndex:r.props.zIndex}),a=v.createElement(g.Provider,{value:Object.assign(Object.assign({},r.context),{style:o})},r.props.render(t,e));return n7.render(a,document.createElement("div")),r.cache&&r.cache.set(n,o),o},t.render?r.ol=r.style:r.ol=new iS({zIndex:t.zIndex}),t.render&&t.cacheSize&&t.cacheId&&(r.cache=new im({max:t.cacheSize})),r}return(0,c.Z)(i,[{key:"componentDidMount",value:function(){R((0,d.Z)(i.prototype),"componentDidMount",this).call(this),this.refresh()}},{key:"refresh",value:function(t){var e,n,r,o,a,s,l;if(R((0,d.Z)(i.prototype),"refresh",this).call(this,t),!t||(null==t?void 0:t.render)!==this.props.render){if(null===(e=this.context)||void 0===e?void 0:e.styleArray){if(this.ol===this.style)throw Error("An RStyleArray must contain only static RStyles");this.context.styleArray.includes(this.ol)||this.context.styleArray.push(this.ol)}else(null===(r=null===(n=this.context)||void 0===n?void 0:n.feature)||void 0===r?void 0:r.setStyle)?this.context.feature.setStyle(this.ol):(null===(a=null===(o=this.context)||void 0===o?void 0:o.vectorlayer)||void 0===a?void 0:a.setStyle)?this.context.vectorlayer.setStyle(this.ol):(null===(l=null===(s=this.context)||void 0===s?void 0:s.vectortilelayer)||void 0===l?void 0:l.setStyle)&&this.context.vectortilelayer.setStyle(this.ol);this.cache&&this.cache.clear()}this.ol instanceof iS&&(!t||t.zIndex!==this.props.zIndex)&&this.ol.setZIndex(this.props.zIndex)}},{key:"render",value:function(){return this.props.render?null:v.createElement("div",{className:"_rlayers_RStyle"},v.createElement(g.Provider,{value:Object.assign(Object.assign({},this.context),{style:this.ol})},this.props.children))}}],[{key:"getStyle",value:function(t){return null==t?t:"function"==typeof t.style?function(e,n){return t.style(e,n)}:Object.keys(t).includes("current")?function(e,n){return t.current.style(e,n)}:t}},{key:"getStyleStatic",value:function(t){var e;if(null==t)return t;if("function"==typeof t.style&&(e=t),!Object.keys(t).includes("current")||null!=(e=t.current)){if(e){if(void 0!==e.ol&&"function"!=typeof e.ol)return e.ol;throw TypeError("RStyle is dynamic and cannot be converted to Style")}if("function"==typeof t)throw TypeError("StyleLike is dynamic and cannot be converted to Style");return t}}}]),i}(x);function iO(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return iA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iA(t,e)}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function iA(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function iL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var iM=function(t){(0,h.Z)(n,t);var e=iL(n);function n(){return(0,u.Z)(this,n),e.apply(this,arguments)}return(0,c.Z)(n)}(tX),iD=function(t){(0,h.Z)(n,t);var e=iL(n);function n(t,i){var r,o,a;if((0,u.Z)(this,n),r=e.call(this,t,i),!(null===(o=null===(0,E.Z)(r)||void 0===(0,E.Z)(r)?void 0:r.context)||void 0===o?void 0:o.vectorlayer))throw Error("An RFeature must be part of a vector layer");return t.feature?r.ol=t.feature:r.ol=new n8(Object.assign(Object.assign({},null!==(a=t.properties)&&void 0!==a?a:{}),{geometry:t.geometry,style:ib.getStyle(t.style)})),n.initEventRelay(r.context.map),r.onchange=function(){return r.forceUpdate()},r}return(0,c.Z)(n,[{key:"refresh",value:function(t){R((0,d.Z)(n.prototype),"refresh",this).call(this,t),void 0!==this.props.feature&&this.props.feature!==this.ol&&(y("replacing bound feature",this.ol),this.componentWillUnmount(),this.ol=this.props.feature,this.componentDidMount()),this.props.properties!==(null==t?void 0:t.properties)&&this.ol.setProperties(this.props.properties),this.props.geometry!==(null==t?void 0:t.geometry)&&this.ol.setGeometry(this.props.geometry),this.props.style!==(null==t?void 0:t.style)&&this.ol.setStyle(ib.getStyle(this.props.style))}},{key:"componentDidMount",value:function(){y("didMount",this.ol),R((0,d.Z)(n.prototype),"componentDidMount",this).call(this),this.ol.on("change",this.onchange),this.context.vectorsource.addFeature(this.ol)}},{key:"componentWillUnmount",value:function(){R((0,d.Z)(n.prototype),"componentWillUnmount",this).call(this),this.ol.un("change",this.onchange),this.context.vectorsource.removeFeature(this.ol)}},{key:"render",value:function(){var t,e,n=null===(e=null===(t=this.ol)||void 0===t?void 0:t.getGeometry())||void 0===e?void 0:e.getExtent(),i=n&&(0,M.qg)(n);return v.createElement("div",{className:"_rlayers_RFeature"},v.createElement(g.Provider,{value:{map:this.context.map,layer:this.context.vectorlayer,source:this.context.vectorsource,feature:this.ol,location:i}},this.props.children))}}],[{key:"initEventRelay",value:function(t){var e,i=iO(n.pointerEvents);try{for(i.s();!(e=i.n()).done;){var r=e.value;t.on(r,n.eventRelay)}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispatchEvent",value:function(t,e){var n;return!t.feature||(t.feature.dispatchEvent?t.feature.dispatchEvent(e):(e.target||(e.target=t.feature),null===(n=t.layer)||void 0===n||!n.get("_on"+e.type)||t.layer.get("_on"+e.type)(e)))}},{key:"eventRelay",value:function(t){var e=[];if(t.map.forEachFeatureAtPixel(t.pixel,function(t,n){return e.push({feature:t,layer:n})&&!1},{hitTolerance:n.hitTolerance}),t.dragging){n.lastFeaturesDragged.length||(n.lastFeaturesDragged=[].concat(e));var i,r=iO(n.lastFeaturesDragged);try{for(r.s();!(i=r.n()).done;)!function(){var t=i.value;e.find(function(e){return e.feature===t.feature})||e.push(t)}()}catch(t){r.e(t)}finally{r.f()}}else{var o,a=iO(n.lastFeaturesDragged);try{for(a.s();!(o=a.n()).done;){var s=o.value;n.dispatchEvent(s,new iM("pointerdragend",t.map,t.originalEvent))}}catch(t){a.e(t)}finally{a.f()}n.lastFeaturesDragged=[]}if("pointermove"===t.type){var l,u=iO(n.lastFeaturesEntered);try{for(u.s();!(l=u.n()).done;)!function(){var i=l.value;e.find(function(t){return t.feature===i.feature})||(n.dispatchEvent(i,new iM("pointerleave",t.map,t.originalEvent)),i.feature=null,i.layer=null)}()}catch(t){u.e(t)}finally{u.f()}n.lastFeaturesEntered=n.lastFeaturesEntered.filter(function(t){return t.feature});var c,h=iO(e);try{for(h.s();!(c=h.n()).done;)!function(){var e=c.value;n.lastFeaturesEntered.find(function(t){return t.feature===e.feature})||(n.dispatchEvent(e,new iM("pointerenter",t.map,t.originalEvent)),n.lastFeaturesEntered.push(e))}()}catch(t){h.e(t)}finally{h.f()}}for(var f=0;f<e.length;f++){var d=e[f];if(!1===n.dispatchEvent(d,new iM(t.type,t.map,t.originalEvent)))return!1}return!0}}]),n}(x);function iF(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}iD.pointerEvents=["click","pointerdrag","pointermove","singleclick","dblclick"],iD.lastFeaturesEntered=[],iD.lastFeaturesDragged=[],iD.hitTolerance=3;var iN=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),(r=n.call(this,t,e)).newFeature=function(t){t.feature&&r.attachFeatureHandlers([t.feature]),t.features&&r.attachFeatureHandlers(t.features)},r.eventRelay=function(t){return!r.props["on"+i.relayedEvents[t.type]]||!1!==r.props["on"+i.relayedEvents[t.type]].call((0,E.Z)(r),t)},iD.initEventRelay(r.context.map),r.eventSources=r.createSource(t),r.source.on("featuresloadend",r.newFeature),r.source.on("addfeature",r.newFeature),r.attachEventHandlers(),r}return(0,c.Z)(i,[{key:"createSource",value:function(t){throw Error("RLayerBaseVector is an abstract class")}},{key:"attachFeatureHandlers",value:function(t,e){for(var n=0,r=Object.values(i.relayedEvents);n<r.length;n++){var o=r[n];if(this.props["on"+o]!==(e&&e["on"+o])){var a,s=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return iF(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iF(t,e)}}(t))){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(s.s();!(a=s.n()).done;)a.value.on(o.toLowerCase(),this.eventRelay)}catch(t){s.e(t)}finally{s.f()}}}}},{key:"componentWillUnmount",value:function(){var t=this;R((0,d.Z)(i.prototype),"componentWillUnmount",this).call(this);for(var e=0,n=Object.values(i.relayedEvents);e<n.length;e++)!function(){var i=n[e];t.source.forEachFeature(function(e){return e.un(i.toLowerCase(),t.eventRelay),!1})}()}},{key:"refresh",value:function(t){R((0,d.Z)(i.prototype),"refresh",this).call(this,t),this.attachFeatureHandlers(this.source.getFeatures(),t),(null==t?void 0:t.style)!==this.props.style&&this.ol.setStyle(ib.getStyle(this.props.style))}},{key:"render",value:function(){return v.createElement("div",{className:"_rlayers_RLayerVector"},v.createElement(g.Provider,{value:Object.assign(Object.assign({},this.context),{layer:this.ol,source:this.source,vectorlayer:this.ol,vectorsource:this.source})},this.props.children))}}]),i}(n_);iN.relayedEvents={click:"Click",pointermove:"PointerMove",pointerenter:"PointerEnter",pointerleave:"PointerLeave"};var iB=n(2582),iG=n.n(iB),iU=null,iz=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a,s){var l;return(0,u.Z)(this,i),(l=n.call(this)).hitDetectionImage_=null,l.image_=t,l.crossOrigin_=o,l.canvas_={},l.color_=s,l.unlisten_=null,l.imageState_=a,l.size_=r,l.src_=e,l.tainted_,l}return(0,c.Z)(i,[{key:"initializeImage_",value:function(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}},{key:"isTainted_",value:function(){if(void 0===this.tainted_&&this.imageState_===nR.LOADED){iU||(iU=tg(1,1,void 0,{willReadFrequently:!0})),iU.drawImage(this.image_,0,0);try{iU.getImageData(0,0,1,1),this.tainted_=!1}catch(t){iU=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(q.Z.CHANGE)}},{key:"handleImageError_",value:function(){this.imageState_=nR.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=nR.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"getImage",value:function(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}},{key:"getPixelRatio",value:function(t){return this.replaceColor_(t),this.canvas_[t]?t:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_){if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],n=tg(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_}return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){if(this.imageState_===nR.IDLE){this.image_||this.initializeImage_(),this.imageState_=nR.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=nP(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(t){if(this.color_&&!this.canvas_[t]&&this.imageState_===nR.LOADED){var e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);var i=n.getContext("2d");i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=G(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}]),i}(tY.Z),iX=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r,o,a,s,l,c=void 0!==(t=t||{}).opacity?t.opacity:1,h=void 0!==t.rotation?t.rotation:0,f=void 0!==t.scale?t.scale:1,d=void 0!==t.rotateWithView&&t.rotateWithView;(l=n.call(this,{opacity:c,rotation:h,scale:f,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:d,declutterMode:t.declutterMode})).anchor_=void 0!==t.anchor?t.anchor:[.5,.5],l.normalizedAnchor_=null,l.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",l.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",l.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",l.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;var v=void 0!==t.img?t.img:null;l.imgSize_=t.imgSize;var g=t.src;(0,D.h)(!(void 0!==g&&v),4),(0,D.h)(!v||v&&l.imgSize_,5),(void 0===g||0===g.length)&&v&&(g=v.src||(0,A.sq)(v)),(0,D.h)(void 0!==g&&g.length>0,6),(0,D.h)(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),69);var p=void 0!==t.src?nR.IDLE:nR.LOADED;if(l.color_=void 0!==t.color?X(t.color):null,l.iconImage_=(e=g,r=void 0!==l.imgSize_?l.imgSize_:null,o=l.crossOrigin_,a=l.color_,(s=V.get(e,o,a))||(s=new iz(v,e,r,o,p,a),V.set(e,o,a,s)),s),l.offset_=void 0!==t.offset?t.offset:[0,0],l.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",l.origin_=null,l.size_=void 0!==t.size?t.size:null,l.width_=t.width,l.height_=t.height,void 0!==l.width_||void 0!==l.height_){var y=l.getImage(1);y.width>0?l.updateScaleFromWidthAndHeight(l.width_,l.height_):y.addEventListener("load",function(){l.updateScaleFromWidthAndHeight(l.width_,l.height_)})}return l}return(0,c.Z)(i,[{key:"clone",value:function(){var t=this.getScale();return new i({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode(),width:this.width_,height:this.height_})}},{key:"updateScaleFromWidthAndHeight",value:function(t,e){var n=this.getImage(1);void 0!==t&&void 0!==e?R((0,d.Z)(i.prototype),"setScale",this).call(this,[t/n.width,e/n.height]):void 0!==t?R((0,d.Z)(i.prototype),"setScale",this).call(this,[t/n.width,t/n.width]):void 0!==e?R((0,d.Z)(i.prototype),"setScale",this).call(this,[e/n.height,e/n.height]):R((0,d.Z)(i.prototype),"setScale",this).call(this,[1,1])}},{key:"getAnchor",value:function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),("top-right"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(t[0]=-t[0]+e[0]),("bottom-left"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var n=this.getDisplacement(),i=this.getScaleArray();return[t[0]-n[0]/i[0],t[1]+n[1]/i[1]]}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getPixelRatio",value:function(t){return this.iconImage_.getPixelRatio(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_;if("top-left"!=this.offsetOrigin_){var e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),("top-right"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(t[0]=n[0]-e[0]-t[0]),("bottom-left"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"getWidth",value:function(){return this.width_}},{key:"getHeight",value:function(){return this.height_}},{key:"setWidth",value:function(t){this.width_=t,this.updateScaleFromWidthAndHeight(t,this.height_)}},{key:"setHeight",value:function(t){this.height_=t,this.updateScaleFromWidthAndHeight(this.width_,t)}},{key:"setScale",value:function(t){R((0,d.Z)(i.prototype),"setScale",this).call(this,t);var e=this.getImage(1);if(e){var n=Array.isArray(t)?t[0]:t;void 0!==n&&(this.width_=n*e.width);var r=Array.isArray(t)?t[1]:t;void 0!==r&&(this.height_=r*e.height)}}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(q.Z.CHANGE,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(q.Z.CHANGE,t)}}]),i}(ix),ij=function(){function t(e){(0,u.Z)(this,t),e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=nv(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new iT({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return(0,c.Z)(t,[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"setOverflow",value:function(t){this.overflow_=t}},{key:"setFont",value:function(t){this.font_=t}},{key:"setMaxAngle",value:function(t){this.maxAngle_=t}},{key:"setOffsetX",value:function(t){this.offsetX_=t}},{key:"setOffsetY",value:function(t){this.offsetY_=t}},{key:"setPlacement",value:function(t){this.placement_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setFill",value:function(t){this.fill_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=nv(void 0!==t?t:1)}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"setText",value:function(t){this.text_=t}},{key:"setTextAlign",value:function(t){this.textAlign_=t}},{key:"setJustify",value:function(t){this.justify_=t}},{key:"setTextBaseline",value:function(t){this.textBaseline_=t}},{key:"setBackgroundFill",value:function(t){this.backgroundFill_=t}},{key:"setBackgroundStroke",value:function(t){this.backgroundStroke_=t}},{key:"setPadding",value:function(t){this.padding_=t}}]),t}();function iW(t){return new iS({fill:iY(t,""),stroke:iV(t,""),text:function(t){var e=t["text-value"];if(e)return new ij({text:e,font:t["text-font"],maxAngle:t["text-max-angle"],offsetX:t["text-offset-x"],offsetY:t["text-offset-y"],overflow:t["text-overflow"],placement:t["text-placement"],scale:t["text-scale"],rotateWithView:t["text-rotate-with-view"],rotation:t["text-rotation"],textAlign:t["text-align"],justify:t["text-justify"],textBaseline:t["text-baseline"],padding:t["text-padding"],fill:iY(t,"text-"),backgroundFill:iY(t,"text-background-"),stroke:iV(t,"text-"),backgroundStroke:iV(t,"text-background-")})}(t),image:function(t){var e=t["icon-src"],n=t["icon-img"];if(e||n)return new iX({src:e,img:n,imgSize:t["icon-img-size"],anchor:t["icon-anchor"],anchorOrigin:t["icon-anchor-origin"],anchorXUnits:t["icon-anchor-x-units"],anchorYUnits:t["icon-anchor-y-units"],color:t["icon-color"],crossOrigin:t["icon-cross-origin"],offset:t["icon-offset"],displacement:t["icon-displacement"],opacity:t["icon-opacity"],scale:t["icon-scale"],rotation:t["icon-rotation"],rotateWithView:t["icon-rotate-with-view"],size:t["icon-size"],declutterMode:t["icon-declutter-mode"]});var i=t["shape-points"];if(i){var r="shape-";return new iE({points:i,fill:iY(t,r),stroke:iV(t,r),radius:t["shape-radius"],radius1:t["shape-radius1"],radius2:t["shape-radius2"],angle:t["shape-angle"],displacement:t["shape-displacement"],rotation:t["shape-rotation"],rotateWithView:t["shape-rotate-with-view"],scale:t["shape-scale"],declutterMode:t["shape-declutter-mode"]})}var o=t["circle-radius"];if(o){var a="circle-";return new ik({radius:o,fill:iY(t,a),stroke:iV(t,a),displacement:t["circle-displacement"],scale:t["circle-scale"],rotation:t["circle-rotation"],rotateWithView:t["circle-rotate-with-view"],declutterMode:t["circle-declutter-mode"]})}}(t)})}function iY(t,e){var n=t[e+"fill-color"];if(n)return new iT({color:n})}function iV(t,e){var n=t[e+"stroke-width"],i=t[e+"stroke-color"];if(n||i)return new iC({width:n,color:i,lineCap:t[e+"stroke-line-cap"],lineJoin:t[e+"stroke-line-join"],lineDash:t[e+"stroke-line-dash"],lineDashOffset:t[e+"stroke-line-dash-offset"],miterLimit:t[e+"stroke-miter-limit"]})}var iH={RENDER_ORDER:"renderOrder"},iK=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=Object.assign({},t=t||{});return delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,(e=n.call(this,r)).declutter_=void 0!==t.declutter&&t.declutter,e.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,e.style_=null,e.styleFunction_=void 0,e.setStyle(t.style),e.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,e.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting,e}return(0,c.Z)(i,[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(t){return R((0,d.Z)(i.prototype),"getFeatures",this).call(this,t)}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(iH.RENDER_ORDER)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(t){t.declutterTree||(t.declutterTree=new(iG())(9)),this.getRenderer().renderDeclutter(t)}},{key:"setRenderOrder",value:function(t){this.set(iH.RENDER_ORDER,t)}},{key:"setStyle",value:function(t){var e;if(void 0===t)e=iP;else if(null===t)e=null;else if("function"==typeof t)e=t;else if(t instanceof iS)e=t;else if(Array.isArray(t)){for(var n=t.length,i=Array(n),r=0;r<n;++r){var o=t[r];o instanceof iS?i[r]=o:i[r]=iW(o)}e=i}else e=iW(t);this.style_=e,this.styleFunction_=null===t?void 0:function(t){if("function"==typeof t)e=t;else{if(Array.isArray(t))n=t;else{var e,n;(0,D.h)("function"==typeof t.getZIndex,41),n=[t]}e=function(){return n}}return e}(this.style_),this.changed()}}]),i}(Q),iq={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},iJ=[iq.FILL],i$=[iq.STROKE],iQ=[iq.BEGIN_PATH],i0=[iq.CLOSE_PATH],i1=n(2568),i2=function(){function t(){(0,u.Z)(this,t)}return(0,c.Z)(t,[{key:"drawCustom",value:function(t,e,n,i){}},{key:"drawGeometry",value:function(t){}},{key:"setStyle",value:function(t){}},{key:"drawCircle",value:function(t,e){}},{key:"drawFeature",value:function(t,e){}},{key:"drawGeometryCollection",value:function(t,e){}},{key:"drawLineString",value:function(t,e){}},{key:"drawMultiLineString",value:function(t,e){}},{key:"drawMultiPoint",value:function(t,e){}},{key:"drawMultiPolygon",value:function(t,e){}},{key:"drawPoint",value:function(t,e){}},{key:"drawPolygon",value:function(t,e){}},{key:"drawText",value:function(t,e){}},{key:"setFillStrokeStyle",value:function(t,e){}},{key:"setImageStyle",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}}]),t}(),i3=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){var a;return(0,u.Z)(this,i),(a=n.call(this)).tolerance=t,a.maxExtent=e,a.pixelRatio=o,a.maxLineWidth=0,a.resolution=r,a.beginGeometryInstruction1_=null,a.beginGeometryInstruction2_=null,a.bufferedMaxExtent_=null,a.instructions=[],a.coordinates=[],a.tmpCoordinate_=[],a.hitDetectionInstructions=[],a.state={},a}return(0,c.Z)(i,[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}},{key:"appendFlatPointCoordinates",value:function(t,e){for(var n=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,r=this.coordinates,o=r.length,a=0,s=t.length;a<s;a+=e)i[0]=t[a],i[1]=t[a+1],(0,M.b8)(n,i)&&(r[o++]=i[0],r[o++]=i[1]);return o}},{key:"appendFlatLineCoordinates",value:function(t,e,n,i,r,o){var a,s,l,u=this.coordinates,c=u.length,h=this.getBufferedMaxExtent();o&&(e+=i);var f=t[e],d=t[e+1],v=this.tmpCoordinate_,g=!0;for(a=e+i;a<n;a+=i)v[0]=t[a],v[1]=t[a+1],(l=(0,M.pX)(h,v))!==s?(g&&(u[c++]=f,u[c++]=d,g=!1),u[c++]=v[0],u[c++]=v[1]):l===i1.Z.INTERSECTING?(u[c++]=v[0],u[c++]=v[1],g=!1):g=!0,f=v[0],d=v[1],s=l;return(r&&g||a===e+i)&&(u[c++]=f,u[c++]=d),c}},{key:"drawCustomCoordinates_",value:function(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o],l=this.appendFlatLineCoordinates(t,e,s,i,!1,!1);r.push(l),e=s}return e}},{key:"drawCustom",value:function(t,e,n,i){this.beginGeometry(t,e);var r,o,a,s,l,u=t.getType(),c=t.getStride(),h=this.coordinates.length;switch(u){case"MultiPolygon":r=t.getOrientedFlatCoordinates(),s=[];var f=t.getEndss();l=0;for(var d=0,v=f.length;d<v;++d){var g=[];l=this.drawCustomCoordinates_(r,l,f[d],c,g),s.push(g)}this.instructions.push([iq.CUSTOM,h,s,t,n,ey]),this.hitDetectionInstructions.push([iq.CUSTOM,h,s,t,i||n,ey]);break;case"Polygon":case"MultiLineString":a=[],r="Polygon"==u?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),l=this.drawCustomCoordinates_(r,0,t.getEnds(),c,a),this.instructions.push([iq.CUSTOM,h,a,t,n,ep]),this.hitDetectionInstructions.push([iq.CUSTOM,h,a,t,i||n,ep]);break;case"LineString":case"Circle":r=t.getFlatCoordinates(),o=this.appendFlatLineCoordinates(r,0,r.length,c,!1,!1),this.instructions.push([iq.CUSTOM,h,o,t,n,eg]),this.hitDetectionInstructions.push([iq.CUSTOM,h,o,t,i||n,eg]);break;case"MultiPoint":r=t.getFlatCoordinates(),(o=this.appendFlatPointCoordinates(r,c))>h&&(this.instructions.push([iq.CUSTOM,h,o,t,n,eg]),this.hitDetectionInstructions.push([iq.CUSTOM,h,o,t,i||n,eg]));break;case"Point":r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),o=this.coordinates.length,this.instructions.push([iq.CUSTOM,h,o,t,n]),this.hitDetectionInstructions.push([iq.CUSTOM,h,o,t,i||n])}this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e){this.beginGeometryInstruction1_=[iq.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[iq.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e,n,i=this.hitDetectionInstructions;i.reverse();var r=i.length,o=-1;for(t=0;t<r;++t)(n=(e=i[t])[0])==iq.END_GEOMETRY?o=t:n==iq.BEGIN_GEOMETRY&&(e[2]=t,(0,t4.FZ)(this.hitDetectionInstructions,o,t),o=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var n=this.state;if(t){var i=t.getColor();n.fillStyle=iR(i||tR)}else n.fillStyle=void 0;if(e){var r=e.getColor();n.strokeStyle=iR(r||tC);var o=e.getLineCap();n.lineCap=void 0!==o?o:tE;var a=e.getLineDash();n.lineDash=a?a.slice():tk;var s=e.getLineDashOffset();n.lineDashOffset=s||0;var l=e.getLineJoin();n.lineJoin=void 0!==l?l:tT;var u=e.getWidth();n.lineWidth=void 0!==u?u:1;var c=e.getMiterLimit();n.miterLimit=void 0!==c?c:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,n=[iq.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(!0),n}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[iq.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var n=t.fillStyle;("string"!=typeof n||t.currentFillStyle!=n)&&(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}},{key:"updateStrokeStyle",value:function(t,e){var n=t.strokeStyle,i=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,s=t.lineWidth,l=t.miterLimit;t.currentStrokeStyle==n&&t.currentLineCap==i&&(r==t.currentLineDash||(0,t4.fS)(t.currentLineDash,r))&&t.currentLineDashOffset==o&&t.currentLineJoin==a&&t.currentLineWidth==s&&t.currentMiterLimit==l||(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=i,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=s,t.currentMiterLimit=l)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[iq.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,M.d9)(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;(0,M.f3)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}]),i}(i2),i5=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){var a;return(0,u.Z)(this,i),(a=n.call(this,t,e,r,o)).hitDetectionImage_=null,a.image_=null,a.imagePixelRatio_=void 0,a.anchorX_=void 0,a.anchorY_=void 0,a.height_=void 0,a.opacity_=void 0,a.originX_=void 0,a.originY_=void 0,a.rotateWithView_=void 0,a.rotation_=void 0,a.scale_=void 0,a.width_=void 0,a.declutterMode_=void 0,a.declutterImageWithText_=void 0,a}return(0,c.Z)(i,[{key:"drawPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(n,i);this.instructions.push([iq.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([iq.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(n,i);this.instructions.push([iq.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([iq.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,R((0,d.Z)(i.prototype),"finish",this).call(this)}},{key:"setImageStyle",value:function(t,e){var n=t.getAnchor(),i=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=i[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}]),i}(i3),i4=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){return(0,u.Z)(this,i),n.call(this,t,e,r,o)}return(0,c.Z)(i,[{key:"drawFlatCoordinates_",value:function(t,e,n,i){var r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,i,!1,!1),a=[iq.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}},{key:"drawLineString",value:function(t,e){var n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0!==i&&void 0!==r){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([iq.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,tk,0],iQ);var o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(i$),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e){var n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0!==i&&void 0!==r){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([iq.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],iQ);for(var o=t.getEnds(),a=t.getFlatCoordinates(),s=t.getStride(),l=0,u=0,c=o.length;u<c;++u)l=this.drawFlatCoordinates_(a,l,o[u],s);this.hitDetectionInstructions.push(i$),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(i$),this.reverseHitDetectionInstructions(),this.state=null,R((0,d.Z)(i.prototype),"finish",this).call(this)}},{key:"applyStroke",value:function(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(i$),t.lastStroke=this.coordinates.length),t.lastStroke=0,R((0,d.Z)(i.prototype),"applyStroke",this).call(this,t),this.instructions.push(iQ)}}]),i}(i3),i6=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){return(0,u.Z)(this,i),n.call(this,t,e,r,o)}return(0,c.Z)(i,[{key:"drawFlatCoordinatess_",value:function(t,e,n,i){var r=this.state,o=void 0!==r.fillStyle,a=void 0!==r.strokeStyle,s=n.length;this.instructions.push(iQ),this.hitDetectionInstructions.push(iQ);for(var l=0;l<s;++l){var u=n[l],c=this.coordinates.length,h=this.appendFlatLineCoordinates(t,e,u,i,!0,!a),f=[iq.MOVE_TO_LINE_TO,c,h];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(i0),this.hitDetectionInstructions.push(i0)),e=u}return o&&(this.instructions.push(iJ),this.hitDetectionInstructions.push(iJ)),a&&(this.instructions.push(i$),this.hitDetectionInstructions.push(i$)),e}},{key:"drawCircle",value:function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([iq.SET_FILL_STYLE,tR]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([iq.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);var l=[iq.CIRCLE,s];this.instructions.push(iQ,l),this.hitDetectionInstructions.push(iQ,l),void 0!==n.fillStyle&&(this.instructions.push(iJ),this.hitDetectionInstructions.push(iJ)),void 0!==n.strokeStyle&&(this.instructions.push(i$),this.hitDetectionInstructions.push(i$)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([iq.SET_FILL_STYLE,tR]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([iq.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getEnds(),a=t.getOrientedFlatCoordinates(),s=t.getStride();this.drawFlatCoordinatess_(a,0,o,s),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([iq.SET_FILL_STYLE,tR]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([iq.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);for(var o=t.getEndss(),a=t.getOrientedFlatCoordinates(),s=t.getStride(),l=0,u=0,c=o.length;u<c;++u)l=this.drawFlatCoordinatess_(a,l,o[u],s);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,n=0,r=e.length;n<r;++n)e[n]=ed(e[n],t);return R((0,d.Z)(i.prototype),"finish",this).call(this)}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}]),i}(i3),i8={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},i7=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o){var a;return(0,u.Z)(this,i),(a=n.call(this,t,e,r,o)).labels_=null,a.text_="",a.textOffsetX_=0,a.textOffsetY_=0,a.textRotateWithView_=void 0,a.textRotation_=0,a.textFillState_=null,a.fillStates={},a.textStrokeState_=null,a.strokeStates={},a.textState_={},a.textStates={},a.textKey_="",a.fillKey_="",a.strokeKey_="",a.declutterImageWithText_=void 0,a}return(0,c.Z)(i,[{key:"finish",value:function(){var t=R((0,d.Z)(i.prototype),"finish",this).call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}},{key:"drawText",value:function(t,e){var n=this.textFillState_,i=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(n||i)){var o=this.coordinates,a=o.length,s=t.getType(),l=null,u=t.getStride();if("line"===r.placement&&("LineString"==s||"MultiLineString"==s||"Polygon"==s||"MultiPolygon"==s)){if(!(0,M.kK)(this.getBufferedMaxExtent(),t.getExtent()))return;if(l=t.getFlatCoordinates(),"LineString"==s)c=[l.length];else if("MultiLineString"==s)c=t.getEnds();else if("Polygon"==s)c=t.getEnds().slice(0,1);else if("MultiPolygon"==s){var c,h,f=t.getEndss();c=[];for(var d=0,v=f.length;d<v;++d)c.push(f[d][0])}this.beginGeometry(t,e);for(var g=r.textAlign,p=0,y=0,_=c.length;y<_;++y){if(void 0==g){var m=function(t,e,n,i,r){var o,a,s,l,u,c,h,f,d,v=n,g=n,p=0,y=0,_=n;for(o=n;o<i;o+=r){var m=e[o],x=e[o+1];void 0!==l&&(s=Math.sqrt((f=m-l)*f+(d=x-u)*d),void 0!==c&&(y+=a,Math.acos((c*f+h*d)/(a*s))>t&&(y>p&&(p=y,v=_,g=o),y=0,_=o-r)),a=s,c=f,h=d),l=m,u=x}return(y+=s)>p?[_,o]:[v,g]}(r.maxAngle,l,p,c[y],u);p=m[0],h=m[1]}else h=c[y];for(var x=p;x<h;x+=u)o.push(l[x],l[x+1]);var R=o.length;p=c[y],this.drawChars_(a,R),a=R}this.endGeometry(e)}else{var E=r.overflow?null:[];switch(s){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),u=2;break;case"Polygon":l=t.getFlatInteriorPoint(),r.overflow||E.push(l[2]/this.resolution),u=3;break;case"MultiPolygon":var k=t.getFlatInteriorPoints();l=[];for(var T=0,C=k.length;T<C;T+=3)r.overflow||E.push(k[T+2]/this.resolution),l.push(k[T],k[T+1]);if(0===l.length)return;u=2}var S=this.appendFlatPointCoordinates(l,u);if(S===a)return;if(E&&(S-a)/2!=l.length/u){var w=a/2;E=E.filter(function(t,e){var n=o[(w+e)*2]===l[e*u]&&o[(w+e)*2+1]===l[e*u+1];return!n&&--w,n})}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var P=r.padding;if(P!=tP&&(r.scale[0]<0||r.scale[1]<0)){var Z=r.padding[0],I=r.padding[1],b=r.padding[2],O=r.padding[3];r.scale[0]<0&&(I=-I,O=-O),r.scale[1]<0&&(Z=-Z,b=-b),P=[Z,I,b,O]}var A=this.pixelRatio;this.instructions.push([iq.DRAW_IMAGE,a,S,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,P==tP?tP:P.map(function(t){return t*A}),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]);var L=1/A;this.hitDetectionInstructions.push([iq.DRAW_IMAGE,a,S,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[L,L],NaN,void 0,this.declutterImageWithText_,P,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]),this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,i=this.strokeKey_;!t||i in this.strokeStates||(this.strokeStates[i]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash});var r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||tS,justify:e.justify,textBaseline:e.textBaseline||tw,scale:e.scale});var o=this.fillKey_;!n||o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle})}},{key:"drawChars_",value:function(t,e){var n=this.textStrokeState_,i=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();var s=this.pixelRatio,l=i8[i.textBaseline],u=this.textOffsetY_*s,c=this.text_,h=n?n.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([iq.DRAW_CHARS,t,e,l,i.overflow,a,i.maxAngle,s,u,r,h*s,c,o,1]),this.hitDetectionInstructions.push([iq.DRAW_CHARS,t,e,l,i.overflow,a,i.maxAngle,1,u,r,h,c,o,1/s])}},{key:"setTextStyle",value:function(t,e){var n,i,r;if(t){var o=t.getFill();o?((i=this.textFillState_)||(i={},this.textFillState_=i),i.fillStyle=iR(o.getColor()||tR)):(i=null,this.textFillState_=i);var a=t.getStroke();if(a){(r=this.textStrokeState_)||(r={},this.textStrokeState_=r);var s=a.getLineDash(),l=a.getLineDashOffset(),u=a.getWidth(),c=a.getMiterLimit();r.lineCap=a.getLineCap()||tE,r.lineDash=s?s.slice():tk,r.lineDashOffset=void 0===l?0:l,r.lineJoin=a.getLineJoin()||tT,r.lineWidth=void 0===u?1:u,r.miterLimit=void 0===c?10:c,r.strokeStyle=iR(a.getColor()||tC)}else r=null,this.textStrokeState_=r;n=this.textState_;var h=t.getFont()||tx;tO(h);var f=t.getScaleArray();n.overflow=t.getOverflow(),n.font=h,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||tw,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||tP,n.scale=void 0===f?[1,1]:f;var d=t.getOffsetX(),v=t.getOffsetY(),g=t.getRotateWithView(),p=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===d?0:d,this.textOffsetY_=void 0===v?0:v,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===p?0:p,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:(0,A.sq)(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=i?"string"==typeof i.fillStyle?i.fillStyle:"|"+(0,A.sq)(i.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}]),i}(i3),i9={Circle:i6,Default:i3,Image:i5,LineString:i4,Polygon:i6,Text:i7},rt=function(){function t(e,n,i,r){(0,u.Z)(this,t),this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}return(0,c.Z)(t,[{key:"finish",value:function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var n=this.buildersByZIndex_[e];for(var i in n){var r=n[i].finish();t[e][i]=r}}return t}},{key:"getBuilder",value:function(t,e){var n=void 0!==t?t.toString():"0",i=this.buildersByZIndex_[n];void 0===i&&(i={},this.buildersByZIndex_[n]=i);var r=i[e];return void 0===r&&(r=new i9[e](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[e]=r),r}}]),t}(),re=n(2587),rn=n(2937);function ri(t){return function(t){if(Array.isArray(t))return(0,re.Z)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,rn.Z)(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var rr=n(2456);function ro(t,e,n,i){for(var r=t[e],o=t[e+1],a=0,s=e+i;s<n;s+=i){var l=t[s],u=t[s+1];a+=Math.sqrt((l-r)*(l-r)+(u-o)*(u-o)),r=l,o=u}return a}var ra=(0,M.lJ)(),rs=[],rl=[],ru=[],rc=[];function rh(t){return t[3].declutterBox}var rf=RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function rd(t,e){return"start"!==e&&"end"!==e||rf.test(t)||(e="start"===e?"left":"right"),i8[e]}function rv(t,e,n){return n>0&&t.push("\n",""),t.push(e,""),t}var rg=function(){function t(e,n,i,r){(0,u.Z)(this,t),this.overlaps=i,this.pixelRatio=n,this.resolution=e,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,L.Ue)(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return(0,c.Z)(t,[{key:"createLabel",value:function(t,e,n,i){var r,o=t+e+n+i;if(this.labels_[o])return this.labels_[o];var a=i?this.strokeStates[i]:null,s=n?this.fillStates[n]:null,l=this.textStates[e],u=this.pixelRatio,c=[l.scale[0]*u,l.scale[1]*u],h=Array.isArray(t),f=l.justify?i8[l.justify]:rd(Array.isArray(t)?t[0]:t,l.textAlign||tS),d=i&&a.lineWidth?a.lineWidth:0,v=h?t:t.split("\n").reduce(rv,[]),g=function(t,e){for(var n=[],i=[],r=[],o=0,a=0,s=0,l=0,u=0,c=e.length;u<=c;u+=2){var h=e[u];if("\n"===h||u===c){o=Math.max(o,a),r.push(a),a=0,s+=l;continue}var f=e[u+1]||t.font,d=tM(f,h);n.push(d),a+=d;var v=tA(f);i.push(v),l=Math.max(l,v)}return{width:o,height:s,widths:n,heights:i,lineWidths:r}}(l,v),p=g.width,y=g.height,_=g.widths,m=g.heights,x=g.lineWidths,R=p+d,E=[],k=(R+2)*c[0],T=(y+d)*c[1],C={width:k<0?Math.floor(k):Math.ceil(k),height:T<0?Math.floor(T):Math.ceil(T),contextInstructions:E};(1!=c[0]||1!=c[1])&&E.push("scale",c),i&&(E.push("strokeStyle",a.strokeStyle),E.push("lineWidth",d),E.push("lineCap",a.lineCap),E.push("lineJoin",a.lineJoin),E.push("miterLimit",a.miterLimit),E.push("setLineDash",[a.lineDash]),E.push("lineDashOffset",a.lineDashOffset)),n&&E.push("fillStyle",s.fillStyle),E.push("textBaseline","middle"),E.push("textAlign","center");for(var S=.5-f,w=f*R+S*d,P=[],Z=[],I=0,b=0,O=0,A=0,L=0,M=v.length;L<M;L+=2){var D=v[L];if("\n"===D){b+=I,I=0,w=f*R+S*d,++A;continue}var F=v[L+1]||l.font;F!==r&&(i&&P.push("font",F),n&&Z.push("font",F),r=F),I=Math.max(I,m[O]);var N=[D,w+S*_[O]+f*(_[O]-x[A]),.5*(d+I)+b];w+=_[O],i&&P.push("strokeText",N),n&&Z.push("fillText",N),++O}return Array.prototype.push.apply(E,P),Array.prototype.push.apply(E,Z),this.labels_[o]=C,C}},{key:"replayTextBackground_",value:function(t,e,n,i,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(t,e,n,i,r,o,a,s,l,u,c,h,f,d,v,g){a*=h[0],s*=h[1];var p,y=n-a,_=i-s,m=r+l>t?t-l:r,x=o+u>e?e-u:o,R=d[3]+m*h[0]+d[1],E=d[0]+x*h[1]+d[2],k=y-d[3],T=_-d[0];return(v||0!==c)&&(rs[0]=k,rc[0]=k,rs[1]=T,rl[1]=T,rl[0]=k+R,ru[0]=rl[0],ru[1]=T+E,rc[1]=ru[1]),0!==c?(p=(0,L.qC)((0,L.Ue)(),n,i,1,1,c,-n,-i),(0,L.nn)(p,rs),(0,L.nn)(p,rl),(0,L.nn)(p,ru),(0,L.nn)(p,rc),(0,M.T9)(Math.min(rs[0],rl[0],ru[0],rc[0]),Math.min(rs[1],rl[1],ru[1],rc[1]),Math.max(rs[0],rl[0],ru[0],rc[0]),Math.max(rs[1],rl[1],ru[1],rc[1]),ra)):(0,M.T9)(Math.min(k,k+R),Math.min(T,T+E),Math.max(k,k+R),Math.max(T,T+E),ra),f&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:m,drawImageH:x,originX:l,originY:u,declutterBox:{minX:ra[0],minY:ra[1],maxX:ra[2],maxY:ra[3],value:g},canvasTransform:p,scale:h}}},{key:"replayImageOrLabel_",value:function(t,e,n,i,r,o,a){var s,l,u,c,h,f,d,v,g,p=i.declutterBox,y=t.canvas,_=a?a[2]*i.scale[0]/2:0;return p.minX-_<=y.width/e&&p.maxX+_>=0&&p.minY-_<=y.height/e&&p.maxY+_>=0&&((o||a)&&this.replayTextBackground_(t,rs,rl,ru,rc,o,a),s=t,l=i.canvasTransform,u=i.originX,c=i.originY,h=i.drawImageW,f=i.drawImageH,d=i.drawImageX,v=i.drawImageY,g=i.scale,s.save(),1!==r&&(s.globalAlpha*=r),l&&s.setTransform.apply(s,l),n.contextInstructions?(s.translate(d,v),s.scale(g[0],g[1]),function(t,e){for(var n=t.contextInstructions,i=0,r=n.length;i<r;i+=2)Array.isArray(n[i+1])?e[n[i]].apply(e,n[i+1]):e[n[i]]=n[i+1]}(n,s)):g[0]<0||g[1]<0?(s.translate(d,v),s.scale(g[0],g[1]),s.drawImage(n,u,c,h,f,0,0,h,f)):s.drawImage(n,u,c,h,f,d,v,h*g[0],f*g[1]),s.restore()),!0}},{key:"fill_",value:function(t){if(this.alignFill_){var e=(0,L.nn)(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}},{key:"drawLabelWithPointPlacement_",value:function(t,e,n,i){var r=this.textStates[e],o=this.createLabel(t,e,i,n),a=this.strokeStates[n],s=this.pixelRatio,l=rd(Array.isArray(t)?t[0]:t,r.textAlign||tS),u=i8[r.textBaseline||tw],c=a&&a.lineWidth?a.lineWidth:0,h=o.width/s-2*r.scale[0],f=u*o.height/s+2*(.5-u)*c;return{label:o,anchorX:l*h+2*(.5-l)*c,anchorY:f}}},{key:"execute_",value:function(t,e,n,i,r,o,a,s){this.pixelCoordinates_&&(0,t4.fS)(n,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=(0,rr.vT)(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),(0,L.lk)(this.renderedTransform_,n));for(var l,u,c,h,f,d,v,g,p,y,_,m,x,R,E,k,T,C=0,S=i.length,w=0,P=0,Z=0,I=null,b=null,O=this.coordinateCache_,A=this.viewRotation_,D=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,N={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A},B=this.instructions!=i||this.overlaps?0:200;C<S;){var G=i[C];switch(G[0]){case iq.BEGIN_GEOMETRY:R=G[1],T=G[3],R.getGeometry()?void 0===a||(0,M.kK)(a,T.getExtent())?++C:C=G[2]+1:C=G[2];break;case iq.BEGIN_PATH:P>B&&(this.fill_(t),P=0),Z>B&&(t.stroke(),Z=0),P||Z||(t.beginPath(),f=NaN,d=NaN),++C;break;case iq.CIRCLE:var U=l[w=G[1]],z=l[w+1],X=l[w+2],j=l[w+3],W=X-U,Y=j-z,V=Math.sqrt(W*W+Y*Y);t.moveTo(U+V,z),t.arc(U,z,V,0,2*Math.PI,!0),++C;break;case iq.CLOSE_PATH:t.closePath(),++C;break;case iq.CUSTOM:w=G[1],u=G[2];var H=G[3],K=G[4],q=6==G.length?G[5]:void 0;N.geometry=H,N.feature=R,C in O||(O[C]=[]);var J=O[C];q?q(l,w,u,2,J):(J[0]=l[w],J[1]=l[w+1],J.length=2),K(J,N),++C;break;case iq.DRAW_IMAGE:w=G[1],u=G[2],p=G[3],c=G[4],h=G[5];var $=G[6],Q=G[7],tt=G[8],te=G[9],tn=G[10],ti=G[11],tr=G[12],to=G[13],ta=G[14],ts=G[15];if(!p&&G.length>=20){y=G[19],_=G[20],m=G[21],x=G[22];var tl=this.drawLabelWithPointPlacement_(y,_,m,x);p=tl.label,G[3]=p;var tu=G[23];c=(tl.anchorX-tu)*this.pixelRatio,G[4]=c;var tc=G[24];h=(tl.anchorY-tc)*this.pixelRatio,G[5]=h,$=p.height,G[6]=$,to=p.width,G[13]=to}var th=void 0;G.length>25&&(th=G[25]);var tf=void 0,td=void 0,tv=void 0;G.length>17?(tf=G[16],td=G[17],tv=G[18]):(tf=tP,td=!1,tv=!1),tn&&D?ti+=A:tn||D||(ti-=A);for(var tg=0;w<u;w+=2)if(!th||!(th[tg++]<to/this.pixelRatio)){var tp=this.calculateImageOrLabelDimensions_(p.width,p.height,l[w],l[w+1],to,$,c,h,tt,te,ti,tr,r,tf,td||tv,R),ty=[t,e,p,tp,Q,td?I:null,tv?b:null];if(s){if("none"===ta)continue;if("obstacle"===ta){s.insert(tp.declutterBox);continue}var t_=void 0,tm=void 0;if(ts){var tx=u-w;if(!ts[tx]){ts[tx]=ty;continue}if(t_=ts[tx],delete ts[tx],tm=rh(t_),s.collides(tm))continue}if(s.collides(tp.declutterBox))continue;t_&&(s.insert(tm),this.replayImageOrLabel_.apply(this,t_)),s.insert(tp.declutterBox)}this.replayImageOrLabel_.apply(this,ty)}++C;break;case iq.DRAW_CHARS:var tR=G[1],tE=G[2],tk=G[3],tT=G[4];x=G[5];var tC=G[6],tS=G[7],tw=G[8];m=G[9];var tZ=G[10];y=G[11],_=G[12];var tI=[G[13],G[13]],tb=this.textStates[_],tO=tb.font,tA=[tb.scale[0]*tS,tb.scale[1]*tS],tL=void 0;tO in this.widths_?tL=this.widths_[tO]:(tL={},this.widths_[tO]=tL);var tM=ro(l,tR,tE,2),tF=Math.abs(tA[0])*tD(tO,y,tL);if(tT||tF<=tM){var tN=function(t,e,n,i,r,o,a,s,l,u,c,h){var f,d,v=t[e],g=t[e+1],p=0,y=0,_=0,m=0;function x(){p=v,y=g,e+=i,v=t[e],g=t[e+1],m+=_,_=Math.sqrt((v-p)*(v-p)+(g-y)*(g-y))}do x();while(e<n-i&&m+_<o);for(var R=0===_?0:(o-m)/_,E=(0,F.t7)(p,v,R),k=(0,F.t7)(y,g,R),T=e-i,C=m,S=o+s*l(u,r,c);e<n-i&&m+_<S;)x();R=0===_?0:(S-m)/_;var w=(0,F.t7)(p,v,R),P=(0,F.t7)(y,g,R);if(h){var Z=[E,k,w,P];(0,rr.U1)(Z,0,4,2,h,Z,Z),f=Z[0]>Z[2]}else f=E>w;var I=Math.PI,b=[],O=T+i===e;if(e=T,_=0,m=C,v=t[e],g=t[e+1],O)return x(),d=Math.atan2(g-y,v-p),f&&(d+=d>0?-I:I),b[0]=[(w+E)/2,(P+k)/2,(S-o)/2,d,r],b;r=r.replace(/\n/g," ");for(var A=0,L=r.length;A<L;){x();var M=Math.atan2(g-y,v-p);if(f&&(M+=M>0?-I:I),void 0!==d){var D=M-d;if(Math.abs(D+=D>I?-2*I:D<-I?2*I:0)>a)return null}d=M;for(var N=A,B=0;A<L;++A){var G=s*l(u,r[f?L-A-1:A],c);if(e+i<n&&m+_<o+B+G/2)break;B+=G}if(A!==N){var U=f?r.substring(L-N,L-A):r.substring(N,A);R=0===_?0:(o+B/2-m)/_;var z=(0,F.t7)(p,v,R),X=(0,F.t7)(y,g,R);b.push([z,X,B/2,M,U]),o+=B}}return b}(l,tR,tE,2,y,(tM-tF)*i8[this.textStates[_].textAlign],tC,Math.abs(tA[0]),tD,tO,tL,D?0:this.viewRotation_);t:if(tN){var tB=[],tG=void 0,tU=void 0,tz=void 0,tX=void 0,tj=void 0;if(m)for(tG=0,tU=tN.length;tG<tU;++tG){tz=(tj=tN[tG])[4],tX=this.createLabel(tz,_,"",m),c=tj[2]+(tA[0]<0?-tZ:tZ),h=tk*tX.height+(.5-tk)*2*tZ*tA[1]/tA[0]-tw;var tW=this.calculateImageOrLabelDimensions_(tX.width,tX.height,tj[0],tj[1],tX.width,tX.height,c,h,0,0,tj[3],tI,!1,tP,!1,R);if(s&&s.collides(tW.declutterBox))break t;tB.push([t,e,tX,tW,1,null,null])}if(x)for(tG=0,tU=tN.length;tG<tU;++tG){tz=(tj=tN[tG])[4],tX=this.createLabel(tz,_,x,""),c=tj[2],h=tk*tX.height-tw;var tY=this.calculateImageOrLabelDimensions_(tX.width,tX.height,tj[0],tj[1],tX.width,tX.height,c,h,0,0,tj[3],tI,!1,tP,!1,R);if(s&&s.collides(tY.declutterBox))break t;tB.push([t,e,tX,tY,1,null,null])}s&&s.load(tB.map(rh));for(var tV=0,tH=tB.length;tV<tH;++tV)this.replayImageOrLabel_.apply(this,tB[tV])}}++C;break;case iq.END_GEOMETRY:if(void 0!==o){var tK=o(R=G[1],T);if(tK)return tK}++C;break;case iq.FILL:B?P++:this.fill_(t),++C;break;case iq.MOVE_TO_LINE_TO:for(w=G[1],u=G[2],E=l[w],k=l[w+1],v=E+.5|0,g=k+.5|0,(v!==f||g!==d)&&(t.moveTo(E,k),f=v,d=g),w+=2;w<u;w+=2)E=l[w],k=l[w+1],v=E+.5|0,g=k+.5|0,(w==u-2||v!==f||g!==d)&&(t.lineTo(E,k),f=v,d=g);++C;break;case iq.SET_FILL_STYLE:I=G,this.alignFill_=G[2],P&&(this.fill_(t),P=0,Z&&(t.stroke(),Z=0)),t.fillStyle=G[1],++C;break;case iq.SET_STROKE_STYLE:b=G,Z&&(t.stroke(),Z=0),this.setStrokeStyle_(t,G),++C;break;case iq.STROKE:B?Z++:t.stroke(),++C;break;default:++C}}P&&this.fill_(t),Z&&t.stroke()}},{key:"execute",value:function(t,e,n,i,r,o){this.viewRotation_=i,this.execute_(t,e,n,this.instructions,r,void 0,void 0,o)}},{key:"executeHitDetection",value:function(t,e,n,i,r){return this.viewRotation_=n,this.execute_(t,1,e,this.hitDetectionInstructions,!0,i,r)}}]),t}(),rp=["Polygon","Circle","LineString","Image","Text","Default"],ry=function(){function t(e,n,i,r,o,a){(0,u.Z)(this,t),this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=n,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,L.Ue)(),this.createExecutors_(o)}return(0,c.Z)(t,[{key:"clip",value:function(t,e){var n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}},{key:"createExecutors_",value:function(t){for(var e in t){var n=this.executorsByZIndex_[e];void 0===n&&(n={},this.executorsByZIndex_[e]=n);var i=t[e];for(var r in i){var o=i[r];n[r]=new rg(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}},{key:"hasExecutors",value:function(t){for(var e in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[e],i=0,r=t.length;i<r;++i)if(t[i]in n)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r,o){var a,s,l,u,c,h,f,d=2*(i=Math.round(i))+1,v=(0,L.qC)(this.hitDetectionTransform_,i+.5,i+.5,1/e,-1/e,-n,-t[0],-t[1]),g=!this.hitDetectionContext_;g&&(this.hitDetectionContext_=tg(d,d,void 0,{willReadFrequently:!0}));var p=this.hitDetectionContext_;p.canvas.width!==d||p.canvas.height!==d?(p.canvas.width=d,p.canvas.height=d):g||p.clearRect(0,0,d,d),void 0!==this.renderBuffer_&&(a=(0,M.lJ)(),(0,M.Wj)(a,t),(0,M.f3)(a,e*(this.renderBuffer_+i),a));var y=function(t){if(void 0!==r_[t])return r_[t];for(var e=2*t+1,n=t*t,i=Array(n+1),r=0;r<=t;++r)for(var o=0;o<=t;++o){var a=r*r+o*o;if(a>n)break;var s=i[a];s||(s=[],i[a]=s),s.push(((t+r)*e+(t+o))*4+3),r>0&&s.push(((t-r)*e+(t+o))*4+3),o>0&&(s.push(((t+r)*e+(t-o))*4+3),r>0&&s.push(((t-r)*e+(t-o))*4+3))}for(var l=[],u=0,c=i.length;u<c;++u)i[u]&&l.push.apply(l,ri(i[u]));return r_[t]=l,l}(i);function _(t,e){for(var n=p.getImageData(0,0,d,d).data,a=0,l=y.length;a<l;a++)if(n[y[a]]>0){if(!o||"Image"!==s&&"Text"!==s||o.includes(t)){var u=(y[a]-3)/4,c=i-u%d,h=i-(u/d|0),f=r(t,e,c*c+h*h);if(f)return f}p.clearRect(0,0,d,d);break}}var m=Object.keys(this.executorsByZIndex_).map(Number);for(m.sort(t4.j2),l=m.length-1;l>=0;--l){var x=m[l].toString();for(c=this.executorsByZIndex_[x],u=rp.length-1;u>=0;--u)if(void 0!==(h=c[s=rp[u]])&&(f=h.executeHitDetection(p,v,n,_,a)))return f}}},{key:"getClipCoords",value:function(t){var e=this.maxExtent_;if(!e)return null;var n=e[0],i=e[1],r=e[2],o=e[3],a=[n,i,n,o,r,o,r,i];return(0,rr.vT)(a,0,8,2,t,a),a}},{key:"isEmpty",value:function(){return(0,tv.x)(this.executorsByZIndex_)}},{key:"execute",value:function(t,e,n,i,r,o,a){var s,l,u,c,h,f,d=Object.keys(this.executorsByZIndex_).map(Number);for(d.sort(t4.j2),this.maxExtent_&&(t.save(),this.clip(t,n)),o=o||rp,a&&d.reverse(),s=0,l=d.length;s<l;++s){var v=d[s].toString();for(u=0,h=this.executorsByZIndex_[v],c=o.length;u<c;++u)void 0!==(f=h[o[u]])&&f.execute(t,e,n,i,r,a)}this.maxExtent_&&t.restore()}}]),t}(),r_={},rm=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a,s,l){var c;return(0,u.Z)(this,i),(c=n.call(this)).context_=t,c.pixelRatio_=e,c.extent_=r,c.transform_=o,c.transformRotation_=o?(0,F.FH)(Math.atan2(o[1],o[0]),10):0,c.viewRotation_=a,c.squaredTolerance_=s,c.userTransform_=l,c.contextFillState_=null,c.contextStrokeState_=null,c.contextTextState_=null,c.fillState_=null,c.strokeState_=null,c.image_=null,c.imageAnchorX_=0,c.imageAnchorY_=0,c.imageHeight_=0,c.imageOpacity_=0,c.imageOriginX_=0,c.imageOriginY_=0,c.imageRotateWithView_=!1,c.imageRotation_=0,c.imageScale_=[0,0],c.imageWidth_=0,c.text_="",c.textOffsetX_=0,c.textOffsetY_=0,c.textRotateWithView_=!1,c.textRotation_=0,c.textScale_=[0,0],c.textFillState_=null,c.textStrokeState_=null,c.textState_=null,c.pixelCoordinates_=[],c.tmpLocalTransform_=(0,L.Ue)(),c}return(0,c.Z)(i,[{key:"drawImages_",value:function(t,e,n,i){if(this.image_){var r=(0,rr.vT)(t,e,n,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,s=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=s*this.imageOpacity_);var l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,c=r.length;u<c;u+=2){var h=r[u]-this.imageAnchorX_,f=r[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var d=h+this.imageAnchorX_,v=f+this.imageAnchorY_;(0,L.qC)(a,d,v,1,1,l,-d,-v),o.setTransform.apply(o,a),o.translate(d,v),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,f,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=s)}}},{key:"drawText_",value:function(t,e,n,i){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=(0,rr.vT)(t,e,n,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.textRotation_;for(0===this.transformRotation_&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=i){var s=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.translate(s-this.textOffsetX_,l-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,s,l),this.textFillState_&&o.fillText(this.text_,s,l))}}}},{key:"moveToLineTo_",value:function(t,e,n,i,r){var o=this.context_,a=(0,rr.vT)(t,e,n,i,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var s=a.length;r&&(s-=2);for(var l=2;l<s;l+=2)o.lineTo(a[l],a[l+1]);return r&&o.closePath(),n}},{key:"drawRings_",value:function(t,e,n,i){for(var r=0,o=n.length;r<o;++r)e=this.moveToLineTo_(t,e,n[r],i,!0);return e}},{key:"drawCircle",value:function(t){if((0,M.kK)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=(0,eo.Kr)(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],i=e[3]-e[1],r=this.context_;r.beginPath(),r.arc(e[0],e[1],Math.sqrt(n*n+i*i),0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var n=e.getGeometryFunction()(t);n&&(0,M.kK)(this.extent_,n.getExtent())&&(this.setStyle(e),this.drawGeometry(n))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),n=0,i=e.length;n<i;++n)this.drawGeometry(e[n])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,M.kK)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var i=t.getFlatMidpoint();this.drawText_(i,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if((0,M.kK)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getFlatCoordinates(),r=0,o=t.getEnds(),a=t.getStride();n.beginPath();for(var s=0,l=o.length;s<l;++s)r=this.moveToLineTo_(i,r,o[s],a,!1);n.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,M.kK)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,M.kK)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getOrientedFlatCoordinates(),i=0,r=t.getEndss(),o=t.getStride();e.beginPath();for(var a=0,s=r.length;a<s;++a){var l=r[a];i=this.drawRings_(n,i,l,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),(0,t4.fS)(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,n=this.contextTextState_,i=t.textAlign?t.textAlign:tS;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=i&&(n.textAlign=i,e.textAlign=i),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=i,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:i,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){var n=this;if(t){var i=t.getColor();this.fillState_={fillStyle:iR(i||tR)}}else this.fillState_=null;if(e){var r=e.getColor(),o=e.getLineCap(),a=e.getLineDash(),s=e.getLineDashOffset(),l=e.getLineJoin(),u=e.getWidth(),c=e.getMiterLimit(),h=a||tk;this.strokeState_={lineCap:void 0!==o?o:tE,lineDash:1===this.pixelRatio_?h:h.map(function(t){return t*n.pixelRatio_}),lineDashOffset:(s||0)*this.pixelRatio_,lineJoin:void 0!==l?l:tT,lineWidth:(void 0!==u?u:1)*this.pixelRatio_,miterLimit:void 0!==c?c:10,strokeStyle:iR(r||tC)}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){if(!t||!(e=t.getSize())){this.image_=null;return}var e,n=t.getPixelRatio(this.pixelRatio_),i=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*n,this.imageAnchorY_=i[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();var o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var n=e.getColor();this.textFillState_={fillStyle:iR(n||tR)}}else this.textFillState_=null;var i=t.getStroke();if(i){var r=i.getColor(),o=i.getLineCap(),a=i.getLineDash(),s=i.getLineDashOffset(),l=i.getLineJoin(),u=i.getWidth(),c=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:tE,lineDash:a||tk,lineDashOffset:s||0,lineJoin:void 0!==l?l:tT,lineWidth:void 0!==u?u:1,miterLimit:void 0!==c?c:10,strokeStyle:iR(r||tC)}}else this.textStrokeState_=null;var h=t.getFont(),f=t.getOffsetX(),d=t.getOffsetY(),v=t.getRotateWithView(),g=t.getRotation(),p=t.getScaleArray(),y=t.getText(),_=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:void 0!==h?h:tx,textAlign:void 0!==_?_:tS,textBaseline:void 0!==m?m:tw},this.text_=void 0!==y?Array.isArray(y)?y.reduce(function(t,e,n){return t+(n%2?" ":e)},""):y:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==d?this.pixelRatio_*d:0,this.textRotateWithView_=void 0!==v&&v,this.textRotation_=void 0!==g?g:0,this.textScale_=[this.pixelRatio_*p[0],this.pixelRatio_*p[1]]}else this.text_=""}}]),i}(i2);function rx(t,e,n,i,r,o,a){var s=tg(.5*t[0],.5*t[1]);s.imageSmoothingEnabled=!1;for(var l=s.canvas,u=new rm(s,.5,r,null,a),c=n.length,h=Math.floor(16777215/c),f={},d=1;d<=c;++d){var v=n[d-1],g=v.getStyleFunction()||i;if(i){var p=g(v,o);if(p){Array.isArray(p)||(p=[p]);for(var y=(d*h).toString(16).padStart(7,"#00000"),_=0,m=p.length;_<m;++_){var x=p[_],R=x.getGeometryFunction()(v);if(R&&(0,M.kK)(r,R.getExtent())){var E=x.clone(),k=E.getFill();k&&k.setColor(y);var T=E.getStroke();T&&(T.setColor(y),T.setLineDash(null)),E.setText(void 0);var C=x.getImage();if(C&&0!==C.getOpacity()){var S=C.getImageSize();if(!S)continue;var w=tg(S[0],S[1],void 0,{alpha:!1}),P=w.canvas;w.fillStyle=y,w.fillRect(0,0,P.width,P.height),E.setImage(new iX({img:P,imgSize:S,anchor:C.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:C.getOrigin(),opacity:1,size:C.getSize(),scale:C.getScale(),rotation:C.getRotation(),rotateWithView:C.getRotateWithView()}))}var Z=E.getZIndex()||0,I=f[Z];I||(I={},f[Z]=I,I.Polygon=[],I.Circle=[],I.LineString=[],I.Point=[]);var b=R.getType();if("GeometryCollection"===b)for(var O=R.getGeometriesArrayRecursive(),A=0,L=O.length;A<L;++A){var D=O[A];I[D.getType().replace("Multi","")].push(D,E)}else I[b.replace("Multi","")].push(R,E)}}}}}for(var F=Object.keys(f).map(Number).sort(t4.j2),N=0,B=F.length;N<B;++N){var G=f[F[N]];for(var U in G)for(var z=G[U],X=0,j=z.length;X<j;X+=2){u.setStyle(z[X+1]);for(var W=0,Y=e.length;W<Y;++W)u.setTransform(e[W]),u.drawGeometry(z[X])}}return s.getImageData(0,0,l.width,l.height)}function rR(t,e,n){var i=[];if(n){var r=Math.floor(.5*Math.round(t[0])),o=Math.floor(.5*Math.round(t[1])),a=((0,F.uZ)(r,0,n.width-1)+(0,F.uZ)(o,0,n.height-1)*n.width)*4,s=n.data[a],l=n.data[a+1],u=n.data[a+2]+256*(l+256*s),c=Math.floor(16777215/e.length);u&&u%c==0&&i.push(e[u/c-1])}return i}var rE={Point:function(t,e,n,i,r){var o,a=n.getImage(),s=n.getText();if(a){if(a.getImageState()!=nR.LOADED)return;var l=t;if(r){var u=a.getDeclutterMode();if("none"!==u){if(l=r,"obstacle"===u){var c=t.getBuilder(n.getZIndex(),"Image");c.setImageStyle(a,o),c.drawPoint(e,i)}else s&&s.getText()&&(o={})}}var h=l.getBuilder(n.getZIndex(),"Image");h.setImageStyle(a,o),h.drawPoint(e,i)}if(s&&s.getText()){var f=t;r&&(f=r);var d=f.getBuilder(n.getZIndex(),"Text");d.setTextStyle(s,o),d.drawText(e,i)}},LineString:function(t,e,n,i,r){var o=n.getStroke();if(o){var a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawLineString(e,i)}var s=n.getText();if(s&&s.getText()){var l=(r||t).getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,i)}},Polygon:function(t,e,n,i,r){var o=n.getFill(),a=n.getStroke();if(o||a){var s=t.getBuilder(n.getZIndex(),"Polygon");s.setFillStrokeStyle(o,a),s.drawPolygon(e,i)}var l=n.getText();if(l&&l.getText()){var u=(r||t).getBuilder(n.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}},MultiPoint:function(t,e,n,i,r){var o,a=n.getImage(),s=n.getText();if(a){if(a.getImageState()!=nR.LOADED)return;var l=t;if(r){var u=a.getDeclutterMode();if("none"!==u){if(l=r,"obstacle"===u){var c=t.getBuilder(n.getZIndex(),"Image");c.setImageStyle(a,o),c.drawMultiPoint(e,i)}else s&&s.getText()&&(o={})}}var h=l.getBuilder(n.getZIndex(),"Image");h.setImageStyle(a,o),h.drawMultiPoint(e,i)}if(s&&s.getText()){var f=t;r&&(f=r);var d=f.getBuilder(n.getZIndex(),"Text");d.setTextStyle(s,o),d.drawText(e,i)}},MultiLineString:function(t,e,n,i,r){var o=n.getStroke();if(o){var a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawMultiLineString(e,i)}var s=n.getText();if(s&&s.getText()){var l=(r||t).getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,i)}},MultiPolygon:function(t,e,n,i,r){var o=n.getFill(),a=n.getStroke();if(a||o){var s=t.getBuilder(n.getZIndex(),"Polygon");s.setFillStrokeStyle(o,a),s.drawMultiPolygon(e,i)}var l=n.getText();if(l&&l.getText()){var u=(r||t).getBuilder(n.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}},GeometryCollection:function(t,e,n,i,r){var o,a,s=e.getGeometriesArray();for(o=0,a=s.length;o<a;++o)(0,rE[s[o].getType()])(t,s[o],n,i,r)},Circle:function(t,e,n,i,r){var o=n.getFill(),a=n.getStroke();if(o||a){var s=t.getBuilder(n.getZIndex(),"Circle");s.setFillStrokeStyle(o,a),s.drawCircle(e,i)}var l=n.getText();if(l&&l.getText()){var u=(r||t).getBuilder(n.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}};function rk(t,e){return parseInt((0,A.sq)(t),10)-parseInt((0,A.sq)(e),10)}function rT(t,e){var n=.5*t/e;return n*n}function rC(t,e,n,i,r,o,a){var s=!1,l=n.getImage();if(l){var u=l.getImageState();u==nR.LOADED||u==nR.ERROR?l.unlistenImageChange(r):(u==nR.IDLE&&l.load(),l.listenImageChange(r),s=!0)}return function(t,e,n,i,r,o){var a=n.getGeometryFunction()(e);if(a){var s=a.simplifyTransformed(i,r);n.getRenderer()?function t(e,n,i,r){if("GeometryCollection"==n.getType()){for(var o=n.getGeometries(),a=0,s=o.length;a<s;++a)t(e,o[a],i,r);return}e.getBuilder(i.getZIndex(),"Default").drawCustom(n,r,i.getRenderer(),i.getHitDetectionRenderer())}(t,s,n,e):(0,rE[s.getType()])(t,s,n,e,o)}}(t,e,n,i,o,a),s}var rS=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,t)).boundHandleStyleImageChange_=e.handleStyleImageChange_.bind((0,E.Z)(e)),e.animatingOrInteracting_,e.hitDetectionImageData_=null,e.renderedFeatures_=null,e.renderedRevision_=-1,e.renderedResolution_=NaN,e.renderedExtent_=(0,M.lJ)(),e.wrappedRenderedExtent_=(0,M.lJ)(),e.renderedRotation_,e.renderedCenter_=null,e.renderedProjection_=null,e.renderedRenderOrder_=null,e.replayGroup_=null,e.replayGroupChanged=!0,e.declutterExecutorGroup=null,e.clipping=!0,e.compositionContext_=null,e.opacity_=1,e}return(0,c.Z)(i,[{key:"renderWorlds",value:function(t,e,n){var i=e.extent,r=e.viewState,o=r.center,a=r.resolution,s=r.projection,l=r.rotation,u=s.getExtent(),c=this.getLayer().getSource(),h=e.pixelRatio,f=e.viewHints,d=!(f[t0.ANIMATING]||f[t0.INTERACTING]),v=this.compositionContext_,g=Math.round(e.size[0]*h),p=Math.round(e.size[1]*h),y=c.getWrapX()&&s.canWrapX(),_=y?(0,M.dz)(u):null,m=y?Math.ceil((i[2]-u[2])/_)+1:1,x=y?Math.floor((i[0]-u[0])/_):0;do{var R=this.getRenderTransform(o,a,l,h,g,p,x*_);t.execute(v,1,R,l,d,void 0,n)}while(++x<m)}},{key:"setupCompositionContext_",value:function(){if(1!==this.opacity_){var t=tg(this.context.canvas.width,this.context.canvas.height,nk);this.compositionContext_=t}else this.compositionContext_=this.context}},{key:"releaseCompositionContext_",value:function(){if(1!==this.opacity_){var t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,tp(this.compositionContext_),nk.push(this.compositionContext_.canvas),this.compositionContext_=null}}},{key:"renderDeclutter",value:function(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}},{key:"renderFrame",value:function(t,e){var n=t.pixelRatio,i=t.layerStatesArray[t.layerIndex];(0,L.n3)(this.pixelTransform,1/n,1/n),(0,L.nb)(this.inversePixelTransform,this.pixelTransform);var r=(0,L.BB)(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));var o=this.context,a=o.canvas,s=this.replayGroup_,l=this.declutterExecutorGroup;if((!s||s.isEmpty())&&(!l||l.isEmpty()))return null;var u=Math.round(t.size[0]*n),c=Math.round(t.size[1]*n);a.width!=u||a.height!=c?(a.width=u,a.height=c,a.style.transform!==r&&(a.style.transform=r)):this.containerReused||o.clearRect(0,0,u,c),this.preRender(o,t);var h=t.viewState,f=h.projection;this.opacity_=i.opacity,this.setupCompositionContext_();var d=!1,v=!0;if(i.extent&&this.clipping){var g=(0,t2.dY)(i.extent,f);(d=(v=(0,M.kK)(g,t.extent))&&!(0,M.r4)(g,t.extent))&&this.clipUnrotated(this.compositionContext_,t,g)}return v&&this.renderWorlds(s,t),d&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==h.rotation&&(this.renderedRotation_=h.rotation,this.hitDetectionImageData_=null),this.container}},{key:"getFeatures",value:function(t){var e=this;return new Promise(function(n){if(!e.hitDetectionImageData_&&!e.animatingOrInteracting_){var i=[e.context.canvas.width,e.context.canvas.height];(0,L.nn)(e.pixelTransform,i);var r=e.renderedCenter_,o=e.renderedResolution_,a=e.renderedRotation_,s=e.renderedProjection_,l=e.wrappedRenderedExtent_,u=e.getLayer(),c=[],h=.5*i[0],f=.5*i[1];c.push(e.getRenderTransform(r,o,a,.5,h,f,0).slice());var d=u.getSource(),v=s.getExtent();if(d.getWrapX()&&s.canWrapX()&&!(0,M.r4)(v,l)){for(var g,p=l[0],y=(0,M.dz)(v),_=0;p<v[0];)g=y*--_,c.push(e.getRenderTransform(r,o,a,.5,h,f,g).slice()),p+=y;for(_=0,p=l[2];p>v[2];)g=y*++_,c.push(e.getRenderTransform(r,o,a,.5,h,f,g).slice()),p-=y}e.hitDetectionImageData_=rx(i,c,e.renderedFeatures_,u.getStyleFunction(),l,o,a)}n(rR(t,e.renderedFeatures_,e.hitDetectionImageData_))})}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r){var o,a=this;if(this.replayGroup_){var s=e.viewState.resolution,l=e.viewState.rotation,u=this.getLayer(),c={},h=function(t,e,n){var o=(0,A.sq)(t),a=c[o];if(a){if(!0!==a&&n<a.distanceSq){if(0===n)return c[o]=!0,r.splice(r.lastIndexOf(a),1),i(t,u,e);a.geometry=e,a.distanceSq=n}}else{if(0===n)return c[o]=!0,i(t,u,e);r.push(c[o]={feature:t,layer:u,geometry:e,distanceSq:n,callback:i})}},f=[this.replayGroup_];return this.declutterExecutorGroup&&f.push(this.declutterExecutorGroup),f.some(function(i){return o=i.forEachFeatureAtCoordinate(t,s,l,n,h,i===a.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(function(t){return t.value}):null)}),o}}},{key:"handleFontsChanged",value:function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}},{key:"handleStyleImageChange_",value:function(t){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(t){var e,n,i=this,r=this.getLayer(),o=r.getSource();if(!o)return!1;var a=t.viewHints[t0.ANIMATING],s=t.viewHints[t0.INTERACTING],l=r.getUpdateWhileAnimating(),u=r.getUpdateWhileInteracting();if(this.ready&&!l&&a||!u&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var c=t.extent,h=t.viewState,f=h.projection,d=h.resolution,v=t.pixelRatio,g=r.getRevision(),p=r.getRenderBuffer(),y=r.getRenderOrder();void 0===y&&(y=rk);var _=h.center.slice(),m=(0,M.f3)(c,p*d),x=m.slice(),R=[m.slice()],E=f.getExtent();if(o.getWrapX()&&f.canWrapX()&&!(0,M.r4)(E,t.extent)){var k=(0,M.dz)(E),T=Math.max((0,M.dz)(m)/2,k);m[0]=E[0]-T,m[2]=E[2]+T,(0,te.Cf)(_,f);var C=(0,M.Cf)(R[0],f);C[0]<E[0]&&C[2]<E[2]?R.push([C[0]+k,C[1],C[2]+k,C[3]]):C[0]>E[0]&&C[2]>E[2]&&R.push([C[0]-k,C[1],C[2]-k,C[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==g&&this.renderedRenderOrder_==y&&(0,M.r4)(this.wrappedRenderedExtent_,m))return(0,t4.fS)(this.renderedExtent_,x)||(this.hitDetectionImageData_=null,this.renderedExtent_=x),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var S=new rt(.5*d/v,m,d,v);this.getLayer().getDeclutter()&&(e=new rt(.5*d/v,m,d,v));var w=(0,t2.Cs)();if(w){for(var P=0,Z=R.length;P<Z;++P){var I=R[P],b=(0,t2.Fj)(I,f);o.loadFeatures(b,(0,t2.on)(d,f),w)}n=(0,t2.WO)(w,f)}else for(var O=0,A=R.length;O<A;++O)o.loadFeatures(R[O],d,f);var L=rT(d,v),D=!0,F=(0,t2.Fj)(m,f),N=o.getFeaturesInExtent(F);y&&N.sort(y);for(var B=0,G=N.length;B<G;++B)!function(t){var o,a=t.getStyleFunction()||r.getStyleFunction();if(a&&(o=a(t,d)),o){var s=i.renderFeature(t,L,o,S,n,e);D=D&&!s}}(N[B]);this.renderedFeatures_=N,this.ready=D;var U=S.finish(),z=new ry(m,d,v,o.getOverlaps(),U,r.getRenderBuffer());return e&&(this.declutterExecutorGroup=new ry(m,d,v,o.getOverlaps(),e.finish(),r.getRenderBuffer())),this.renderedResolution_=d,this.renderedRevision_=g,this.renderedRenderOrder_=y,this.renderedExtent_=x,this.wrappedRenderedExtent_=m,this.renderedCenter_=_,this.renderedProjection_=f,this.replayGroup_=z,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(t,e,n,i,r,o){if(!n)return!1;var a=!1;if(Array.isArray(n))for(var s=0,l=n.length;s<l;++s)a=rC(i,t,n[s],e,this.boundHandleStyleImageChange_,r,o)||a;else a=rC(i,t,n,e,this.boundHandleStyleImageChange_,r,o);return a}}]),i}(nC),rw=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){return(0,u.Z)(this,i),n.call(this,t)}return(0,c.Z)(i,[{key:"createRenderer",value:function(){return new rS(this)}}]),i}(iK),rP=function(){function t(e){(0,u.Z)(this,t),this.rbush_=new(iG())(e),this.items_={}}return(0,c.Z)(t,[{key:"insert",value:function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[(0,A.sq)(e)]=n}},{key:"load",value:function(t,e){for(var n=Array(e.length),i=0,r=e.length;i<r;i++){var o=t[i],a=e[i],s={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[i]=s,this.items_[(0,A.sq)(a)]=s}this.rbush_.load(n)}},{key:"remove",value:function(t){var e=(0,A.sq)(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}},{key:"update",value:function(t,e){var n=this.items_[(0,A.sq)(e)],i=[n.minX,n.minY,n.maxX,n.maxY];(0,M.fS)(i,t)||(this.remove(e),this.insert(t,e))}},{key:"getAll",value:function(){return this.rbush_.all().map(function(t){return t.value})}},{key:"getInExtent",value:function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})}},{key:"forEach",value:function(t){return this.forEach_(this.getAll(),t)}},{key:"forEachInExtent",value:function(t,e){return this.forEach_(this.getInExtent(t),e)}},{key:"forEach_",value:function(t,e){for(var n,i=0,r=t.length;i<r&&!(n=e(t[i]));i++);return n}},{key:"isEmpty",value:function(){return(0,tv.x)(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(t){var e=this.rbush_.toJSON();return(0,M.T9)(e.minX,e.minY,e.maxX,e.maxY,t)}},{key:"concat",value:function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]}}]),t}(),rZ={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function rI(t,e){return[[-1/0,-1/0,1/0,1/0]]}function rb(t,e,n,i,r,o,a){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(n,i,r):t,!0),"arraybuffer"==e.getType()&&(s.responseType="arraybuffer"),s.withCredentials=!1,s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var i,l=e.getType();"json"==l||"text"==l?i=s.responseText:"xml"==l?(i=s.responseXML)||(i=new DOMParser().parseFromString(s.responseText,"application/xml")):"arraybuffer"==l&&(i=s.response),i?o(e.readFeatures(i,{extent:n,featureProjection:r}),e.readProjection(i)):a()}else a()},s.onerror=a,s.send()}function rO(t,e){return function(n,i,r,o,a){var s=this;rb(t,e,n,i,r,function(t,e){s.addFeatures(t),void 0!==o&&o(t)},a||O.Zn)}}function rA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var rL=function(t){(0,h.Z)(n,t);var e=rA(n);function n(t,i,r){var o;return(0,u.Z)(this,n),(o=e.call(this,t)).feature=i,o.features=r,o}return(0,c.Z)(n)}(S.ZP),rM=function(t){(0,h.Z)(n,t);var e=rA(n);function n(t){(0,u.Z)(this,n),t=t||{},(i=e.call(this,{attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX})).on,i.once,i.un,i.loader_=O.Zn,i.format_=t.format,i.overlaps_=void 0===t.overlaps||t.overlaps,i.url_=t.url,void 0!==t.loader?i.loader_=t.loader:void 0!==i.url_&&((0,D.h)(i.format_,7),i.loader_=rO(i.url_,i.format_)),i.strategy_=void 0!==t.strategy?t.strategy:rI;var i,r,o,a=void 0===t.useSpatialIndex||t.useSpatialIndex;return i.featuresRtree_=a?new rP:null,i.loadedExtentsRtree_=new rP,i.loadingExtentsCount_=0,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(t.features)?o=t.features:t.features&&(o=(r=t.features).getArray()),a||void 0!==r||(r=new I(o)),void 0!==o&&i.addFeaturesInternal(o),void 0!==r&&i.bindFeaturesCollection_(r),i}return(0,c.Z)(n,[{key:"addFeature",value:function(t){this.addFeatureInternal(t),this.changed()}},{key:"addFeatureInternal",value:function(t){var e=(0,A.sq)(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var i=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new rL(rZ.ADDFEATURE,t))}},{key:"setupChangeEvents_",value:function(t,e){this.featureChangeKeys_[t]=[(0,$.oL)(e,q.Z.CHANGE,this.handleFeatureChange_,this),(0,$.oL)(e,tr.Z.PROPERTYCHANGE,this.handleFeatureChange_,this)]}},{key:"addToIndex_",value:function(t,e){var n=!0,i=e.getId();return void 0!==i&&(i.toString() in this.idIndex_?n=!1:this.idIndex_[i.toString()]=e),n&&((0,D.h)(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),n}},{key:"addFeatures",value:function(t){this.addFeaturesInternal(t),this.changed()}},{key:"addFeaturesInternal",value:function(t){for(var e=[],n=[],i=[],r=0,o=t.length;r<o;r++){var a=t[r],s=(0,A.sq)(a);this.addToIndex_(s,a)&&n.push(a)}for(var l=0,u=n.length;l<u;l++){var c=n[l],h=(0,A.sq)(c);this.setupChangeEvents_(h,c);var f=c.getGeometry();if(f){var d=f.getExtent();e.push(d),i.push(c)}else this.nullGeometryFeatures_[h]=c}if(this.featuresRtree_&&this.featuresRtree_.load(e,i),this.hasListener(rZ.ADDFEATURE))for(var v=0,g=n.length;v<g;v++)this.dispatchEvent(new rL(rZ.ADDFEATURE,n[v]))}},{key:"bindFeaturesCollection_",value:function(t){var e=this,n=!1;this.addEventListener(rZ.ADDFEATURE,function(e){n||(n=!0,t.push(e.feature),n=!1)}),this.addEventListener(rZ.REMOVEFEATURE,function(e){n||(n=!0,t.remove(e.feature),n=!1)}),t.addEventListener(C.ADD,function(t){n||(n=!0,e.addFeature(t.element),n=!1)}),t.addEventListener(C.REMOVE,function(t){n||(n=!0,e.removeFeature(t.element),n=!1)}),this.featuresCollection_=t}},{key:"clear",value:function(t){var e=this;if(t){for(var n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach($.bN);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(function(t){e.removeFeatureInternal(t)}),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var r=new rL(rZ.CLEAR);this.dispatchEvent(r),this.changed()}},{key:"forEachFeature",value:function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureAtCoordinateDirect",value:function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(n){if(n.getGeometry().intersectsCoordinate(t))return e(n)})}},{key:"forEachFeatureInExtent",value:function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureIntersectingExtent",value:function(t,e){return this.forEachFeatureInExtent(t,function(n){if(n.getGeometry().intersectsExtent(t)){var i=e(n);if(i)return i}})}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),(0,tv.x)(this.nullGeometryFeatures_)||(0,t4.l7)(t,Object.values(this.nullGeometryFeatures_))),t}},{key:"getFeaturesAtCoordinate",value:function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e}},{key:"getFeaturesInExtent",value:function(t,e){var n=this;if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);var i,r=(0,M.MV)(t,e);return(i=[]).concat.apply(i,ri(r.map(function(t){return n.featuresRtree_.getInExtent(t)})))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(t,e){var n=t[0],i=t[1],r=null,o=[NaN,NaN],a=1/0,s=[-1/0,-1/0,1/0,1/0];return e=e||O.uX,this.featuresRtree_.forEachInExtent(s,function(t){if(e(t)){var l=t.getGeometry(),u=a;if((a=l.closestPointXY(n,i,o,a))<u){r=t;var c=Math.sqrt(a);s[0]=n-c,s[1]=i-c,s[2]=n+c,s[3]=i+c}}}),r}},{key:"getExtent",value:function(t){return this.featuresRtree_.getExtent(t)}},{key:"getFeatureById",value:function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null}},{key:"getFeatureByUid",value:function(t){var e=this.uidIndex_[t];return void 0!==e?e:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(t){var e=t.target,n=(0,A.sq)(e),i=e.getGeometry();if(i){var r=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var a=o.toString();this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new rL(rZ.CHANGEFEATURE,e))}},{key:"hasFeature",value:function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:(0,A.sq)(t) in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,tv.x)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(t,e,n){for(var i=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e,n),a=0,s=o.length;a<s;++a)!function(t,a){var s=o[t];r.forEachInExtent(s,function(t){return(0,M.r4)(t.extent,s)})||(++i.loadingExtentsCount_,i.dispatchEvent(new rL(rZ.FEATURESLOADSTART)),i.loader_.call(i,s,e,n,function(t){--i.loadingExtentsCount_,i.dispatchEvent(new rL(rZ.FEATURESLOADEND,void 0,t))},function(){--i.loadingExtentsCount_,i.dispatchEvent(new rL(rZ.FEATURESLOADERROR))}),r.insert(s,{extent:s.slice()}))}(a,0);this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),R((0,d.Z)(n.prototype),"refresh",this).call(this)}},{key:"removeLoadedExtent",value:function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,function(n){if((0,M.fS)(n.extent,t))return e=n,!0}),e&&n.remove(e)}},{key:"removeFeature",value:function(t){if(t){var e=(0,A.sq)(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}}},{key:"removeFeatureInternal",value:function(t){var e=(0,A.sq)(t),n=this.featureChangeKeys_[e];if(n){n.forEach($.bN),delete this.featureChangeKeys_[e];var i=t.getId();return void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new rL(rZ.REMOVEFEATURE,t)),t}}},{key:"removeFromIdIndex_",value:function(t){var e=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e}},{key:"setLoader",value:function(t){this.loader_=t}},{key:"setUrl",value:function(t){(0,D.h)(this.format_,7),this.url_=t,this.setLoader(rO(t,this.format_))}}]),n}(nH),rD=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createSource",value:function(t){return this.source=new rM({features:this.props.features,url:this.props.url,format:this.props.format,loader:this.props.loader,wrapX:this.props.wrapX}),this.ol=new rw(Object.assign(Object.assign({},t),{style:ib.getStyle(this.props.style),source:this.source})),[this.ol,this.source]}},{key:"refresh",value:function(t){R((0,d.Z)(i.prototype),"refresh",this).call(this,t),(null==t?void 0:t.url)!==this.props.url&&(this.source.setUrl(this.props.url),this.source.refresh())}}]),i}(iN),rF=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this,t)).image_=null,e}return(0,c.Z)(i,[{key:"getImage",value:function(){return this.image_?this.image_.getImage():null}},{key:"prepareFrame",value:function(t){var e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,i=t.viewState,r=i.resolution,o=this.getLayer().getSource(),a=t.viewHints,s=t.extent;if(void 0!==e.extent&&(s=(0,M.Ed)(s,(0,t2.dY)(e.extent,i.projection))),!a[t0.ANIMATING]&&!a[t0.INTERACTING]&&!(0,M.xb)(s)){if(o){var l=i.projection,u=o.getImage(s,r,n,l);u&&(this.loadImage(u)?this.image_=u:u.getState()===nR.EMPTY&&(this.image_=null))}else this.image_=null}return!!this.image_}},{key:"getData",value:function(t){var e=this.frameState;if(!e)return null;var n=this.getLayer(),i=(0,L.nn)(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!(0,M.b8)(r,i))return null;var o=this.image_.getExtent(),a=this.image_.getImage(),s=(0,M.dz)(o),l=Math.floor(a.width*((i[0]-o[0])/s));if(l<0||l>=a.width)return null;var u=(0,M.Cr)(o),c=Math.floor(a.height*((o[3]-i[1])/u));return c<0||c>=a.height?null:this.getImageData(a,l,c)}},{key:"renderFrame",value:function(t,e){var n=this.image_,i=n.getExtent(),r=n.getResolution(),o=n.getPixelRatio(),a=t.layerStatesArray[t.layerIndex],s=t.pixelRatio,l=t.viewState,u=l.center,c=s*r/(l.resolution*o),h=t.extent,f=l.resolution,d=l.rotation,v=Math.round((0,M.dz)(h)/f*s),g=Math.round((0,M.Cr)(h)/f*s);(0,L.qC)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,d,-v/2,-g/2),(0,L.nb)(this.inversePixelTransform,this.pixelTransform);var p=(0,L.BB)(this.pixelTransform);this.useContainer(e,p,this.getBackground(t));var y=this.context,_=y.canvas;_.width!=v||_.height!=g?(_.width=v,_.height=g):this.containerReused||y.clearRect(0,0,v,g);var m=!1,x=!0;if(a.extent){var R=(0,t2.dY)(a.extent,l.projection);(m=(x=(0,M.kK)(R,t.extent))&&!(0,M.r4)(R,t.extent))&&this.clipUnrotated(y,t,R)}var E=n.getImage(),k=(0,L.qC)(this.tempTransform,v/2,g/2,c,c,0,o*(i[0]-u[0])/r,o*(u[1]-i[3])/r);this.renderedResolution=r*s/o;var T=E.width*k[0],C=E.height*k[3];if(this.getLayer().getSource().getInterpolate()||(y.imageSmoothingEnabled=!1),this.preRender(y,t),x&&T>=.5&&C>=.5){var S,w=k[4],P=k[5],Z=a.opacity;1!==Z&&(S=y.globalAlpha,y.globalAlpha=Z),y.drawImage(E,0,0,+E.width,+E.height,w,P,T,C),1!==Z&&(y.globalAlpha=S)}return this.postRender(y,t),m&&y.restore(),y.imageSmoothingEnabled=!0,p!==_.style.transform&&(_.style.transform=p),this.container}}]),i}(nC),rN=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a){(0,u.Z)(this,i);var s,l=void 0!==a?nR.IDLE:nR.LOADED;return(s=n.call(this,t,e,r,l)).loader_=void 0!==a?a:null,s.canvas_=o,s.error_=null,s}return(0,c.Z)(i,[{key:"getError",value:function(){return this.error_}},{key:"handleLoad_",value:function(t){t?(this.error_=t,this.state=nR.ERROR):this.state=nR.LOADED,this.changed()}},{key:"load",value:function(){this.state==nR.IDLE&&(this.state=nR.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}},{key:"getImage",value:function(){return this.canvas_}}]),i}(nw),rB='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',rG=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),e=void 0!==(t=t||{}).attributions?t.attributions:[rB];var e,r=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",o=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";return n.call(this,{attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:r,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:o,wrapX:t.wrapX,zDirection:t.zDirection})}return(0,c.Z)(i)}(n4),rU=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),(r=n.call(this,t,e)).source=new rG,r.ol=new nU({source:r.source}),r.eventSources=[r.ol,r.source],r}return(0,c.Z)(i,[{key:"refresh",value:function(t){R((0,d.Z)(i.prototype),"refresh",this).call(this,t),this.ol.setProperties({label:"OpenStreetMap"})}}]),i}(n6);function rz(t,e){return(function t(e,n,i){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)n?i.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(e.nodeValue);else{var r;for(r=e.firstChild;r;r=r.nextSibling)t(r,n,i)}return i})(t,e,[]).join("")}function rX(t,e){return function(n,i){var r=t.call(void 0!==e?e:this,n,i);void 0!==r&&i[i.length-1].push(r)}}function rj(t,e,n){return function(i,r){var o=t.call(void 0!==n?n:this,i,r);if(void 0!==o){var a,s=r[r.length-1],l=void 0!==e?e:i.localName;l in s?a=s[l]:(a=[],s[l]=a),a.push(o)}}}function rW(t,e,n){return function(i,r){var o=t.call(void 0!==n?n:this,i,r);void 0!==o&&(r[r.length-1][void 0!==e?e:i.localName]=o)}}function rY(t,e,n){var i,r;for(i=0,n=void 0!==n?n:{},r=t.length;i<r;++i)n[t[i]]=e;return n}function rV(t,e,n,i,r){return i.push(t),!function(t,e,n,i){var r;for(r=e.firstElementChild;r;r=r.nextElementSibling){var o=t[r.namespaceURI];if(void 0!==o){var a=o[r.localName];void 0!==a&&a.call(i,r,n)}}}(e,n,i,r),i.pop()}var rH=function(){function t(){(0,u.Z)(this,t)}return(0,c.Z)(t,[{key:"read",value:function(t){if(!t)return null;if("string"==typeof t){var e=new DOMParser().parseFromString(t,"application/xml");return this.readFromDocument(e)}return"documentElement"in t?this.readFromDocument(t):this.readFromNode(t)}},{key:"readFromDocument",value:function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null}},{key:"readFromNode",value:function(t){}}]),t}();function rK(t){return t.getAttributeNS("http://www.w3.org/1999/xlink","href")}function rq(t){return function(t){var e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}(rz(t,!1))}function rJ(t){return rz(t,!1).trim()}var r$=[null,"http://www.opengis.net/ows/1.1"],rQ=rY(r$,{ServiceIdentification:rW(function(t,e){return rV({},oe,t,e)}),ServiceProvider:rW(function(t,e){return rV({},on,t,e)}),OperationsMetadata:rW(function(t,e){return rV({},r8,t,e)})}),r0=rY(r$,{DeliveryPoint:rW(rJ),City:rW(rJ),AdministrativeArea:rW(rJ),PostalCode:rW(rJ),Country:rW(rJ),ElectronicMailAddress:rW(rJ)}),r1=rY(r$,{Value:rj(function(t,e){return rJ(t)})}),r2=rY(r$,{AllowedValues:rW(function(t,e){return rV({},r1,t,e)})}),r3=rY(r$,{Phone:rW(function(t,e){return rV({},r7,t,e)}),Address:rW(function(t,e){return rV({},r0,t,e)})}),r5=rY(r$,{HTTP:rW(function(t,e){return rV({},r4,t,e)})}),r4=rY(r$,{Get:rj(function(t,e){var n=rK(t);if(n)return rV({href:n},r9,t,e)}),Post:void 0}),r6=rY(r$,{DCP:rW(function(t,e){return rV({},r5,t,e)})}),r8=rY(r$,{Operation:function(t,e){var n=t.getAttribute("name"),i=rV({},r6,t,e);i&&(e[e.length-1][n]=i)}}),r7=rY(r$,{Voice:rW(rJ),Facsimile:rW(rJ)}),r9=rY(r$,{Constraint:rj(function(t,e){var n=t.getAttribute("name");if(n)return rV({name:n},r2,t,e)})}),ot=rY(r$,{IndividualName:rW(rJ),PositionName:rW(rJ),ContactInfo:rW(function(t,e){return rV({},r3,t,e)})}),oe=rY(r$,{Abstract:rW(rJ),AccessConstraints:rW(rJ),Fees:rW(rJ),Title:rW(rJ),ServiceTypeVersion:rW(rJ),ServiceType:rW(rJ)}),on=rY(r$,{ProviderName:rW(rJ),ProviderSite:rW(rK),ServiceContact:rW(function(t,e){return rV({},ot,t,e)})}),oi=[null,"http://www.opengis.net/wmts/1.0"],or=[null,"http://www.opengis.net/ows/1.1"],oo=(rY(oi,{Contents:rW(function(t,e){return rV({},oo,t,e)})}),rY(oi,{Layer:rj(function(t,e){return rV({},oa,t,e)}),TileMatrixSet:rj(function(t,e){return rV({},od,t,e)})})),oa=rY(oi,{Style:rj(function(t,e){var n=rV({},os,t,e);if(n){var i="true"===t.getAttribute("isDefault");return n.isDefault=i,n}}),Format:rj(rJ),TileMatrixSetLink:rj(function(t,e){return rV({},ol,t,e)}),Dimension:rj(function(t,e){return rV({},oh,t,e)}),ResourceURL:rj(function(t,e){var n=t.getAttribute("format"),i=t.getAttribute("template"),r=t.getAttribute("resourceType"),o={};return n&&(o.format=n),i&&(o.template=i),r&&(o.resourceType=r),o})},rY(or,{Title:rW(rJ),Abstract:rW(rJ),WGS84BoundingBox:rW(og),Identifier:rW(rJ)})),os=rY(oi,{LegendURL:rj(function(t,e){var n={};return n.format=t.getAttribute("format"),n.href=rK(t),n})},rY(or,{Title:rW(rJ),Identifier:rW(rJ)})),ol=rY(oi,{TileMatrixSet:rW(rJ),TileMatrixSetLimits:rW(function(t,e){return rV([],ou,t,e)})}),ou=rY(oi,{TileMatrixLimits:rX(function(t,e){return rV({},oc,t,e)})}),oc=rY(oi,{TileMatrix:rW(rJ),MinTileRow:rW(rq),MaxTileRow:rW(rq),MinTileCol:rW(rq),MaxTileCol:rW(rq)}),oh=rY(oi,{Default:rW(rJ),Value:rj(rJ)},rY(or,{Identifier:rW(rJ)})),of=rY(or,{LowerCorner:rX(op),UpperCorner:rX(op)}),od=rY(oi,{WellKnownScaleSet:rW(rJ),TileMatrix:rj(function(t,e){return rV({},ov,t,e)})},rY(or,{SupportedCRS:rW(rJ),Identifier:rW(rJ),BoundingBox:rW(og)})),ov=rY(oi,{TopLeftCorner:rW(op),ScaleDenominator:rW(function(t){return function(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}(rz(t,!1))}),TileWidth:rW(rq),TileHeight:rW(rq),MatrixWidth:rW(rq),MatrixHeight:rW(rq)},rY(or,{Identifier:rW(rJ)}));function og(t,e){var n=rV([],of,t,e);if(2==n.length)return(0,M.hI)(n)}function op(t,e){var n=rJ(t).split(/\s+/);if(n&&2==n.length){var i=+n[0],r=+n[1];if(!(isNaN(i)||isNaN(r)))return[i,r]}}var oy=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r,o,a,s,l){(0,u.Z)(this,i);var c,h=t.getExtent(),f=e.getExtent(),d=f?(0,M.Ed)(r,f):r,v=nL(t,e,(0,M.qg)(d),o),g=new nI(t,e,d,h,.5*v,o),p=s(g.calculateSourceExtent(),v,a),y=p?nR.IDLE:nR.EMPTY,_=p?p.getPixelRatio():1;return(c=n.call(this,r,o,_,y)).targetProj_=e,c.maxSourceExtent_=h,c.triangulation_=g,c.targetResolution_=o,c.targetExtent_=r,c.sourceImage_=p,c.sourcePixelRatio_=_,c.interpolate_=l,c.canvas_=null,c.sourceListenerKey_=null,c}return(0,c.Z)(i,[{key:"disposeInternal",value:function(){this.state==nR.LOADING&&this.unlistenSource_(),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}},{key:"getImage",value:function(){return this.canvas_}},{key:"getProjection",value:function(){return this.targetProj_}},{key:"reproject_",value:function(){var t=this.sourceImage_.getState();if(t==nR.LOADED){var e=(0,M.dz)(this.targetExtent_)/this.targetResolution_,n=(0,M.Cr)(this.targetExtent_)/this.targetResolution_;this.canvas_=nD(e,n,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_)}this.state=t,this.changed()}},{key:"load",value:function(){if(this.state==nR.IDLE){this.state=nR.LOADING,this.changed();var t=this.sourceImage_.getState();t==nR.LOADED||t==nR.ERROR?this.reproject_():(this.sourceListenerKey_=(0,$.oL)(this.sourceImage_,q.Z.CHANGE,function(t){var e=this.sourceImage_.getState();(e==nR.LOADED||e==nR.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}},{key:"unlistenSource_",value:function(){(0,$.bN)(this.sourceListenerKey_),this.sourceListenerKey_=null}}]),i}(nw);function o_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var om={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},ox=function(t){(0,h.Z)(n,t);var e=o_(n);function n(t,i){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).image=i,r}return(0,c.Z)(n)}(S.ZP);function oR(t,e,n,i,r,o,a){var s,l,u=(n-e)/i;if(1===u)s=e;else if(2===u)s=e,l=r;else if(0!==u){for(var c=t[e],h=t[e+1],f=0,d=[0],v=e+i;v<n;v+=i){var g=t[v],p=t[v+1];f+=Math.sqrt((g-c)*(g-c)+(p-h)*(p-h)),d.push(f),c=g,h=p}var y=r*f,_=(0,t4.ry)(d,y);_<0?(l=(y-d[-_-2])/(d[-_-1]-d[-_-2]),s=e+(-_-2)*i):s=e+_*i}a=a>1?a:2,o=o||Array(a);for(var m=0;m<a;++m)o[m]=void 0===s?NaN:void 0===l?t[s+m]:(0,F.t7)(t[s+m],t[s+i+m],l);return o}function oE(t,e,n,i,r,o){if(n==e)return null;if(r<t[e+i-1])return o?((a=t.slice(e,e+i))[i-1]=r,a):null;if(t[n-1]<r)return o?((a=t.slice(n-i,n))[i-1]=r,a):null;if(r==t[e+i-1])return t.slice(e,e+i);for(var a,s=e/i,l=n/i;s<l;){var u=s+l>>1;r<t[(u+1)*i-1]?l=u:s=u+1}var c=t[s*i-1];if(r==c)return t.slice((s-1)*i,(s-1)*i+i);var h=(r-c)/(t[(s+1)*i-1]-c);a=[];for(var f=0;f<i-1;++f)a.push((0,F.t7)(t[(s-1)*i+f],t[s*i+f],h));return a.push(r),a}n(3270);var ok=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),(r=n.call(this)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r}return(0,c.Z)(i,[{key:"appendCoordinate",value:function(t){this.flatCoordinates?(0,t4.l7)(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}},{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){return i<(0,M.qf)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(es(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),eu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,i))}},{key:"forEachSegment",value:function(t){return eC(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinateAtM",value:function(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,oE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}},{key:"getCoordinates",value:function(){return eg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(t,e){return oR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}},{key:"getLength",value:function(){return ro(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=ef(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,"XY")}},{key:"getType",value:function(){return"LineString"}},{key:"intersectsExtent",value:function(t){return eS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,eh.Sg)(this.flatCoordinates,0,t,this.stride),this.changed()}}]),i}(eo.ZP);function oT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}new iC({color:"rgba(0,0,0,0.2)"});var oC=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;if((0,u.Z)(this,i),!(r=n.call(this,t,e)).context)throw Error("A style property must be part of a style");return r.ol=r.create(t),r}return(0,c.Z)(i,[{key:"create",value:function(t){throw Error("RBaseStyle is an abstract class")}},{key:"refresh",value:function(t){if(y("refreshStyle",this),t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return oT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oT(t,e)}}(t))){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.classProps);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.charAt(0).toUpperCase()+i.substring(1);(t&&t[i])!==this.props[i]&&(this.ol["set"+r]?this.ol["set"+r](this.props[i]):console.error("Underlying OpenLayers object does not support updating of ".concat(i," after object creation. ")+"If you are using an anonymous constant array or object, consider assigning its value to a constant and then passing the constant or use React.useMemo() to avoid this warning and improve performance."))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"set",value:function(t){}},{key:"componentDidMount",value:function(){this.set(this.ol)}},{key:"componentDidUpdate",value:function(t,e,n){t!==this.props&&this.refresh(t)}},{key:"componentWillUnmount",value:function(){this.set(null)}},{key:"render",value:function(){return null}}]),i}(v.PureComponent);oC.contextType=g,oC.classProps=[],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){return this.classProps=i.classProps,new iC(t)}},{key:"set",value:function(t){if(this.context.style.setStroke)return this.context.style.setStroke(t);throw Error("Parent element does not support a stroke")}}]),i}(oC).classProps=["color","width","lineCap","lineJoin"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){return this.classProps=i.classProps,new iT(t)}},{key:"set",value:function(t){if(this.context.style.setFill)return this.context.style.setFill(t);throw Error("Parent element does not support a fill")}}]),i}(oC).classProps=["color"];var oS=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){throw Error("RImage is an abstract class")}},{key:"set",value:function(t){if(!this.context.style.setImage)throw Error("Parent element does not support an image");this.context.style.setImage(t)}}]),i}(oC);oS.classProps=["opacity","rotateWithView","rotation","scale","displacement"];var ow=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){throw Error("RImage is an abstract class")}},{key:"setStroke",value:function(t){this.stroke=t,this.ol=this.create(this.props),R((0,d.Z)(i.prototype),"set",this).call(this,this.ol)}},{key:"setFill",value:function(t){this.fill=t,this.ol=this.create(this.props),R((0,d.Z)(i.prototype),"set",this).call(this,this.ol)}},{key:"render",value:function(){return v.createElement("div",{className:"_rlayers_RStyle"},v.createElement(g.Provider,{value:Object.assign(Object.assign({},this.context),{style:this})},this.props.children))}}]),i}(oS);ow.classProps=oS.classProps.concat(["radius"]),function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){return this.classProps=i.classProps,new ik(Object.assign(Object.assign({},t),{stroke:this.stroke,fill:this.fill}))}}]),i}(ow).classProps=ow.classProps.concat(["radius"]),function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){return this.classProps=i.classProps,new iE(Object.assign(Object.assign({},t),{stroke:this.stroke,fill:this.fill}))}}]),i}(ow).classProps=ow.classProps.concat(["radius1","radius2","points","angle"]),function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){return this.classProps=i.classProps,new ij(t)}},{key:"set",value:function(t){if(!this.context.style.setText)throw Error("Parent element does not support a text");this.context.style.setText(t)}},{key:"render",value:function(){return v.createElement("div",{className:"_rlayers_RStyle_RText"},v.createElement(g.Provider,{value:Object.assign(Object.assign({},this.context),{style:this.ol})},this.props.children))}}]),i}(oC).classProps=["text","font","offsetY","offsetX","overflow","scale","rotation","textAlign","padding","placement","textBaseline"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){this.classProps=i.classProps;var e=this.context.style;if(!e.setBackgroundFill||!e.setBackgroundStroke)throw Error("Parent element does not support a background");return{setFill:e.setBackgroundFill.bind(e),setStroke:e.setBackgroundStroke.bind(e)}}},{key:"render",value:function(){return v.createElement("div",{className:"_rlayers_RStyle_RBackground"},v.createElement(g.Provider,{value:Object.assign(Object.assign({},this.context),{style:this.ol})},this.props.children))}}]),i}(oC).classProps=[];var oP=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"create",value:function(t){return this.classProps=i.classProps,new iX(t)}}]),i}(oS);oP.classProps=oS.classProps.concat(["anchor","anchorXUnits","anchorYUnits","color","crossOrigin","img","offset","offsetOrigin","size","imgSize","src"]),n(6576);var oZ=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function oI(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!td.ME},e);for(var n=oZ.length,i=0;i<n;++i)try{var r=t.getContext(oZ[i],e);if(r)return r}catch(t){}return null}var ob={STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048},oO=function(){function t(e,n){(0,u.Z)(this,t),this.array=null,this.type=e,(0,D.h)(34962===e||34963===e,62),this.usage=void 0!==n?n:ob.STATIC_DRAW}return(0,c.Z)(t,[{key:"ofSize",value:function(t){this.array=new(oA(this.type))(t)}},{key:"fromArray",value:function(t){this.array=oA(this.type).from(t)}},{key:"fromArrayBuffer",value:function(t){this.array=new(oA(this.type))(t)}},{key:"getType",value:function(){return this.type}},{key:"getArray",value:function(){return this.array}},{key:"getUsage",value:function(){return this.usage}},{key:"getSize",value:function(){return this.array?this.array.length:0}}]),t}();function oA(t){switch(t){case 34962:default:return Float32Array;case 34963:return Uint32Array}}var oL={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},oM=function(){function t(e){var n=this;(0,u.Z)(this,t),this.gl_=e.webGlContext;var i=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=i.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=i.createFramebuffer();var r=i.createShader(i.VERTEX_SHADER);i.shaderSource(r,e.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),i.compileShader(r);var o=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(o,e.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),i.compileShader(o),this.renderTargetProgram_=i.createProgram(),i.attachShader(this.renderTargetProgram_,r),i.attachShader(this.renderTargetProgram_,o),i.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),i.bufferData(i.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),i.STATIC_DRAW),this.renderTargetAttribLocation_=i.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(t){n.uniforms_.push({value:e.uniforms[t],location:i.getUniformLocation(n.renderTargetProgram_,t)})})}return(0,c.Z)(t,[{key:"getGL",value:function(){return this.gl_}},{key:"init",value:function(t){var e=this.getGL(),n=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;var i=e.RGBA,r=e.RGBA,o=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,0,i,n[0],n[1],0,r,o,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}}},{key:"apply",value:function(t,e,n,i){var r=this.getGL(),o=t.size;if(r.bindFramebuffer(r.FRAMEBUFFER,e?e.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),!e){var a=(0,A.sq)(r.canvas);if(!t.renderTargets[a]){var s=r.getContextAttributes();s&&s.preserveDrawingBuffer&&(r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)),t.renderTargets[a]=!0}}r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),r.uniform1i(this.renderTargetTextureLocation_,0);var l=t.layerStatesArray[t.layerIndex].opacity;r.uniform1f(this.renderTargetOpacityLocation_,l),this.applyUniforms(t),n&&n(r,t),r.drawArrays(r.TRIANGLES,0,6),i&&i(r,t)}},{key:"getFrameBuffer",value:function(){return this.frameBuffer_}},{key:"applyUniforms",value:function(t){var e,n=this.getGL(),i=1;this.uniforms_.forEach(function(r){if((e="function"==typeof r.value?r.value(t):r.value)instanceof HTMLCanvasElement||e instanceof ImageData)r.texture||(r.texture=n.createTexture()),n.activeTexture(n["TEXTURE".concat(i)]),n.bindTexture(n.TEXTURE_2D,r.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),e instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,e.width,e.height,0,n.UNSIGNED_BYTE,new Uint8Array(e.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.uniform1i(r.location,i++);else if(Array.isArray(e))switch(e.length){case 2:n.uniform2f(r.location,e[0],e[1]);return;case 3:n.uniform3f(r.location,e[0],e[1],e[2]);return;case 4:n.uniform4f(r.location,e[0],e[1],e[2],e[3]);return;default:return}else"number"==typeof e&&n.uniform1f(r.location,e)})}}]),t}();function oD(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function oF(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}var oN={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",SIZE_PX:"u_sizePx",PIXEL_RATIO:"u_pixelRatio"},oB={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},oG={},oU=0,oz=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),r=n.call(this),t=t||{},r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind((0,E.Z)(r)),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind((0,E.Z)(r)),r.canvasCacheKey_=t.canvasCacheKey?"shared/"+t.canvasCacheKey:(e="unique/"+oU,oU+=1,e),r.canvas_=function(t){var e=oG[t];if(!e){var n=document.createElement("canvas");n.style.position="absolute",n.style.left="0",e={users:0,canvas:n},oG[t]=e}return e.users+=1,e.canvas}(r.canvasCacheKey_),r.gl_=oI(r.canvas_),r.bufferCache_={},r.extensionCache_={},r.currentProgram_=null,r.canvas_.addEventListener(oL.LOST,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(oL.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=(0,L.Ue)(),r.offsetScaleMatrix_=(0,L.Ue)(),r.tmpMat4_=oD(),r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],t.uniforms&&r.setUniforms(t.uniforms);var e,r,o=r.getGL();return r.postProcessPasses_=t.postProcesses?t.postProcesses.map(function(t){return new oM({webGlContext:o,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})}):[new oM({webGlContext:o})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return(0,c.Z)(i,[{key:"setUniforms",value:function(t){for(var e in this.uniforms_=[],t)this.uniforms_.push({name:e,value:t[e]});this.uniformLocations_={}}},{key:"canvasCacheKeyMatches",value:function(t){return this.canvasCacheKey_==="shared/"+t}},{key:"getExtension",value:function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e}},{key:"bindBuffer",value:function(t){var e=this.getGL(),n=(0,A.sq)(t),i=this.bufferCache_[n];i||(i={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[n]=i),e.bindBuffer(t.getType(),i.webGlBuffer)}},{key:"flushBufferData",value:function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())}},{key:"deleteBuffer",value:function(t){var e=this.getGL(),n=(0,A.sq)(t),i=this.bufferCache_[n];i&&!e.isContextLost()&&e.deleteBuffer(i.webGlBuffer),delete this.bufferCache_[n]}},{key:"disposeInternal",value:function(){this.canvas_.removeEventListener(oL.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(oL.RESTORED,this.boundHandleWebGLContextRestored_),function(t){var e=oG[t];if(e&&(e.users-=1,!(e.users>0))){var n=oI(e.canvas).getExtension("WEBGL_lose_context");n&&n.loseContext(),delete oG[t]}}(this.canvasCacheKey_),delete this.gl_,delete this.canvas_}},{key:"prepareDraw",value:function(t,e){var n=this.getGL(),i=this.getCanvas(),r=t.size,o=t.pixelRatio;i.width=r[0]*o,i.height=r[1]*o,i.style.width=r[0]+"px",i.style.height=r[1]+"px";for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(t);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,e?n.ZERO:n.ONE_MINUS_SRC_ALPHA)}},{key:"prepareDrawToRenderTarget",value:function(t,e,n){var i=this.getGL(),r=e.getSize();i.bindFramebuffer(i.FRAMEBUFFER,e.getFramebuffer()),i.viewport(0,0,r[0],r[1]),i.bindTexture(i.TEXTURE_2D,e.getTexture()),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA)}},{key:"drawElements",value:function(t,e){var n=this.getGL();this.getExtension("OES_element_index_uint");var i=n.UNSIGNED_INT;n.drawElements(n.TRIANGLES,e-t,i,4*t)}},{key:"finalizeDraw",value:function(t,e,n){for(var i=0,r=this.postProcessPasses_.length;i<r;i++)i===r-1?this.postProcessPasses_[i].apply(t,null,e,n):this.postProcessPasses_[i].apply(t,this.postProcessPasses_[i+1])}},{key:"getCanvas",value:function(){return this.canvas_}},{key:"getGL",value:function(){return this.gl_}},{key:"applyFrameState",value:function(t){var e=t.size,n=t.viewState.rotation,i=t.pixelRatio,r=(0,L.mc)(this.offsetScaleMatrix_);(0,L.bA)(r,2/e[0],2/e[1]);var o=(0,L.mc)(this.offsetRotateMatrix_);0!==n&&(0,L.U1)(o,-n),this.setUniformMatrixValue(oN.OFFSET_SCALE_MATRIX,oF(this.tmpMat4_,r)),this.setUniformMatrixValue(oN.OFFSET_ROTATION_MATRIX,oF(this.tmpMat4_,o)),this.setUniformFloatValue(oN.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(oN.ZOOM,t.viewState.zoom),this.setUniformFloatValue(oN.RESOLUTION,t.viewState.resolution),this.setUniformFloatValue(oN.PIXEL_RATIO,i),this.setUniformFloatVec2(oN.SIZE_PX,[e[0],e[1]])}},{key:"applyUniforms",value:function(t){var e,n=this,i=this.getGL(),r=0;this.uniforms_.forEach(function(o){if((e="function"==typeof o.value?o.value(t):o.value)instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData)o.texture||(o.prevValue=void 0,o.texture=i.createTexture()),i.activeTexture(i["TEXTURE".concat(r)]),i.bindTexture(i.TEXTURE_2D,o.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),e instanceof HTMLImageElement&&!e.complete||o.prevValue===e||(o.prevValue=e,i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)),i.uniform1i(n.getUniformLocation(o.name),r++);else if(Array.isArray(e)&&6===e.length)n.setUniformMatrixValue(o.name,oF(n.tmpMat4_,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:i.uniform2f(n.getUniformLocation(o.name),e[0],e[1]);return;case 3:i.uniform3f(n.getUniformLocation(o.name),e[0],e[1],e[2]);return;case 4:i.uniform4f(n.getUniformLocation(o.name),e[0],e[1],e[2],e[3]);return;default:return}else"number"==typeof e&&i.uniform1f(n.getUniformLocation(o.name),e)})}},{key:"useProgram",value:function(t,e){this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},this.applyFrameState(e),this.applyUniforms(e)}},{key:"compileShader",value:function(t,e){var n=this.getGL(),i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}},{key:"getProgram",value:function(t,e){var n=this.getGL(),i=this.compileShader(t,n.FRAGMENT_SHADER),r=this.compileShader(e,n.VERTEX_SHADER),o=n.createProgram();if(n.attachShader(o,i),n.attachShader(o,r),n.linkProgram(o),!n.getShaderParameter(i,n.COMPILE_STATUS))throw Error("Fragment shader compilation failed: ".concat(n.getShaderInfoLog(i)));if(n.deleteShader(i),!n.getShaderParameter(r,n.COMPILE_STATUS))throw Error("Vertex shader compilation failed: ".concat(n.getShaderInfoLog(r)));if(n.deleteShader(r),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("GL program linking failed: ".concat(n.getShaderInfoLog(r)));return o}},{key:"getUniformLocation",value:function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]}},{key:"getAttributeLocation",value:function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]}},{key:"makeProjectionTransform",value:function(t,e){var n=t.size,i=t.viewState.rotation,r=t.viewState.resolution,o=t.viewState.center;return(0,L.mc)(e),(0,L.qC)(e,0,0,2/(r*n[0]),2/(r*n[1]),-i,-o[0],-o[1]),e}},{key:"setUniformFloatValue",value:function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)}},{key:"setUniformFloatVec2",value:function(t,e){this.getGL().uniform2fv(this.getUniformLocation(t),e)}},{key:"setUniformFloatVec4",value:function(t,e){this.getGL().uniform4fv(this.getUniformLocation(t),e)}},{key:"setUniformMatrixValue",value:function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)}},{key:"enableAttributeArray_",value:function(t,e,n,i,r){var o=this.getAttributeLocation(t);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,e,n,!1,i,r))}},{key:"enableAttributes",value:function(t){for(var e=function(t){for(var e=0,n=0;n<t.length;n++){var i=t[n];e+=i.size*oX(i.type)}return e}(t),n=0,i=0;i<t.length;i++){var r=t[i];this.enableAttributeArray_(r.name,r.size,r.type||5126,e,n),n+=r.size*oX(r.type)}}},{key:"handleWebGLContextLost",value:function(){(0,tv.Z)(this.bufferCache_),this.currentProgram_=null}},{key:"handleWebGLContextRestored",value:function(){}},{key:"createTexture",value:function(t,e,n){var i=this.getGL();n=n||i.createTexture();var r=i.RGBA,o=i.RGBA,a=i.UNSIGNED_BYTE;return i.bindTexture(i.TEXTURE_2D,n),e?i.texImage2D(i.TEXTURE_2D,0,r,o,a,e):i.texImage2D(i.TEXTURE_2D,0,r,t[0],t[1],0,o,a,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n}}]),i}(b.Z);function oX(t){switch(t){case oB.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case oB.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case oB.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case oB.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var oj=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),r=n.call(this,t),e=e||{},r.inversePixelTransform_=(0,L.Ue)(),r.pixelContext_=null,r.postProcesses_=e.postProcesses,r.uniforms_=e.uniforms,r.helper,t.addChangeListener(H.MAP,r.removeHelper.bind((0,E.Z)(r))),r.dispatchPreComposeEvent=r.dispatchPreComposeEvent.bind((0,E.Z)(r)),r.dispatchPostComposeEvent=r.dispatchPostComposeEvent.bind((0,E.Z)(r)),r}return(0,c.Z)(i,[{key:"dispatchPreComposeEvent",value:function(t,e){var n=this.getLayer();if(n.hasListener(J.PRECOMPOSE)){var i=new to(J.PRECOMPOSE,void 0,e,t);n.dispatchEvent(i)}}},{key:"dispatchPostComposeEvent",value:function(t,e){var n=this.getLayer();if(n.hasListener(J.POSTCOMPOSE)){var i=new to(J.POSTCOMPOSE,void 0,e,t);n.dispatchEvent(i)}}},{key:"reset",value:function(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}},{key:"removeHelper",value:function(){this.helper&&(this.helper.dispose(),delete this.helper)}},{key:"prepareFrame",value:function(t){if(this.getLayer().getRenderSource()){for(var e,n=!0,r=-1,o=0,a=t.layerStatesArray.length;o<a;o++){var s=t.layerStatesArray[o].layer,l=s.getRenderer();if(!(l instanceof i)){n=!0;continue}var u=s.getClassName();if((n||u!==e)&&(r+=1,n=!1),e=u,l===this)break}var c="map/"+t.mapId+"/group/"+r;this.helper&&this.helper.canvasCacheKeyMatches(c)||(this.removeHelper(),this.helper=new oz({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:c}),e&&(this.helper.getCanvas().className=e),this.afterHelperCreated())}return this.prepareFrameInternal(t)}},{key:"afterHelperCreated",value:function(){}},{key:"prepareFrameInternal",value:function(t){return!0}},{key:"disposeInternal",value:function(){this.removeHelper(),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}},{key:"dispatchRenderEvent_",value:function(t,e,n){var i=this.getLayer();if(i.hasListener(t)){(0,L.qC)(this.inversePixelTransform_,0,0,n.pixelRatio,-n.pixelRatio,0,0,-n.size[1]);var r=new to(t,this.inversePixelTransform_,n,e);i.dispatchEvent(r)}}},{key:"preRender",value:function(t,e){this.dispatchRenderEvent_(J.PRERENDER,t,e)}},{key:"postRender",value:function(t,e){this.dispatchRenderEvent_(J.POSTRENDER,t,e)}}]),i}(nE),oW=new Uint8Array(4),oY=function(){function t(e,n){(0,u.Z)(this,t),this.helper_=e;var i=e.getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.size_=n||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return(0,c.Z)(t,[{key:"setSize",value:function(t){(0,t4.fS)(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())}},{key:"getSize",value:function(){return this.size_}},{key:"clearCachedData",value:function(){this.dataCacheDirty_=!0}},{key:"readAll",value:function(){if(this.dataCacheDirty_){var t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}},{key:"readPixel",value:function(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return oW[0]=0,oW[1]=0,oW[2]=0,oW[3]=0,oW;this.readAll();var n=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return oW[0]=this.data_[4*n],oW[1]=this.data_[4*n+1],oW[2]=this.data_[4*n+2],oW[3]=this.data_[4*n+3],oW}},{key:"getTexture",value:function(){return this.texture_}},{key:"getFramebuffer",value:function(){return this.framebuffer_}},{key:"updateSize_",value:function(){var t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)}}]),t}(),oV={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};n(9187);var oH=n(8764).lW,oK=n(9499),oq={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},oJ={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},o$=[];function oQ(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement?t:null}function o0(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t instanceof DataView?t:null}var o1=null,o2=[256,256],o3=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=t$.IDLE;return(e=n.call(this,t.tileCoord,r,{transition:t.transition,interpolate:t.interpolate})).loader_=t.loader,e.data_=null,e.error_=null,e.size_=t.size||null,e}return(0,c.Z)(i,[{key:"getSize",value:function(){if(this.size_)return this.size_;var t=oQ(this.data_);return t?[t.width,t.height]:o2}},{key:"getData",value:function(){return this.data_}},{key:"getError",value:function(){return this.error_}},{key:"load",value:function(){if(this.state===t$.IDLE||this.state===t$.ERROR){this.state=t$.LOADING,this.changed();var t=this;this.loader_().then(function(e){t.data_=e,t.state=t$.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=t$.ERROR,t.changed()})}}}]),i}(nS),o5=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),(e=n.call(this,{tileCoord:t.tileCoord,loader:function(){return Promise.resolve(new Uint8Array(4))},interpolate:t.interpolate,transition:t.transition})).pixelRatio_=t.pixelRatio,e.gutter_=t.gutter,e.reprojData_=null,e.reprojError_=null,e.reprojSize_=void 0,e.sourceTileGrid_=t.sourceTileGrid,e.targetTileGrid_=t.targetTileGrid,e.wrappedTileCoord_=t.wrappedTileCoord||t.tileCoord,e.sourceTiles_=[],e.sourcesListenerKeys_=null,e.sourceZ_=0;var e,r=e.targetTileGrid_.getTileCoordExtent(e.wrappedTileCoord_),o=e.targetTileGrid_.getExtent(),a=e.sourceTileGrid_.getExtent(),s=o?(0,M.Ed)(r,o):r;if(0===(0,M.bg)(s))return e.state=t$.EMPTY,(0,f.Z)(e);var l=t.sourceProj,c=l.getExtent();c&&(a=a?(0,M.Ed)(a,c):c);var h=e.targetTileGrid_.getResolution(e.wrappedTileCoord_[0]),d=t.targetProj,v=nM(l,d,s,h);if(!isFinite(v)||v<=0)return e.state=t$.EMPTY,(0,f.Z)(e);var g=void 0!==t.errorThreshold?t.errorThreshold:.5;if(e.triangulation_=new nI(l,d,s,a,v*g,h),0===e.triangulation_.getTriangles().length)return e.state=t$.EMPTY,(0,f.Z)(e);e.sourceZ_=e.sourceTileGrid_.getZForResolution(v);var p=e.triangulation_.calculateSourceExtent();if(a&&(l.canWrapX()?(p[1]=(0,F.uZ)(p[1],a[1],a[3]),p[3]=(0,F.uZ)(p[3],a[1],a[3])):p=(0,M.Ed)(p,a)),(0,M.bg)(p)){for(var y=e.sourceTileGrid_.getTileRangeForExtentAndZ(p,e.sourceZ_),_=t.getTileFunction,m=y.minX;m<=y.maxX;m++)for(var x=y.minY;x<=y.maxY;x++){var R=_(e.sourceZ_,m,x,e.pixelRatio_);R&&e.sourceTiles_.push(R)}0===e.sourceTiles_.length&&(e.state=t$.EMPTY)}else e.state=t$.EMPTY;return e}return(0,c.Z)(i,[{key:"getSize",value:function(){return this.reprojSize_}},{key:"getData",value:function(){return this.reprojData_}},{key:"getError",value:function(){return this.reprojError_}},{key:"reproject_",value:function(){var t=this,e=[];if(this.sourceTiles_.forEach(function(n){if(n&&n.getState()===t$.LOADED){var i,r,o,a,s,l=n.getSize(),u=t.gutter_,c=o0(n.getData());c?s=c:(i=oQ(n.getData()),o1||(o1=tg(i.width,i.height,void 0,{willReadFrequently:!0})),r=o1.canvas,o=i.width,r.width!==o&&(r.width=o),a=i.height,r.height!==a&&(r.height=a),o1.drawImage(i,o,a),s=o1.getImageData(0,0,o,a).data);var h=[l[0]+2*u,l[1]+2*u],f=s instanceof Float32Array,d=h[0]*h[1],v=f?Float32Array:Uint8Array,g=new v(s.buffer),p=v.BYTES_PER_ELEMENT,y=p*g.length/d,_=g.byteLength/h[1],m=Math.floor(_/p/h[0]),x=d*m,R=g;if(g.length!==x){R=new v(x);for(var E=0,k=0,T=h[0]*m,C=0;C<h[1];++C){for(var S=0;S<T;++S)R[E++]=g[k+S];k+=_/p}}e.push({extent:t.sourceTileGrid_.getTileCoordExtent(n.tileCoord),data:new Uint8Array(R.buffer),dataType:v,bytesPerPixel:y,pixelSize:h})}}),this.sourceTiles_.length=0,0===e.length)this.state=t$.ERROR;else{for(var n,i,r=this.wrappedTileCoord_[0],o=this.targetTileGrid_.getTileSize(r),a="number"==typeof o?o:o[0],s="number"==typeof o?o:o[1],l=this.targetTileGrid_.getResolution(r),u=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),h=e[0].bytesPerPixel,f=Math.ceil(h/3)-1;f>=0;--f){for(var d=[],v=0,g=e.length;v<g;++v){for(var p=e[v],y=p.data,_=p.pixelSize,m=_[0],x=_[1],R=tg(m,x,nb),E=R.createImageData(m,x),k=E.data,T=3*f,C=0,S=k.length;C<S;C+=4)k[C]=y[T],k[C+1]=y[T+1],k[C+2]=y[T+2],k[C+3]=255,T+=h;R.putImageData(E,0,0),d.push({extent:p.extent,image:R.canvas})}for(var w=nD(a,s,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),l,c,this.triangulation_,d,this.gutter_,!1,!1),P=0,Z=d.length;P<Z;++P){var I=d[P].image.getContext("2d");tp(I),nb.push(I.canvas)}var b=w.getContext("2d"),O=b.getImageData(0,0,w.width,w.height);tp(b),nb.push(w),n||(i=new Uint8Array(h*O.width*O.height),n=new e[0].dataType(i.buffer));for(var A=O.data,L=3*f,M=0,D=A.length;M<D;M+=4)255===A[M+3]?(i[L]=A[M],i[L+1]=A[M+1],i[L+2]=A[M+2]):(i[L]=0,i[L+1]=0,i[L+2]=0),L+=h}this.reprojData_=n,this.reprojSize_=[Math.round(a*this.pixelRatio_),Math.round(s*this.pixelRatio_)],this.state=t$.LOADED}this.changed()}},{key:"load",value:function(){var t=this;if(this.state===t$.IDLE||this.state===t$.ERROR){this.state=t$.LOADING,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n){var i=n.getState();if(i===t$.IDLE||i===t$.LOADING){e++;var r=(0,$.oL)(n,q.Z.CHANGE,function(){var t=n.getState();(t==t$.LOADED||t==t$.ERROR||t==t$.EMPTY)&&((0,$.bN)(r),0==--e&&(this.unlistenSources_(),this.reproject_()))},t);t.sourcesListenerKeys_.push(r)}}),0===e?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t){t.getState()==t$.IDLE&&t.load()})}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach($.bN),this.sourcesListenerKeys_=null}}]),i}(o3);function o4(t,e,n){var i=n?t.LINEAR:t.NEAREST;t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i)}function o6(t,e,n,i,r,o){var a,s,l,u=t.getGL();n instanceof Float32Array?(a=u.FLOAT,t.getExtension("OES_texture_float"),s=null!==t.getExtension("OES_texture_float_linear")):(a=u.UNSIGNED_BYTE,s=!0),o4(u,e,o&&s);var c=n.byteLength/i[1],h=1;switch(c%8==0?h=8:c%4==0?h=4:c%2==0&&(h=2),r){case 1:l=u.LUMINANCE;break;case 2:l=u.LUMINANCE_ALPHA;break;case 3:l=u.RGB;break;case 4:l=u.RGBA;break;default:throw Error("Unsupported number of bands: ".concat(r))}var f=u.getParameter(u.UNPACK_ALIGNMENT);u.pixelStorei(u.UNPACK_ALIGNMENT,h),u.texImage2D(u.TEXTURE_2D,0,l,i[0],i[1],0,l,a,n),u.pixelStorei(u.UNPACK_ALIGNMENT,f)}var o8=null,o7=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i),(e=n.call(this)).tile,e.textures=[],e.handleTileChange_=e.handleTileChange_.bind((0,E.Z)(e)),e.renderSize_=nv(t.grid.getTileSize(t.tile.tileCoord[0])),e.gutter_=t.gutter||0,e.bandCount=NaN,e.helper_=t.helper;var e,r=new oO(34962,35044);return r.fromArray([0,1,1,1,1,0,0,0]),e.helper_.flushBufferData(r),e.coords=r,e.setTile(t.tile),e}return(0,c.Z)(i,[{key:"setTile",value:function(t){if(t!==this.tile){if(this.tile&&this.tile.removeEventListener(q.Z.CHANGE,this.handleTileChange_),this.tile=t,this.textures.length=0,this.loaded=t.getState()===t$.LOADED,this.loaded)this.uploadTile_();else{if(t instanceof nZ){var e=t.getImage();e instanceof Image&&!e.crossOrigin&&(e.crossOrigin="anonymous")}t.addEventListener(q.Z.CHANGE,this.handleTileChange_)}}}},{key:"uploadTile_",value:function(){var t,e=this.helper_,n=e.getGL(),i=this.tile,r=oQ(t=i instanceof nZ||i instanceof nF?i.getImage():i.getData());if(r){var o=n.createTexture();this.textures.push(o),this.bandCount=4,o4(n,o,i.interpolate),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r);return}t=o0(t);var a=i.getSize(),s=[a[0]+2*this.gutter_,a[1]+2*this.gutter_],l=t instanceof Float32Array,u=s[0]*s[1],c=l?Float32Array:Uint8Array,h=c.BYTES_PER_ELEMENT,f=t.byteLength/s[1];this.bandCount=Math.floor(f/h/s[0]);var d=Math.ceil(this.bandCount/4);if(1===d){var v=n.createTexture();this.textures.push(v),o6(e,v,t,s,this.bandCount,i.interpolate);return}for(var g=Array(d),p=0;p<d;++p){var y=n.createTexture();this.textures.push(y);var _=p<d-1?4:(this.bandCount-1)%4+1;g[p]=new c(u*_)}for(var m=0,x=0,R=s[0]*this.bandCount,E=0;E<s[1];++E){for(var k=0;k<R;++k){var T=t[x+k],C=Math.floor(m/this.bandCount),S=k%this.bandCount,w=g[Math.floor(S/4)],P=w.length/u;w[C*P+S%4]=T,++m}x+=f/h}for(var Z=0;Z<d;++Z){var I=this.textures[Z],b=g[Z],O=b.length/u;o6(e,I,b,s,O,i.interpolate)}}},{key:"handleTileChange_",value:function(){this.tile.getState()===t$.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(q.Z.CHANGE))}},{key:"disposeInternal",value:function(){var t=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var e=0;e<this.textures.length;++e)t.deleteTexture(this.textures[e]);this.tile.removeEventListener(q.Z.CHANGE,this.handleTileChange_)}},{key:"getImagePixelData_",value:function(t,e,n){var i,r=this.gutter_,o=this.renderSize_[0],a=this.renderSize_[1];o8||(o8=tg(1,1,void 0,{willReadFrequently:!0})),o8.clearRect(0,0,1,1);var s=t.width,l=t.height;try{o8.drawImage(t,r+Math.floor((s-2*r)*(e/o)),r+Math.floor((l-2*r)*(n/a)),1,1,0,0,1,1),i=o8.getImageData(0,0,1,1).data}catch(t){return o8=null,null}return i}},{key:"getArrayPixelData_",value:function(t,e,n,i){var r=this.gutter_,o=this.renderSize_[0],a=this.renderSize_[1],s=e[0],l=e[1],u=s+2*r,c=r+Math.floor(s*(n/o)),h=r+Math.floor(l*(i/a));if(t instanceof DataView){var f=t.byteLength/(u*(l+2*r)),d=f*(h*u+c),v=t.buffer.slice(d,d+f);return new DataView(v)}var g=this.bandCount*(h*u+c);return t.slice(g,g+this.bandCount)}},{key:"getPixelData",value:function(t,e){if(!this.loaded)return null;if(this.tile instanceof o3){var n=this.tile.getData(),i=o0(n);if(i){var r=this.tile.getSize();return this.getArrayPixelData_(i,r,t,e)}return this.getImagePixelData_(oQ(n),t,e)}return this.getImagePixelData_(this.tile.getImage(),t,e)}}]),i}(tY.Z),o9={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},at={TEXTURE_COORD:"a_textureCoord"},ae=[{name:at.TEXTURE_COORD,size:2,type:oB.FLOAT}],an={};function ai(t,e,n){n in t||(t[n]=[]),t[n].push(e)}function ar(t,e){var n=t.layerStatesArray[t.layerIndex];n.extent&&(e=(0,M.Ed)(e,(0,t2.dY)(n.extent,t.viewState.projection)));var i=n.layer.getRenderSource();if(!i.getWrapX()){var r=i.getTileGridForProjection(t.viewState.projection).getExtent();r&&(e=(0,M.Ed)(e,r))}return e}function ao(t,e){return"".concat(t.getKey(),",").concat(nW(e))}var aa=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){(0,u.Z)(this,i),(r=n.call(this,t,{uniforms:e.uniforms})).renderComplete=!1,r.tileTransform_=(0,L.Ue)(),r.tempMat4_=oD(),r.tempTileRange_=new nN(0,0,0,0),r.tempTileCoord_=nX(0,0,0),r.tempSize_=[0,0],r.program_,r.vertexShader_=e.vertexShader,r.fragmentShader_=e.fragmentShader,r.indices_=new oO(34963,35044),r.indices_.fromArray([0,1,3,1,2,3]);var r,o=void 0!==e.cacheSize?e.cacheSize:512;return r.tileTextureCache_=new nz(o),r.paletteTextures_=e.paletteTextures||[],r.frameState_=null,r.projection_=void 0,r}return(0,c.Z)(i,[{key:"reset",value:function(t){R((0,d.Z)(i.prototype),"reset",this).call(this,{uniforms:t.uniforms}),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}},{key:"afterHelperCreated",value:function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}},{key:"isDrawableTile_",value:function(t){var e=this.getLayer(),n=t.getState(),i=e.getUseInterimTilesOnError();return n==t$.LOADED||n==t$.EMPTY||n==t$.ERROR&&!i}},{key:"prepareFrameInternal",value:function(t){this.projection_?t.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=t.viewState.projection):this.projection_=t.viewState.projection;var e=this.getLayer().getRenderSource();return!(!e||(0,M.xb)(ar(t,t.extent)))&&"ready"===e.getState()}},{key:"enqueueTiles",value:function(t,e,n,i,r){var o=t.viewState,a=this.getLayer(),s=a.getRenderSource(),l=s.getTileGridForProjection(o.projection),u=s.getGutterForProjection(o.projection),c=(0,A.sq)(s);c in t.wantedTiles||(t.wantedTiles[c]={});for(var h=t.wantedTiles[c],f=this.tileTextureCache_,d=a.getMapInternal(),v=Math.max(n-r,l.getMinZoom(),l.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):l.getResolution(0)),s.zDirection)),g=n;g>=v;--g)for(var p=l.getTileRangeForExtentAndZ(e,g,this.tempTileRange_),y=l.getResolution(g),_=p.minX;_<=p.maxX;++_)for(var m=p.minY;m<=p.maxY;++m){var x=nX(g,_,m,this.tempTileCoord_),R=ao(s,x),E=void 0,k=void 0;if(f.containsKey(R)&&(k=(E=f.get(R)).tile),!E||E.tile.key!==s.getKey()){if(k=s.getTile(g,_,m,t.pixelRatio,o.projection),E){if(this.isDrawableTile_(k))E.setTile(k);else{var T=k.getInterimTile();E.setTile(T)}}else E=new o7({tile:k,grid:l,helper:this.helper,gutter:u}),f.set(R,E)}ai(i,E,g);var C=k.getKey();h[C]=!0,k.getState()!==t$.IDLE||t.tileQueue.isKeyQueued(C)||t.tileQueue.enqueue([k,c,l.getTileCoordCenter(x),y])}}},{key:"renderFrame",value:function(t){var e=this;this.frameState_=t,this.renderComplete=!0;var n=this.helper.getGL();this.preRender(n,t);var i=t.viewState,r=this.getLayer(),o=r.getRenderSource(),a=o.getTileGridForProjection(i.projection),s=o.getGutterForProjection(i.projection),l=ar(t,t.extent),u=a.getZForResolution(i.resolution,o.zDirection),c={},h=r.getPreload();if(t.nextExtent){var f=a.getZForResolution(i.nextResolution,o.zDirection),d=ar(t,t.nextExtent);this.enqueueTiles(t,d,f,c,h)}this.enqueueTiles(t,l,u,c,0),h>0&&setTimeout(function(){e.enqueueTiles(t,l,u-1,c,h-1)},0);for(var v={},g=(0,A.sq)(this),p=t.time,y=!1,_=c[u],m=0,x=_.length;m<x;++m){var R=_[m],E=R.tile;if(!(E instanceof nF)&&!(E instanceof o5)||E.getState()!==t$.EMPTY){var k=E.tileCoord;if(R.loaded){var T=E.getAlpha(g,p);if(1===T){E.endTransition(g);continue}y=!0,v[nW(k)]=T}if(this.renderComplete=!1,!this.findAltTiles_(a,k,u+1,c))for(var C=a.getMinZoom(),S=u-1;S>=C&&!this.findAltTiles_(a,k,S,c);--S);}}this.helper.useProgram(this.program_,t),this.helper.prepareDraw(t,!y);for(var w=Object.keys(c).map(Number).sort(t4.j2),P=i.center[0],Z=i.center[1],I=0,b=w.length;I<b;++I)for(var O=w[I],D=a.getResolution(O),F=nv(a.getTileSize(O),this.tempSize_),N=a.getOrigin(O),B=F[0]+2*s,G=F[1]+2*s,U=B/G,z=(P-N[0])/(F[0]*D),X=(N[1]-Z)/(F[1]*D),j=i.resolution/D,W=2*(1-1/(O+1))-1,Y=c[O],V=0,H=Y.length;V<H;++V){var K=Y[V];if(K.loaded){var q=K.tile.tileCoord,J=nW(q),$=q[1],Q=q[2];(0,L.mc)(this.tileTransform_),(0,L.bA)(this.tileTransform_,2/(t.size[0]*j/B),-2/(t.size[1]*j/B)),(0,L.U1)(this.tileTransform_,i.rotation),(0,L.bA)(this.tileTransform_,1,1/U),(0,L.Iu)(this.tileTransform_,(F[0]*($-z)-s)/B,(F[1]*(Q-X)-s)/G),this.helper.setUniformMatrixValue(o9.TILE_TRANSFORM,oF(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(K.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(ae);for(var tt=0;tt<K.textures.length;){var te="TEXTURE"+tt,tn="".concat(o9.TILE_TEXTURE_ARRAY,"[").concat(tt,"]");n.activeTexture(n[te]),n.bindTexture(n.TEXTURE_2D,K.textures[tt]),n.uniform1i(this.helper.getUniformLocation(tn),tt),++tt}for(var ti=0;ti<this.paletteTextures_.length;++ti){var tr=this.paletteTextures_[ti];n.activeTexture(n["TEXTURE"+tt]);var to=tr.getTexture(n);n.bindTexture(n.TEXTURE_2D,to),n.uniform1i(this.helper.getUniformLocation(tr.name),tt),++tt}var ta=J in v?v[J]:1;ta<1&&(t.animate=!0),this.helper.setUniformFloatValue(o9.TRANSITION_ALPHA,ta),this.helper.setUniformFloatValue(o9.DEPTH,W),this.helper.setUniformFloatValue(o9.TEXTURE_PIXEL_WIDTH,B),this.helper.setUniformFloatValue(o9.TEXTURE_PIXEL_HEIGHT,G),this.helper.setUniformFloatValue(o9.TEXTURE_RESOLUTION,D),this.helper.setUniformFloatValue(o9.TEXTURE_ORIGIN_X,N[0]+$*F[0]*D-s*D),this.helper.setUniformFloatValue(o9.TEXTURE_ORIGIN_Y,N[1]-Q*F[1]*D+s*D);var ts=l;s>0&&(ts=a.getTileCoordExtent(q),(0,M.Ed)(ts,l,ts)),this.helper.setUniformFloatVec4(o9.RENDER_EXTENT,ts),this.helper.setUniformFloatValue(o9.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(o9.ZOOM,i.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var tl=this.helper.getCanvas(),tu=this.tileTextureCache_;tu.canExpireCache();)tu.pop().dispose();return t.postRenderFunctions.push(function(t,e){o.updateCacheSize(.1,e.viewState.projection),o.expireCache(e.viewState.projection,an)}),this.postRender(n,t),tl}},{key:"getData",value:function(t){if(!this.helper.getGL())return null;var e,n,i,r=this.frameState_;if(!r)return null;var o=this.getLayer(),a=(0,L.nn)(r.pixelToCoordinateTransform,t.slice()),s=r.viewState,l=o.getExtent();if(l&&!(0,M.b8)((0,t2.dY)(l,s.projection),a))return null;var u=o.getSources((0,M.hI)([a]),s.resolution);for(e=u.length-1;e>=0;--e)if("ready"===(n=u[e]).getState()){if(i=n.getTileGridForProjection(s.projection),n.getWrapX())break;var c=i.getExtent();if(!c||(0,M.b8)(c,a))break}if(e<0)return null;for(var h=this.tileTextureCache_,f=i.getZForResolution(s.resolution);f>=i.getMinZoom();--f){var d=i.getTileCoordForCoordAndZ(a,f),v=ao(n,d);if(h.containsKey(v)){var g=h.get(v),p=g.tile;if((p instanceof nF||p instanceof o5)&&p.getState()===t$.EMPTY)break;if(g.loaded){var y=i.getOrigin(f),_=nv(i.getTileSize(f)),m=i.getResolution(f),x=(a[0]-y[0])/m-d[1]*_[0],R=(y[1]-a[1])/m-d[2]*_[1];return g.getPixelData(x,R)}}}return null}},{key:"findAltTiles_",value:function(t,e,n,i){var r=t.getTileRangeForTileCoordAndZ(e,n,this.tempTileRange_);if(!r)return!1;for(var o=!0,a=this.tileTextureCache_,s=this.getLayer().getRenderSource(),l=r.minX;l<=r.maxX;++l)for(var u=r.minY;u<=r.maxY;++u){var c=ao(s,[n,l,u]),h=!1;if(a.containsKey(c)){var f=a.get(c);f.loaded&&(ai(i,f,n),h=!0)}h||(o=!1)}return o}},{key:"clearCache",value:function(){var t=this.tileTextureCache_;t.forEach(function(t){return t.dispose()}),t.clear()}},{key:"removeHelper",value:function(){this.helper&&this.clearCache(),R((0,d.Z)(i.prototype),"removeHelper",this).call(this)}},{key:"disposeInternal",value:function(){var t=this.helper;t&&(t.getGL().deleteProgram(this.program_),delete this.program_,t.deleteBuffer(this.indices_)),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_}}]),i}(oj),as=function(){function t(e,n){(0,u.Z)(this,t),this.name=e,this.data=n,this.texture_=null}return(0,c.Z)(t,[{key:"getTexture",value:function(t){if(!this.texture_){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.data.length/4,1,0,t.RGBA,t.UNSIGNED_BYTE,this.data),this.texture_=e}return this.texture_}}]),t}(),al={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},au={};function ac(t){if("number"==typeof t)return al.NUMBER;if("boolean"==typeof t)return al.BOOLEAN;if("string"==typeof t){var e;return(e=t,B.test(e)&&(e=U(e)),N.test(e)||e.startsWith("rgba(")||e.startsWith("rgb("))?al.COLOR|al.STRING:al.STRING}if(!Array.isArray(t))throw Error("Unhandled value type: ".concat(JSON.stringify(t)));if(t.every(function(t){return"number"==typeof t}))return 3===t.length||4===t.length?al.COLOR|al.NUMBER_ARRAY:al.NUMBER_ARRAY;if("string"!=typeof t[0])throw Error("Expected an expression operator but received: ".concat(JSON.stringify(t)));var n=au[t[0]];if(void 0===n)throw Error("Unrecognized expression operator: ".concat(JSON.stringify(t)));return n.getReturnType(t.slice(1))}function ah(t){var e=t.toString();return e.includes(".")?e:e+".0"}function af(t){if(t.length<2||t.length>4)throw Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(t.length,"(").concat(t.map(ah).join(", "),")")}function ad(t,e){return void 0===t.stringLiteralsMap[e]&&(t.stringLiteralsMap[e]=Object.keys(t.stringLiteralsMap).length),t.stringLiteralsMap[e]}function av(t,e,n){if(Array.isArray(e)&&"string"==typeof e[0]){var i,r=au[e[0]];if(void 0===r)throw Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return r.toGlsl(t,e.slice(1),n)}var o=ac(e);if((o&al.NUMBER)>0)return ah(e);if((o&al.BOOLEAN)>0)return e.toString();if((o&al.STRING)>0&&(void 0===n||n==al.STRING))return ah(ad(t,e.toString()));if((o&al.COLOR)>0&&(void 0===n||n==al.COLOR))return(i=X(e).slice()).length<4&&i.push(1),af(i.map(function(t,e){return e<3?t/255:t}));if((o&al.NUMBER_ARRAY)>0)return af(e);throw Error("Unexpected expression ".concat(e," (expected type ").concat(n,")"))}function ag(t){if(!(ac(t)&al.NUMBER))throw Error("A numeric value was expected, got ".concat(JSON.stringify(t)," instead"))}function ap(t){for(var e=0;e<t.length;e++)ag(t[e])}function ay(t){if(!(ac(t)&al.STRING))throw Error("A string value was expected, got ".concat(JSON.stringify(t)," instead"))}function a_(t){if(!(ac(t)&al.BOOLEAN))throw Error("A boolean value was expected, got ".concat(JSON.stringify(t)," instead"))}function am(t,e){if(t.length!==e)throw Error("Exactly ".concat(e," arguments were expected, got ").concat(t.length," instead"))}function ax(t,e){if(t.length<e)throw Error("At least ".concat(e," arguments were expected, got ").concat(t.length," instead"))}function aR(t,e){if(t.length>e)throw Error("At most ".concat(e," arguments were expected, got ").concat(t.length," instead"))}function aE(t){if(t.length%2!=0)throw Error("An even amount of arguments was expected, got ".concat(t," instead"))}function ak(t,e){if(Math.log2(e)%1!=0)throw Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(t)))}au.get={getReturnType:function(t){return al.ANY},toGlsl:function(t,e){am(e,1),ay(e[0]);var n=e[0].toString();return t.attributes.includes(n)||t.attributes.push(n),(t.inFragmentShader?"v_":"a_")+n}},au.var={getReturnType:function(t){return al.ANY},toGlsl:function(t,e){am(e,1),ay(e[0]);var n=e[0].toString();return t.variables.includes(n)||t.variables.push(n),"u_var_"+n}};var aT="u_paletteTextures";au.palette={getReturnType:function(t){return al.COLOR},toGlsl:function(t,e){am(e,2),ag(e[0]);var n=av(t,e[0]),i=e[1];if(!Array.isArray(i))throw Error("The second argument of palette must be an array");for(var r=i.length,o=new Uint8Array(4*r),a=0;a<r;a++){var s=i[a],l=void 0;if("string"==typeof s)l=z(s);else{if(!Array.isArray(s))throw Error("The second argument of palette must be an array of strings or colors");var u=s.length;if(4===u)l=s;else{if(3!==u)throw Error("Expected palette color to have 3 or 4 values, got ".concat(u));l=[s[0],s[1],s[2],1]}}var c=4*a;o[c]=l[0],o[c+1]=l[1],o[c+2]=l[2],o[c+3]=255*l[3]}t.paletteTextures||(t.paletteTextures=[]);var h="".concat(aT,"[").concat(t.paletteTextures.length,"]"),f=new as(h,o);return t.paletteTextures.push(f),"texture2D(".concat(h,", vec2((").concat(n," + 0.5) / ").concat(r,".0, 0.5))")}};var aC="getBandValue";function aS(t){return{getReturnType:function(t){return al.BOOLEAN},toGlsl:function(e,n){am(n,2);for(var i=al.ANY,r=0;r<n.length;r++)i&=ac(n[r]);if(i===al.NONE)throw Error("All arguments should be of compatible type, got ".concat(JSON.stringify(n)," instead"));return i&=~al.COLOR,"(".concat(av(e,n[0],i)," ").concat(t," ").concat(av(e,n[1],i),")")}}}function aw(t){return{getReturnType:function(t){return al.BOOLEAN},toGlsl:function(e,n){ax(n,2);for(var i=0;i<n.length;i++)a_(n[i]);var r="";return r=n.map(function(t){return av(e,t)}).join(" ".concat(t," ")),r="(".concat(r,")")}}}function aP(t,e){var n="\n    attribute vec2 ".concat(at.TEXTURE_COORD,";\n    uniform mat4 ").concat(o9.TILE_TRANSFORM,";\n    uniform float ").concat(o9.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(o9.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(o9.TEXTURE_RESOLUTION,";\n    uniform float ").concat(o9.TEXTURE_ORIGIN_X,";\n    uniform float ").concat(o9.TEXTURE_ORIGIN_Y,";\n    uniform float ").concat(o9.DEPTH,";\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ").concat(at.TEXTURE_COORD,";\n      v_mapCoord = vec2(\n        ").concat(o9.TEXTURE_ORIGIN_X," + ").concat(o9.TEXTURE_RESOLUTION," * ").concat(o9.TEXTURE_PIXEL_WIDTH," * v_textureCoord[0],\n        ").concat(o9.TEXTURE_ORIGIN_Y," - ").concat(o9.TEXTURE_RESOLUTION," * ").concat(o9.TEXTURE_PIXEL_HEIGHT," * v_textureCoord[1]\n      );\n      gl_Position = ").concat(o9.TILE_TRANSFORM," * vec4(").concat(at.TEXTURE_COORD,", ").concat(o9.DEPTH,", 1.0);\n    }\n  "),i={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},r=[];if(void 0!==t.color){var o=av(i,t.color,al.COLOR);r.push("color = ".concat(o,";"))}if(void 0!==t.contrast){var a=av(i,t.contrast,al.NUMBER);r.push("color.rgb = clamp((".concat(a," + 1.0) * color.rgb - (").concat(a," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(void 0!==t.exposure){var s=av(i,t.exposure,al.NUMBER);r.push("color.rgb = clamp((".concat(s," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(void 0!==t.saturation){var l=av(i,t.saturation,al.NUMBER);r.push("\n      float saturation = ".concat(l," + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    "))}if(void 0!==t.gamma){var u=av(i,t.gamma,al.NUMBER);r.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(u,"));"))}if(void 0!==t.brightness){var c=av(i,t.brightness,al.NUMBER);r.push("color.rgb = clamp(color.rgb + ".concat(c,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var h={},f=i.variables.length;if(f>1&&!t.variables)throw Error("Missing variables in style (expected ".concat(i.variables,")"));for(var d=0;d<f;++d)!function(e){var n=i.variables[e];if(!(n in t.variables))throw Error("Missing '".concat(n,"' in style variables"));h["u_var_"+n]=function(){var e=t.variables[n];return"string"==typeof e&&(e=ad(i,e)),void 0!==e?e:-9999999}}(d);var v=Object.keys(h).map(function(t){return"uniform float ".concat(t,";")});v.push("uniform sampler2D ".concat(o9.TILE_TEXTURE_ARRAY,"[").concat(Math.ceil(e/4),"];")),i.paletteTextures&&v.push("uniform sampler2D ".concat(aT,"[").concat(i.paletteTextures.length,"];"));var g=Object.keys(i.functions).map(function(t){return i.functions[t]});return{vertexShader:n,fragmentShader:"\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ".concat(o9.RENDER_EXTENT,";\n    uniform float ").concat(o9.TRANSITION_ALPHA,";\n    uniform float ").concat(o9.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(o9.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(o9.RESOLUTION,";\n    uniform float ").concat(o9.ZOOM,";\n\n    ").concat(v.join("\n"),"\n\n    ").concat(g.join("\n"),"\n\n    void main() {\n      if (\n        v_mapCoord[0] < ").concat(o9.RENDER_EXTENT,"[0] ||\n        v_mapCoord[1] < ").concat(o9.RENDER_EXTENT,"[1] ||\n        v_mapCoord[0] > ").concat(o9.RENDER_EXTENT,"[2] ||\n        v_mapCoord[1] > ").concat(o9.RENDER_EXTENT,"[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(").concat(o9.TILE_TEXTURE_ARRAY,"[0],  v_textureCoord);\n\n      ").concat(r.join("\n"),"\n\n      if (color.a == 0.0) {\n        discard;\n      }\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ").concat(o9.TRANSITION_ALPHA,";\n    }"),uniforms:h,paletteTextures:i.paletteTextures}}au.band={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){ax(e,1),aR(e,3);var n=e[0];if(!(aC in t.functions)){for(var i="",r=t.bandCount||1,o=0;o<r;o++){var a=Math.floor(o/4),s=o%4;o===r-1&&1===s&&(s=3);var l="".concat(o9.TILE_TEXTURE_ARRAY,"[").concat(a,"]");i+="\n          if (band == ".concat(o+1,".0) {\n            return texture2D(").concat(l,", v_textureCoord + vec2(dx, dy))[").concat(s,"];\n          }\n        ")}t.functions[aC]="\n        float getBandValue(float band, float xOffset, float yOffset) {\n          float dx = xOffset / ".concat(o9.TEXTURE_PIXEL_WIDTH,";\n          float dy = yOffset / ").concat(o9.TEXTURE_PIXEL_HEIGHT,";\n          ").concat(i,"\n        }\n      ")}var u=av(t,n),c=av(t,e[1]||0),h=av(t,e[2]||0);return"".concat(aC,"(").concat(u,", ").concat(c,", ").concat(h,")")}},au.time={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,0),"u_time"}},au.zoom={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,0),"u_zoom"}},au.resolution={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,0),"u_resolution"}},au["*"]={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return ax(e,2),ap(e),"(".concat(e.map(function(e){return av(t,e)}).join(" * "),")")}},au["/"]={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,2),ap(e),"(".concat(av(t,e[0])," / ").concat(av(t,e[1]),")")}},au["+"]={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return ax(e,2),ap(e),"(".concat(e.map(function(e){return av(t,e)}).join(" + "),")")}},au["-"]={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,2),ap(e),"(".concat(av(t,e[0])," - ").concat(av(t,e[1]),")")}},au.clamp={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){am(e,3),ap(e);var n=av(t,e[1]),i=av(t,e[2]);return"clamp(".concat(av(t,e[0]),", ").concat(n,", ").concat(i,")")}},au["%"]={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,2),ap(e),"mod(".concat(av(t,e[0]),", ").concat(av(t,e[1]),")")}},au["^"]={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,2),ap(e),"pow(".concat(av(t,e[0]),", ").concat(av(t,e[1]),")")}},au.abs={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,1),ap(e),"abs(".concat(av(t,e[0]),")")}},au.floor={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,1),ap(e),"floor(".concat(av(t,e[0]),")")}},au.round={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,1),ap(e),"floor(".concat(av(t,e[0])," + 0.5)")}},au.ceil={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,1),ap(e),"ceil(".concat(av(t,e[0]),")")}},au.sin={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,1),ap(e),"sin(".concat(av(t,e[0]),")")}},au.cos={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return am(e,1),ap(e),"cos(".concat(av(t,e[0]),")")}},au.atan={getReturnType:function(t){return al.NUMBER},toGlsl:function(t,e){return ax(e,1),aR(e,2),ap(e),2===e.length?"atan(".concat(av(t,e[0]),", ").concat(av(t,e[1]),")"):"atan(".concat(av(t,e[0]),")")}},au[">"]={getReturnType:function(t){return al.BOOLEAN},toGlsl:function(t,e){return am(e,2),ap(e),"(".concat(av(t,e[0])," > ").concat(av(t,e[1]),")")}},au[">="]={getReturnType:function(t){return al.BOOLEAN},toGlsl:function(t,e){return am(e,2),ap(e),"(".concat(av(t,e[0])," >= ").concat(av(t,e[1]),")")}},au["<"]={getReturnType:function(t){return al.BOOLEAN},toGlsl:function(t,e){return am(e,2),ap(e),"(".concat(av(t,e[0])," < ").concat(av(t,e[1]),")")}},au["<="]={getReturnType:function(t){return al.BOOLEAN},toGlsl:function(t,e){return am(e,2),ap(e),"(".concat(av(t,e[0])," <= ").concat(av(t,e[1]),")")}},au["=="]=aS("=="),au["!="]=aS("!="),au["!"]={getReturnType:function(t){return al.BOOLEAN},toGlsl:function(t,e){return am(e,1),a_(e[0]),"(!".concat(av(t,e[0]),")")}},au.all=aw("&&"),au.any=aw("||"),au.between={getReturnType:function(t){return al.BOOLEAN},toGlsl:function(t,e){am(e,3),ap(e);var n=av(t,e[1]),i=av(t,e[2]),r=av(t,e[0]);return"(".concat(r," >= ").concat(n," && ").concat(r," <= ").concat(i,")")}},au.array={getReturnType:function(t){return al.NUMBER_ARRAY},toGlsl:function(t,e){ax(e,2),aR(e,4),ap(e);var n=e.map(function(e){return av(t,e,al.NUMBER)});return"vec".concat(e.length,"(").concat(n.join(", "),")")}},au.color={getReturnType:function(t){return al.COLOR},toGlsl:function(t,e){ax(e,3),aR(e,4),ap(e),3===e.length&&e.push(1);var n=e.map(function(e,n){return av(t,e,al.NUMBER)+(n<3?" / 255.0":"")});return"vec".concat(e.length,"(").concat(n.join(", "),")")}},au.interpolate={getReturnType:function(t){for(var e=al.COLOR|al.NUMBER,n=3;n<t.length;n+=2)e&=ac(t[n]);return e},toGlsl:function(t,e,n){aE(e),ax(e,6);var i,r=e[0];switch(r[0]){case"linear":i=1;break;case"exponential":i=r[1];break;default:i=null}if(!i)throw Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(r)));n=void 0!==n?n:al.ANY;var o=au.interpolate.getReturnType(e)&n;ak(e,o);for(var a=av(t,e[1]),s=ah(i),l="",u=2;u<e.length-2;u+=2){var c=av(t,e[u]),h=l||av(t,e[u+1],o),f=av(t,e[u+2]),d=av(t,e[u+3],o);l="mix(".concat(h,", ").concat(d,", pow(clamp((").concat(a," - ").concat(c,") / (").concat(f," - ").concat(c,"), 0.0, 1.0), ").concat(s,"))")}return l}},au.match={getReturnType:function(t){for(var e=al.ANY,n=2;n<t.length;n+=2)e&=ac(t[n]);return e&ac(t[t.length-1])},toGlsl:function(t,e,n){aE(e),ax(e,4),n=void 0!==n?n:al.ANY;var i=au.match.getReturnType(e)&n;ak(e,i);for(var r=av(t,e[0]),o=av(t,e[e.length-1],i),a=null,s=e.length-3;s>=1;s-=2){var l=av(t,e[s]),u=av(t,e[s+1],i);a="(".concat(r," == ").concat(l," ? ").concat(u," : ").concat(a||o,")")}return a}},au.case={getReturnType:function(t){for(var e=al.ANY,n=1;n<t.length;n+=2)e&=ac(t[n]);return e&ac(t[t.length-1])},toGlsl:function(t,e,n){(function(t){if(t.length%2==0)throw Error("An odd amount of arguments was expected, got ".concat(t," instead"))})(e),ax(e,3),n=void 0!==n?n:al.ANY;var i=au.case.getReturnType(e)&n;ak(e,i);for(var r=0;r<e.length-1;r+=2)a_(e[r]);for(var o=av(t,e[e.length-1],i),a=null,s=e.length-3;s>=0;s-=2){var l=av(t,e[s]),u=av(t,e[s+1],i);a="(".concat(l," ? ").concat(u," : ").concat(a||o,")")}return a}},function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){(0,u.Z)(this,i);var e,r=(t=t?Object.assign({},t):{}).style||{};delete t.style;var o=t.cacheSize;return delete t.cacheSize,(e=n.call(this,t)).sources_=t.sources,e.renderedSource_=null,e.renderedResolution_=NaN,e.style_=r,e.cacheSize_=o,e.styleVariables_=e.style_.variables||{},e.addChangeListener(H.SOURCE,e.handleSourceUpdate_),e}return(0,c.Z)(i,[{key:"getSources",value:function(t,e){var n=this.getSource();return this.sources_?"function"==typeof this.sources_?this.sources_(t,e):this.sources_:n?[n]:[]}},{key:"getRenderSource",value:function(){return this.renderedSource_||this.getSource()}},{key:"getSourceState",value:function(){var t=this.getRenderSource();return t?t.getState():"undefined"}},{key:"handleSourceUpdate_",value:function(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}},{key:"getSourceBandCount_",value:function(){var t=Number.MAX_SAFE_INTEGER,e=this.getSources([-t,-t,t,t],t);return e&&e.length&&"bandCount"in e[0]?e[0].bandCount:4}},{key:"createRenderer",value:function(){var t=aP(this.style_,this.getSourceBandCount_());return new aa(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.cacheSize_,paletteTextures:t.paletteTextures})}},{key:"renderSources",value:function(t,e){for(var n,i=this.getRenderer(),r=0,o=e.length;r<o;++r)this.renderedSource_=e[r],i.prepareFrame(t)&&(n=i.renderFrame(t));return n}},{key:"render",value:function(t,e){var n=this;this.rendered=!0;for(var i=t.viewState,r=this.getSources(t.extent,i.resolution),o=!0,a=0,s=r.length;a<s;++a)!function(t,e){var i=r[t],a=i.getState();"loading"==a&&i.addEventListener("change",function t(){"ready"==i.getState()&&(i.removeEventListener("change",t),n.changed())}),o=o&&"ready"==a}(a,0);var l=this.renderSources(t,r);if(this.getRenderer().renderComplete&&o)return this.renderedResolution_=i.resolution,l;if(this.renderedResolution_>.5*i.resolution){var u=this.getSources(t.extent,this.renderedResolution_).filter(function(t){return!r.includes(t)});if(u.length>0)return this.renderSources(t,u)}return l}},{key:"setStyle",value:function(t){this.styleVariables_=t.variables||{},this.style_=t;var e=aP(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,paletteTextures:e.paletteTextures}),this.changed()}},{key:"updateStyleVariables",value:function(t){Object.assign(this.styleVariables_,t),this.changed()}}]),i}(nx).prototype.dispose;var aZ={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},aI=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).on,e.once,e.un,e.options=t,e.id=t.id,e.insertFirst=void 0===t.insertFirst||t.insertFirst,e.stopEvent=void 0===t.stopEvent||t.stopEvent,e.element=document.createElement("div"),e.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",e.element.style.position="absolute",e.element.style.pointerEvents="auto",e.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,e.rendered={transform_:"",visible:!0},e.mapPostrenderListenerKey=null,e.addChangeListener(aZ.ELEMENT,e.handleElementChanged),e.addChangeListener(aZ.MAP,e.handleMapChanged),e.addChangeListener(aZ.OFFSET,e.handleOffsetChanged),e.addChangeListener(aZ.POSITION,e.handlePositionChanged),e.addChangeListener(aZ.POSITIONING,e.handlePositioningChanged),void 0!==t.element&&e.setElement(t.element),e.setOffset(void 0!==t.offset?t.offset:[0,0]),e.setPositioning(t.positioning||"top-left"),void 0!==t.position&&e.setPosition(t.position),e}return(0,c.Z)(i,[{key:"getElement",value:function(){return this.get(aZ.ELEMENT)}},{key:"getId",value:function(){return this.id}},{key:"getMap",value:function(){return this.get(aZ.MAP)||null}},{key:"getOffset",value:function(){return this.get(aZ.OFFSET)}},{key:"getPosition",value:function(){return this.get(aZ.POSITION)}},{key:"getPositioning",value:function(){return this.get(aZ.POSITIONING)}},{key:"handleElementChanged",value:function(){tm(this.element);var t=this.getElement();t&&this.element.appendChild(t)}},{key:"handleMapChanged",value:function(){this.mapPostrenderListenerKey&&(t_(this.element),(0,$.bN)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=(0,$.oL)(t,tH.POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}},{key:"render",value:function(){this.updatePixelPosition()}},{key:"handleOffsetChanged",value:function(){this.updatePixelPosition()}},{key:"handlePositionChanged",value:function(){this.updatePixelPosition(),this.performAutoPan()}},{key:"handlePositioningChanged",value:function(){this.updatePixelPosition()}},{key:"setElement",value:function(t){this.set(aZ.ELEMENT,t)}},{key:"setMap",value:function(t){this.set(aZ.MAP,t)}},{key:"setOffset",value:function(t){this.set(aZ.OFFSET,t)}},{key:"setPosition",value:function(t){this.set(aZ.POSITION,t)}},{key:"performAutoPan",value:function(){this.autoPan&&this.panIntoView(this.autoPan)}},{key:"panIntoView",value:function(t){var e,n,i,r,o=this.getMap();if(o&&o.getTargetElement()&&this.get(aZ.POSITION)){var a=this.getRect(o.getTargetElement(),o.getSize()),s=this.getElement(),l=this.getRect(s,[s.offsetWidth+(parseInt((n=getComputedStyle(s)).marginLeft,10)+parseInt(n.marginRight,10)),s.offsetHeight+(parseInt((r=getComputedStyle(s)).marginTop,10)+parseInt(r.marginBottom,10))]),u=void 0===(t=t||{}).margin?20:t.margin;if(!(0,M.r4)(a,l)){var c=l[0]-a[0],h=a[2]-l[2],f=l[1]-a[1],d=a[3]-l[3],v=[0,0];if(c<0?v[0]=c-u:h<0&&(v[0]=Math.abs(h)+u),f<0?v[1]=f-u:d<0&&(v[1]=Math.abs(d)+u),0!==v[0]||0!==v[1]){var g=o.getView().getCenterInternal(),p=o.getPixelFromCoordinateInternal(g);if(!p)return;var y=[p[0]+v[0],p[1]+v[1]],_=t.animation||{};o.getView().animateInternal({center:o.getCoordinateFromPixelInternal(y),duration:_.duration,easing:_.easing})}}}}},{key:"getRect",value:function(t,e){var n=t.getBoundingClientRect(),i=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[i,r,i+e[0],r+e[1]]}},{key:"setPositioning",value:function(t){this.set(aZ.POSITIONING,t)}},{key:"setVisible",value:function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}},{key:"updatePixelPosition",value:function(){var t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}var n=t.getPixelFromCoordinate(e),i=t.getSize();this.updateRenderedPosition(n,i)}},{key:"updateRenderedPosition",value:function(t,e){var n=this.element.style,i=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var o=Math.round(t[0]+i[0])+"px",a=Math.round(t[1]+i[1])+"px",s="0%",l="0%";"bottom-right"==r||"center-right"==r||"top-right"==r?s="-100%":("bottom-center"==r||"center-center"==r||"top-center"==r)&&(s="-50%"),"bottom-left"==r||"bottom-center"==r||"bottom-right"==r?l="-100%":("center-left"==r||"center-center"==r||"center-right"==r)&&(l="-50%");var u="translate(".concat(s,", ").concat(l,") translate(").concat(o,", ").concat(a,")");this.rendered.transform_!=u&&(this.rendered.transform_=u,n.transform=u)}},{key:"getOptions",value:function(){return this.options}}]),i}(k.Z);function ab(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var aO=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r,o,a;if((0,u.Z)(this,i),!(null===(a=null===(o=(r=n.call(this,t,e)).context)||void 0===o?void 0:o.map)||void 0===a?void 0:a.addInteraction))throw Error("An interaction must be part of a map");return r.ol=r.createOL(t),r}return(0,c.Z)(i,[{key:"createOL",value:function(t){throw Error("RBaseInteraction should not be directly instantiated")}},{key:"refresh",value:function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ab(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ab(t,e)}}(t))){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.classProps);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(t&&t[r]!==this.props[r]){y("Replacing interaction",this,t),this.componentWillUnmount(),this.ol=this.createOL(this.props),this.componentDidMount();break}}}catch(t){n.e(t)}finally{n.f()}R((0,d.Z)(i.prototype),"refresh",this).call(this,t)}},{key:"componentDidMount",value:function(){R((0,d.Z)(i.prototype),"componentDidMount",this).call(this),this.context.map.addInteraction(this.ol)}},{key:"componentWillUnmount",value:function(){R((0,d.Z)(i.prototype),"componentWillUnmount",this).call(this),this.context.map.removeInteraction(this.ol)}}]),i}(x);aO.classProps=[];var aA=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i)}(aO);function aL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}aA.classProps=["handleDownEvent","handleDragEvent","handleMoveEvent","handleUpEvent"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new nr(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aA).classProps=["className","condition","minArea","boxEndCondition"];var aM={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},aD=function(t){(0,h.Z)(n,t);var e=aL(n);function n(t,i,r,o,a){var s;return(0,u.Z)(this,n),(s=e.call(this,t)).features=i,s.coordinate=r,s.startCoordinate=o,s.mapBrowserEvent=a,s}return(0,c.Z)(n)}(S.ZP),aF=function(t){(0,h.Z)(n,t);var e=aL(n);function n(t){if((0,u.Z)(this,n),t=t||{},(i=e.call(this,t)).on,i.once,i.un,i.lastCoordinate_=null,i.startCoordinate_=null,i.features_=void 0!==t.features?t.features:null,t.layers&&!i.features_){if("function"==typeof t.layers)r=t.layers;else{var i,r,o=t.layers;r=function(t){return o.includes(t)}}}else r=O.uX;return i.layerFilter_=r,i.filter_=t.filter&&!i.features_?t.filter:O.uX,i.hitTolerance_=t.hitTolerance?t.hitTolerance:0,i.condition_=t.condition?t.condition:e0,i.lastFeature_=null,i.addChangeListener(eX.ACTIVE,i.handleActiveChanged_),i}return(0,c.Z)(n,[{key:"handleDownEvent",value:function(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new I([this.lastFeature_]);return this.dispatchEvent(new aD(aM.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1}},{key:"handleUpEvent",value:function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new I([this.lastFeature_]);return this.dispatchEvent(new aD(aM.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}},{key:"handleDragEvent",value:function(t){if(this.lastCoordinate_){var e=t.coordinate,n=e[0]-this.lastCoordinate_[0],i=e[1]-this.lastCoordinate_[1],r=this.features_||new I([this.lastFeature_]);r.forEach(function(t){var e=t.getGeometry();e.translate(n,i),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new aD(aM.TRANSLATING,r,e,this.startCoordinate_,t))}}},{key:"handleMoveEvent",value:function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}},{key:"featuresAtPixel_",value:function(t,e){var n=this;return e.forEachFeatureAtPixel(t,function(t,e){if(t instanceof n8&&n.filter_(t,e)&&(!n.features_||n.features_.getArray().includes(t)))return t},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"setHitTolerance",value:function(t){this.hitTolerance_=t}},{key:"setMap",value:function(t){var e=this.getMap();R((0,d.Z)(n.prototype),"setMap",this).call(this,t),this.updateState_(e)}},{key:"handleActiveChanged_",value:function(){this.updateState_(null)}},{key:"updateState_",value:function(t){var e=this.getMap(),n=this.getActive();(!e||!n)&&(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")}}]),n}(eV);(function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new aF(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i})(aA).classProps=["features","layers","filter","hitTolerance"];var aN=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r){var o;return(0,u.Z)(this,i),o=n.call(this),void 0!==r&&void 0===e?o.setFlatCoordinates(r,t):(e=e||0,o.setCenterAndRadius(t,e,r)),o}return(0,c.Z)(i,[{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){var r=this.flatCoordinates,o=t-r[0],a=e-r[1],s=o*o+a*a;if(s<i){if(0===s)for(var l=0;l<this.stride;++l)n[l]=r[l];else{var u=this.getRadius()/Math.sqrt(s);n[0]=r[0]+u*o,n[1]=r[1]+u*a;for(var c=2;c<this.stride;++c)n[c]=r[c]}return n.length=this.stride,s}return i}},{key:"containsXY",value:function(t,e){var n=this.flatCoordinates,i=t-n[0],r=e-n[1];return i*i+r*r<=this.getRadiusSquared_()}},{key:"getCenter",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"computeExtent",value:function(t){var e=this.flatCoordinates,n=e[this.stride]-e[0];return(0,M.T9)(e[0]-n,e[1]-n,e[0]+n,e[1]+n,t)}},{key:"getRadius",value:function(){return Math.sqrt(this.getRadiusSquared_())}},{key:"getRadiusSquared_",value:function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}},{key:"getType",value:function(){return"Circle"}},{key:"intersectsExtent",value:function(t){var e=this.getExtent();if((0,M.kK)(t,e)){var n=this.getCenter();return t[0]<=n[0]&&t[2]>=n[0]||t[1]<=n[1]&&t[3]>=n[1]||(0,M.H6)(t,this.intersectsCoordinate.bind(this))}return!1}},{key:"setCenter",value:function(t){var e=this.stride,n=this.flatCoordinates[e]-this.flatCoordinates[0],i=t.slice();i[e]=i[0]+n;for(var r=1;r<e;++r)i[e+r]=t[r];this.setFlatCoordinates(this.layout,i),this.changed()}},{key:"setCenterAndRadius",value:function(t,e,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var i=this.flatCoordinates,r=(0,eh.IG)(i,0,t,this.stride);i[r++]=i[0]+e;for(var o=1,a=this.stride;o<a;++o)i[r++]=i[o];i.length=r,this.changed()}},{key:"getCoordinates",value:function(){return null}},{key:"setCoordinates",value:function(t,e){}},{key:"setRadius",value:function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}},{key:"rotate",value:function(t,e){var n=this.getCenter(),i=this.getStride();this.setCenter((0,rr.U1)(n,0,n.length,i,t,e,n)),this.changed()}},{key:"translate",value:function(t,e){var n=this.getCenter(),i=this.getStride();this.setCenter((0,rr.Iu)(n,0,n.length,i,t,e,n)),this.changed()}}]),i}(eo.ZP);aN.prototype.transform;var aB=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t){var e;return(0,u.Z)(this,i),(e=n.call(this)).geometries_=t||null,e.changeEventsKeys_=[],e.listenGeometriesChange_(),e}return(0,c.Z)(i,[{key:"unlistenGeometriesChange_",value:function(){this.changeEventsKeys_.forEach($.bN),this.changeEventsKeys_.length=0}},{key:"listenGeometriesChange_",value:function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push((0,$.oL)(this.geometries_[t],q.Z.CHANGE,this.changed,this))}},{key:"clone",value:function(){var t=new i(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){if(i<(0,M.qf)(this.getExtent(),t,e))return i;for(var r=this.geometries_,o=0,a=r.length;o<a;++o)i=r[o].closestPointXY(t,e,n,i);return i}},{key:"containsXY",value:function(t,e){for(var n=this.geometries_,i=0,r=n.length;i<r;++i)if(n[i].containsXY(t,e))return!0;return!1}},{key:"computeExtent",value:function(t){(0,M.YN)(t);for(var e=this.geometries_,n=0,i=e.length;n<i;++n)(0,M.l7)(t,e[n].getExtent());return t}},{key:"getGeometries",value:function(){return aG(this.geometries_)}},{key:"getGeometriesArray",value:function(){return this.geometries_}},{key:"getGeometriesArrayRecursive",value:function(){for(var t=[],e=this.geometries_,n=0,i=e.length;n<i;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],n=this.geometries_,r=!1,o=0,a=n.length;o<a;++o){var s=n[o],l=s.getSimplifiedGeometry(t);e.push(l),l!==s&&(r=!0)}if(r){var u=new i(null);return u.setGeometriesArray(e),u}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}},{key:"getType",value:function(){return"GeometryCollection"}},{key:"intersectsExtent",value:function(t){for(var e=this.geometries_,n=0,i=e.length;n<i;++n)if(e[n].intersectsExtent(t))return!0;return!1}},{key:"isEmpty",value:function(){return 0===this.geometries_.length}},{key:"rotate",value:function(t,e){for(var n=this.geometries_,i=0,r=n.length;i<r;++i)n[i].rotate(t,e);this.changed()}},{key:"scale",value:function(t,e,n){n||(n=(0,M.qg)(this.getExtent()));for(var i=this.geometries_,r=0,o=i.length;r<o;++r)i[r].scale(t,e,n);this.changed()}},{key:"setGeometries",value:function(t){this.setGeometriesArray(aG(t))}},{key:"setGeometriesArray",value:function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}},{key:"applyTransform",value:function(t){for(var e=this.geometries_,n=0,i=e.length;n<i;++n)e[n].applyTransform(t);this.changed()}},{key:"translate",value:function(t,e){for(var n=this.geometries_,i=0,r=n.length;i<r;++i)n[i].translate(t,e);this.changed()}},{key:"disposeInternal",value:function(){this.unlistenGeometriesChange_(),R((0,d.Z)(i.prototype),"disposeInternal",this).call(this)}}]),i}(n(3849).Z);function aG(t){for(var e=[],n=0,i=t.length;n<i;++n)e.push(t[n].clone());return e}var aU=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r){var o;if((0,u.Z)(this,i),(o=n.call(this)).ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(t[0]))o.setCoordinates(t,e);else if(void 0!==e&&r)o.setFlatCoordinates(e,t),o.ends_=r;else{for(var a=o.getLayout(),s=[],l=[],c=0,h=t.length;c<h;++c){var f=t[c];0===c&&(a=f.getLayout()),(0,t4.l7)(s,f.getFlatCoordinates()),l.push(s.length)}o.setFlatCoordinates(a,s),o.ends_=l}return o}return(0,c.Z)(i,[{key:"appendLineString",value:function(t){this.flatCoordinates?(0,t4.l7)(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){return i<(0,M.qf)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(el(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ec(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,i))}},{key:"getCoordinateAtM",value:function(t,e,n){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,n=void 0!==n&&n,function(t,e,n,i,r,o,a){if(a)return oE(t,e,n[n.length-1],i,r,o);if(r<t[i-1])return o?((s=t.slice(0,i))[i-1]=r,s):null;if(t[t.length-1]<r)return o?((s=t.slice(t.length-i))[i-1]=r,s):null;for(var s,l=0,u=n.length;l<u;++l){var c=n[l];if(e!=c){if(r<t[e+i-1])break;if(r<=t[c-1])return oE(t,e,c,i,r,!1);e=c}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}},{key:"getCoordinates",value:function(){return ep(this.flatCoordinates,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getLineString",value:function(t){return t<0||this.ends_.length<=t?null:new ok(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLineStrings",value:function(){for(var t=this.flatCoordinates,e=this.ends_,n=this.layout,i=[],r=0,o=0,a=e.length;o<a;++o){var s=e[o],l=new ok(t.slice(r,s),n);i.push(l),r=s}return i}},{key:"getFlatMidpoints",value:function(){for(var t=[],e=this.flatCoordinates,n=0,i=this.ends_,r=this.stride,o=0,a=i.length;o<a;++o){var s=i[o],l=oR(e,n,s,r,.5);(0,t4.l7)(t,l),n=s}return t}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],n=[];return e.length=function(t,e,n,i,r,o,a,s){for(var l=0,u=n.length;l<u;++l){var c=n[l];a=ef(t,e,c,i,r,o,a),s.push(a),e=c}return a}(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new i(e,"XY",n)}},{key:"getType",value:function(){return"MultiLineString"}},{key:"intersectsExtent",value:function(t){return function(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){if(eS(t,e,n[o],i,r))return!0;e=n[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=(0,eh._5)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}]),i}(eo.ZP),az=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e){var r;return(0,u.Z)(this,i),r=n.call(this),e&&!Array.isArray(t[0])?r.setFlatCoordinates(e,t):r.setCoordinates(t,e),r}return(0,c.Z)(i,[{key:"appendPoint",value:function(t){this.flatCoordinates?(0,t4.l7)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}},{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){if(i<(0,M.qf)(this.getExtent(),t,e))return i;for(var r=this.flatCoordinates,o=this.stride,a=0,s=r.length;a<s;a+=o){var l=(0,F.bI)(t,e,r[a],r[a+1]);if(l<i){i=l;for(var u=0;u<o;++u)n[u]=r[a+u];n.length=o}}return i}},{key:"getCoordinates",value:function(){return eg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getPoint",value:function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new eR.Z(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}},{key:"getPoints",value:function(){for(var t=this.flatCoordinates,e=this.layout,n=this.stride,i=[],r=0,o=t.length;r<o;r+=n){var a=new eR.Z(t.slice(r,r+n),e);i.push(a)}return i}},{key:"getType",value:function(){return"MultiPoint"}},{key:"intersectsExtent",value:function(t){for(var e=this.flatCoordinates,n=this.stride,i=0,r=e.length;i<r;i+=n){var o=e[i],a=e[i+1];if((0,M.jE)(t,o,a))return!0}return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,eh.Sg)(this.flatCoordinates,0,t,this.stride),this.changed()}}]),i}(eo.ZP),aX=function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(t,e,r){var o;if((0,u.Z)(this,i),(o=n.call(this)).endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var a=o.getLayout(),s=t,l=[],c=[],h=0,f=s.length;h<f;++h){var d=s[h];0===h&&(a=d.getLayout());for(var v=l.length,g=d.getEnds(),p=0,y=g.length;p<y;++p)g[p]+=v;(0,t4.l7)(l,d.getFlatCoordinates()),c.push(g)}e=a,t=l,r=c}return void 0!==e&&r?(o.setFlatCoordinates(e,t),o.endss_=r):o.setCoordinates(t,e),o}return(0,c.Z)(i,[{key:"appendPolygon",value:function(t){var e;if(this.flatCoordinates){var n=this.flatCoordinates.length;(0,t4.l7)(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(var i=0,r=e.length;i<r;++i)e[i]+=n}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}},{key:"clone",value:function(){for(var t=this.endss_.length,e=Array(t),n=0;n<t;++n)e[n]=this.endss_[n].slice();var r=new i(this.flatCoordinates.slice(),this.layout,e);return r.applyProperties(this),r}},{key:"closestPointXY",value:function(t,e,n,i){return i<(0,M.qf)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o];r=el(t,e,s,i,r),e=s[s.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,r,o,a,s,l,u,c){c=c||[NaN,NaN];for(var h=0,f=n.length;h<f;++h){var d=n[h];u=ec(t,e,d,i,r,o,a,s,l,u,c),e=d[d.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"containsXY",value:function(t,e){return function(t,e,n,i,r,o){if(0===n.length)return!1;for(var a=0,s=n.length;a<s;++a){var l=n[a];if(ek(t,e,l,i,r,o))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}},{key:"getArea",value:function(){return function(t,e,n,i){for(var r=0,o=0,a=n.length;o<a;++o){var s=n[o];r+=em(t,e,s,i),e=s[s.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?eO(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,ey(e,0,this.endss_,this.stride)}},{key:"getEndss",value:function(){return this.endss_}},{key:"getFlatInteriorPoints",value:function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,n,i){for(var r=[],o=(0,M.lJ)(),a=0,s=n.length;a<s;++a){var l=n[a];o=(0,M.GN)(t,e,l[0],i),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,n,i,r){for(var o=[],a=0,s=n.length;a<s;++a){var l=n[a];o=eT(t,e,l,i,r,2*a,o),e=l[l.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}},{key:"getInteriorPoints",value:function(){return new az(this.getFlatInteriorPoints().slice(),"XYM")}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;(function(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o];if(!eI(t,e,s,i,void 0))return!1;s.length&&(e=s[s.length-1])}return!0})(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=eO(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],n=[];return e.length=function(t,e,n,i,r,o,a,s){for(var l=0,u=n.length;l<u;++l){var c=n[l],h=[];a=ev(t,e,c,i,r,o,a,h),s.push(h),e=c[c.length-1]}return a}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new i(e,"XY",n)}},{key:"getPolygon",value:function(t){if(t<0||this.endss_.length<=t)return null;if(0===t)e=0;else{var e,n=this.endss_[t-1];e=n[n.length-1]}var i=this.endss_[t].slice(),r=i[i.length-1];if(0!==e)for(var o=0,a=i.length;o<a;++o)i[o]-=e;return new eA(this.flatCoordinates.slice(e,r),this.layout,i)}},{key:"getPolygons",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.endss_,i=[],r=0,o=0,a=n.length;o<a;++o){var s=n[o].slice(),l=s[s.length-1];if(0!==r)for(var u=0,c=s.length;u<c;++u)s[u]-=r;var h=new eA(e.slice(r,l),t,s);i.push(h),r=l}return i}},{key:"getType",value:function(){return"MultiPolygon"}},{key:"intersectsExtent",value:function(t){return function(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o];if(eP(t,e,s,i,r))return!0;e=s[s.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var n=(0,eh.QT)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===n.length)this.flatCoordinates.length=0;else{var i=n[n.length-1];this.flatCoordinates.length=0===i.length?0:i[i.length-1]}this.changed()}}]),i}(eo.ZP);function aj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}var aW={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"},aY=function(t){(0,h.Z)(n,t);var e=aj(n);function n(t,i){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).feature=i,r}return(0,c.Z)(n)}(S.ZP);function aV(t,e){return(0,F.bI)(t[0],t[1],e[0],e[1])}function aH(t,e){var n=t.length;return e<0?t[e+n]:e>=n?t[e-n]:t[e]}function aK(t,e,n){e<n?(i=e,r=n):(i=n,r=e);var i,r,o=Math.ceil(i),a=Math.floor(r);if(o>a)return aV(a0(t,i),a0(t,r));var s=0;i<o&&(s+=aV(a0(t,i),aH(t,o))),a<r&&(s+=aV(aH(t,a),a0(t,r)));for(var l=o;l<a-1;++l)s+=aV(aH(t,l),aH(t,l+1));return s}var aq={index:-1,endIndex:NaN};function aJ(t,e,n,i){for(var r=t[0],o=t[1],a=0,s=e.length-1;a<s;++a){var l=aQ(r,o,e[a],e[a+1]);if(0===l.squaredDistance){var u=a+l.along;i.push({coordinates:e,ring:n,startIndex:u,endIndex:u});return}}}var a$={along:0,squaredDistance:0};function aQ(t,e,n,i){var r=n[0],o=n[1],a=i[0],s=i[1],l=a-r,u=s-o,c=0,h=r,f=o;return(0!==l||0!==u)&&(c=(0,F.uZ)(((t-r)*l+(e-o)*u)/(l*l+u*u),0,1),h+=l*c,f+=u*c),a$.along=c,a$.squaredDistance=(0,F.FH)((0,F.bI)(t,e,h,f),10),a$}function a0(t,e){var n=t.length,i=Math.floor(e),r=e-i;i>=n?i-=n:i<0&&(i+=n);var o=i+1;o>=n&&(o-=n);var a=t[i],s=a[0],l=a[1],u=t[o],c=u[0]-s,h=u[1]-l;return[s+c*r,l+h*r]}var a1=function(t){(0,h.Z)(n,t);var e=aj(n);function n(t){(0,u.Z)(this,n);var i,r=t;r.stopDown||(r.stopDown=O.Dv),(a=e.call(this,r)).on,a.once,a.un,a.shouldHandle_=!1,a.downPx_=null,a.downTimeout_,a.lastDragTime_,a.pointerType_,a.freehand_=!1,a.source_=t.source?t.source:null,a.features_=t.features?t.features:null,a.snapTolerance_=t.snapTolerance?t.snapTolerance:12,a.type_=t.type,a.mode_=function(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw Error("Invalid type: "+t)}}(a.type_),a.stopClick_=!!t.stopClick,a.minPoints_=t.minPoints?t.minPoints:"Polygon"===a.mode_?3:2,a.maxPoints_="Circle"===a.mode_?2:t.maxPoints?t.maxPoints:1/0,a.finishCondition_=t.finishCondition?t.finishCondition:O.uX,a.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";var o=t.geometryFunction;if(!o){var a,s,l=a.mode_;"Circle"===l?o=function(t,e,n){var i=e||new aN([NaN,NaN]),r=(0,t2.Vs)(t[0],n),o=(0,te.bI)(r,(0,t2.Vs)(t[t.length-1],n));i.setCenterAndRadius(r,Math.sqrt(o),this.geometryLayout_);var a=(0,t2.Cs)();return a&&i.transform(n,a),i}:("Point"===l?s=eR.Z:"LineString"===l?s=ok:"Polygon"===l&&(s=eA),o=function(t,e,n){return e?"Polygon"===l?t[0].length?e.setCoordinates([t[0].concat([t[0][0]])],this.geometryLayout_):e.setCoordinates([],this.geometryLayout_):e.setCoordinates(t,this.geometryLayout_):e=new s(t,this.geometryLayout_),e})}return a.geometryFunction_=o,a.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,a.finishCoordinate_=null,a.sketchFeature_=null,a.sketchPoint_=null,a.sketchCoords_=null,a.sketchLine_=null,a.sketchLineCoords_=null,a.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,a.overlay_=new rw({source:new rM({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(i=iZ(),function(t,e){return i[t.getGeometry().getType()]}),updateWhileInteracting:!0}),a.geometryName_=t.geometryName,a.condition_=t.condition?t.condition:e3,a.freehandCondition_,t.freehand?a.freehandCondition_=e0:a.freehandCondition_=t.freehandCondition?t.freehandCondition:e5,a.traceCondition_,a.setTrace(t.trace||!1),a.traceState_={active:!1},a.traceSource_=t.traceSource||t.source||null,a.addChangeListener(eX.ACTIVE,a.updateState_),a}return(0,c.Z)(n,[{key:"setTrace",value:function(t){this.traceCondition_=t?!0===t?e0:t:e2}},{key:"setMap",value:function(t){R((0,d.Z)(n.prototype),"setMap",this).call(this,t),this.updateState_()}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleEvent",value:function(t){t.originalEvent.type===q.Z.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(t);var e=t.type===tj.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===tj.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===tj.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===tj.POINTERDOWN?i=!1:e&&2>this.getPointerCount()?(i=t.type===tj.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):("mouse"===t.originalEvent.pointerType||t.type===tj.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===tj.DBLCLICK&&(i=!1),R((0,d.Z)(n.prototype),"handleEvent",this).call(this,t)&&i}},{key:"handleDownEvent",value:function(t){var e=this;return(this.shouldHandle_=!this.freehand_,this.freehand_)?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){e.handlePointerMove_(new tX(tj.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}},{key:"deactivateTrace_",value:function(){this.traceState_={active:!1}}},{key:"toggleTraceState_",value:function(t){if(this.traceSource_&&this.traceCondition_(t)){if(this.traceState_.active){this.deactivateTrace_();return}var e=this.getMap(),n=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),i=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),r=(0,M.hI)([n,i]),o=this.traceSource_.getFeaturesInExtent(r);if(0!==o.length){var a=function(t,e){for(var n=[],i=0;i<e.length;++i)(function t(e,n,i){if(n instanceof ok){aJ(e,n.getCoordinates(),!1,i);return}if(n instanceof aU){for(var r=n.getCoordinates(),o=0,a=r.length;o<a;++o)aJ(e,r[o],!1,i);return}if(n instanceof eA){for(var s=n.getCoordinates(),l=0,u=s.length;l<u;++l)aJ(e,s[l],!0,i);return}if(n instanceof aX){for(var c=n.getCoordinates(),h=0,f=c.length;h<f;++h)for(var d=c[h],v=0,g=d.length;v<g;++v)aJ(e,d[v],!0,i);return}if(n instanceof aB){for(var p=n.getGeometries(),y=0;y<p.length;++y)t(e,p[y],i);return}})(t,e[i].getGeometry(),n);return n}(t.coordinate,o);a.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:a,targetIndex:-1})}}}},{key:"addOrRemoveTracedCoordinates_",value:function(t,e){var n=t.startIndex<=t.endIndex;n===t.startIndex<=e?n&&e>t.endIndex||!n&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(n&&e<t.endIndex||!n&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}},{key:"removeTracedCoordinates_",value:function(t,e){if(t!==e){var n=0;if(t<e){var i=Math.floor(e);i===e&&(i-=1),n=i-Math.ceil(t)+1}else{var r=Math.ceil(e);r===e&&(r+=1),n=Math.floor(t)-r+1}n>0&&this.removeLastPoints_(n)}}},{key:"addTracedCoordinates_",value:function(t,e,n){if(e!==n){var i=[];if(e<n){var r=Math.ceil(e),o=Math.floor(n);o===n&&(o-=1);for(var a=r;a<=o;++a)i.push(aH(t.coordinates,a))}else{var s=Math.floor(e),l=Math.ceil(n);l===n&&(l+=1);for(var u=s;u>=l;--u)i.push(aH(t.coordinates,u))}i.length&&this.appendCoordinates(i)}}},{key:"updateTrace_",value:function(t){var e=this.traceState_;if(!(!e.active||-1===e.targetIndex&&(0,te.TE)(e.startPx,t.pixel)<this.snapTolerance_)){var n=function(t,e,n,i){for(var r=t[0],o=t[1],a=1/0,s=-1,l=NaN,u=0;u<e.targets.length;++u){for(var c=e.targets[u],h=c.coordinates,f=1/0,d=void 0,v=0;v<h.length-1;++v){var g=aQ(r,o,h[v],h[v+1]);g.squaredDistance<f&&(f=g.squaredDistance,d=v+g.along)}f<a&&(a=f,c.ring&&e.targetIndex===u&&(c.endIndex>c.startIndex?d<c.startIndex&&(d+=h.length):c.endIndex<c.startIndex&&d>c.startIndex&&(d-=h.length)),l=d,s=u)}var p=e.targets[s],y=p.ring;if(e.targetIndex===s&&y){var _=a0(p.coordinates,l),m=n.getPixelFromCoordinate(_);(0,te.TE)(m,e.startPx)>i&&(y=!1)}if(y){var x=p.coordinates,R=x.length,E=p.startIndex,k=l;if(E<k){var T=aK(x,E,k);aK(x,E,k-R)<T&&(l-=R)}else{var C=aK(x,E,k);aK(x,E,k+R)<C&&(l+=R)}}return aq.index=s,aq.endIndex=l,aq}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==n.index){if(-1!==e.targetIndex){var i=e.targets[e.targetIndex];this.removeTracedCoordinates_(i.startIndex,i.endIndex)}var r=e.targets[n.index];this.addTracedCoordinates_(r,r.startIndex,n.endIndex)}else{var o=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(o,n.endIndex)}e.targetIndex=n.index;var a=e.targets[e.targetIndex];a.endIndex=n.endIndex;var s=a0(a.coordinates,a.endIndex),l=this.getMap().getPixelFromCoordinate(s);t.coordinate=s,t.pixel=[Math.round(l[0]),Math.round(l[1])]}}},{key:"handleUpEvent",value:function(t){var e=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var n=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){var i=!this.finishCoordinate_;i&&this.startDrawing_(t.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&"Point"!==this.mode_||(this.atFinish_(t.pixel,n)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}},{key:"handlePointerMove_",value:function(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,n=t.pixel,i=e[0]-n[0],r=e[1]-n[1],o=i*i+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(t.coordinate.slice());return}this.updateTrace_(t),this.modifyDrawing_(t.coordinate)}},{key:"atFinish_",value:function(t,e){var n=!1;if(this.sketchFeature_){var i=!1,r=[this.finishCoordinate_],o=this.mode_;if("Point"===o)n=!0;else if("Circle"===o)n=2===this.sketchCoords_.length;else if("LineString"===o)i=!e&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===o){var a=this.sketchCoords_;i=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],r=e?[a[0][0]]:[a[0][0],a[0][a[0].length-2]]}if(i)for(var s=this.getMap(),l=0,u=r.length;l<u;l++){var c=r[l],h=s.getPixelFromCoordinate(c),f=t[0]-h[0],d=t[1]-h[1];if(n=Math.sqrt(f*f+d*d)<=(this.freehand_?1:this.snapTolerance_)){this.finishCoordinate_=c;break}}}return n}},{key:"createOrUpdateSketchPoint_",value:function(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new n8(new eR.Z(t)),this.updateSketchFeatures_())}},{key:"createOrUpdateCustomSketchLine_",value:function(t){this.sketchLine_||(this.sketchLine_=new n8);var e=t.getLinearRing(0),n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),n.changed()):(n=new ok(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(n))}},{key:"startDrawing_",value:function(t){for(var e=this.getMap().getView().getProjection(),n=(0,eo.tP)(this.geometryLayout_);t.length<n;)t.push(0);this.finishCoordinate_=t,"Point"===this.mode_?this.sketchCoords_=t.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new n8(new ok(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new n8,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new aY(aW.DRAWSTART,this.sketchFeature_))}},{key:"modifyDrawing_",value:function(t){for(var e,n,i=this.getMap(),r=this.sketchFeature_.getGeometry(),o=i.getView().getProjection(),a=(0,eo.tP)(this.geometryLayout_);t.length<a;)t.push(0);"Point"===this.mode_?n=this.sketchCoords_:"Polygon"===this.mode_?(n=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(i.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):n=(e=this.sketchCoords_)[e.length-1],n[0]=t[0],n[1]=t[1],this.geometryFunction_(this.sketchCoords_,r,o),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),"Polygon"===r.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}},{key:"addToDrawing_",value:function(t){var e,n,i=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),o=this.mode_;"LineString"===o||"Circle"===o?(this.finishCoordinate_=t.slice(),(n=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?n.pop():e=!0),n.push(t.slice()),this.geometryFunction_(n,i,r)):"Polygon"===o&&((n=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?n.pop():e=!0),n.push(t.slice()),e&&(this.finishCoordinate_=n[0]),this.geometryFunction_(this.sketchCoords_,i,r)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),e&&this.finishDrawing()}},{key:"removeLastPoints_",value:function(t){if(this.sketchFeature_){for(var e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),i=this.mode_,r=0;r<t;++r){var o=void 0;if("LineString"===i||"Circle"===i){if((o=this.sketchCoords_).splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();var a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,e,n),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===i){(o=this.sketchCoords_[0]).splice(-2,1);var s=this.sketchLine_.getGeometry();if(o.length>=2){var l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}s.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,e,n)}if(1===o.length){this.abortDrawing();break}}this.updateSketchFeatures_()}}},{key:"removeLastPoint",value:function(){this.removeLastPoints_(1)}},{key:"finishDrawing",value:function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,n=t.getGeometry(),i=this.getMap().getView().getProjection();"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,n,i)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,n,i),e=n.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new az([e])):"MultiLineString"===this.type_?t.setGeometry(new aU([e])):"MultiPolygon"===this.type_&&t.setGeometry(new aX([e])),this.dispatchEvent(new aY(aW.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}}},{key:"abortDrawing_",value:function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}},{key:"abortDrawing",value:function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new aY(aW.DRAWABORT,t))}},{key:"appendCoordinates",value:function(t){var e,n=this.mode_,i=!this.sketchFeature_;if(i&&this.startDrawing_(t[0]),"LineString"===n||"Circle"===n)e=this.sketchCoords_;else{if("Polygon"!==n)return;e=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&e.shift(),e.pop();for(var r=0;r<t.length;r++)this.addToDrawing_(t[r]);var o=t[t.length-1];this.addToDrawing_(o),this.modifyDrawing_(o)}},{key:"extend",value:function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new n8(new eR.Z(n)),this.updateSketchFeatures_(),this.dispatchEvent(new aY(aW.DRAWSTART,this.sketchFeature_))}},{key:"updateSketchFeatures_",value:function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}},{key:"updateState_",value:function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)}}]),n}(eV);function a2(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}(function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e,n=this;if(!(null===(e=this===null||void 0===this?void 0:this.context)||void 0===e?void 0:e.vectorsource))throw Error("A Draw interaction must be part of a vector layer");return this.classProps=i.classProps,new a1(Object.assign({type:t.type,source:this.context.vectorsource},Object.keys(t).filter(function(t){return n.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{})))}}]),i})(aA).classProps=["condition","finishCondition","freehandCondition","style","stopClick","maxPoints","minPoints","snapTolerance"];var a3=[0,0,0,0],a5=[],a4={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},a6=function(t){(0,h.Z)(n,t);var e=a2(n);function n(t,i,r){var o;return(0,u.Z)(this,n),(o=e.call(this,t)).features=i,o.mapBrowserEvent=r,o}return(0,c.Z)(n)}(S.ZP),a8=function(t){(0,h.Z)(n,t);var e=a2(n);function n(t){var i,r,o;if((0,u.Z)(this,n),(i=e.call(this,t)).on,i.once,i.un,i.boundHandleFeatureChange_=i.handleFeatureChange_.bind((0,E.Z)(i)),i.condition_=t.condition?t.condition:e8,i.defaultDeleteCondition_=function(t){return eq(t)&&t.type==tj.SINGLECLICK},i.deleteCondition_=t.deleteCondition?t.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:e0,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.featuresBeingModified_=null,i.rBush_=new rP,i.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new rw({source:new rM({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(o=iZ(),function(t,e){return o.Point}),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind((0,E.Z)(i)),LineString:i.writeLineStringGeometry_.bind((0,E.Z)(i)),LinearRing:i.writeLineStringGeometry_.bind((0,E.Z)(i)),Polygon:i.writePolygonGeometry_.bind((0,E.Z)(i)),MultiPoint:i.writeMultiPointGeometry_.bind((0,E.Z)(i)),MultiLineString:i.writeMultiLineStringGeometry_.bind((0,E.Z)(i)),MultiPolygon:i.writeMultiPolygonGeometry_.bind((0,E.Z)(i)),Circle:i.writeCircleGeometry_.bind((0,E.Z)(i)),GeometryCollection:i.writeGeometryCollectionGeometry_.bind((0,E.Z)(i))},i.source_=null,i.hitDetection_=null,t.features?r=t.features:t.source&&(i.source_=t.source,r=new I(i.source_.getFeatures()),i.source_.addEventListener(rZ.ADDFEATURE,i.handleSourceAdd_.bind((0,E.Z)(i))),i.source_.addEventListener(rZ.REMOVEFEATURE,i.handleSourceRemove_.bind((0,E.Z)(i)))),!r)throw Error("The modify interaction requires features, a source or a layer");return t.hitDetection&&(i.hitDetection_=t.hitDetection),i.features_=r,i.features_.forEach(i.addFeature_.bind((0,E.Z)(i))),i.features_.addEventListener(C.ADD,i.handleFeatureAdd_.bind((0,E.Z)(i))),i.features_.addEventListener(C.REMOVE,i.handleFeatureRemove_.bind((0,E.Z)(i))),i.lastPointerEvent_=null,i.delta_=[0,0],i.snapToPointer_=void 0===t.snapToPointer?!i.hitDetection_:t.snapToPointer,i}return(0,c.Z)(n,[{key:"addFeature_",value:function(t){var e=t.getGeometry();if(e){var n=this.SEGMENT_WRITERS_[e.getType()];n&&n(t,e)}var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),t.addEventListener(q.Z.CHANGE,this.boundHandleFeatureChange_)}},{key:"willModifyFeatures_",value:function(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new I;for(var n=this.featuresBeingModified_.getArray(),i=0,r=e.length;i<r;++i)for(var o=e[i],a=0,s=o.length;a<s;++a){var l=o[a].feature;l&&!n.includes(l)&&this.featuresBeingModified_.push(l)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new a6(a4.MODIFYSTART,this.featuresBeingModified_,t))}}},{key:"removeFeature_",value:function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(q.Z.CHANGE,this.boundHandleFeatureChange_)}},{key:"removeFeatureSegmentData_",value:function(t){var e=this.rBush_,n=[];e.forEach(function(e){t===e.feature&&n.push(e)});for(var i=n.length-1;i>=0;--i){for(var r=n[i],o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===r&&this.dragSegments_.splice(o,1);e.remove(r)}}},{key:"setActive",value:function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),R((0,d.Z)(n.prototype),"setActive",this).call(this,t)}},{key:"setMap",value:function(t){this.overlay_.setMap(t),R((0,d.Z)(n.prototype),"setMap",this).call(this,t)}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleSourceAdd_",value:function(t){t.feature&&this.features_.push(t.feature)}},{key:"handleSourceRemove_",value:function(t){t.feature&&this.features_.remove(t.feature)}},{key:"handleFeatureAdd_",value:function(t){this.addFeature_(t.element)}},{key:"handleFeatureChange_",value:function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}}},{key:"handleFeatureRemove_",value:function(t){this.removeFeature_(t.element)}},{key:"writePointGeometry_",value:function(t,e){var n=e.getCoordinates();this.rBush_.insert(e.getExtent(),{feature:t,geometry:e,segment:[n,n]})}},{key:"writeMultiPointGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i){var o=n[i],a={feature:t,geometry:e,depth:[i],index:i,segment:[o,o]};this.rBush_.insert(e.getExtent(),a)}}},{key:"writeLineStringGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length-1;i<r;++i){var o=n.slice(i,i+2),a={feature:t,geometry:e,index:i,segment:o};this.rBush_.insert((0,M.hI)(o),a)}}},{key:"writeMultiLineStringGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var o=n[i],a=0,s=o.length-1;a<s;++a){var l=o.slice(a,a+2),u={feature:t,geometry:e,depth:[i],index:a,segment:l};this.rBush_.insert((0,M.hI)(l),u)}}},{key:"writePolygonGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var o=n[i],a=0,s=o.length-1;a<s;++a){var l=o.slice(a,a+2),u={feature:t,geometry:e,depth:[i],index:a,segment:l};this.rBush_.insert((0,M.hI)(l),u)}}},{key:"writeMultiPolygonGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var o=n[i],a=0,s=o.length;a<s;++a)for(var l=o[a],u=0,c=l.length-1;u<c;++u){var h=l.slice(u,u+2),f={feature:t,geometry:e,depth:[a,i],index:u,segment:h};this.rBush_.insert((0,M.hI)(h),f)}}},{key:"writeCircleGeometry_",value:function(t,e){var n=e.getCenter(),i={feature:t,geometry:e,index:0,segment:[n,n]},r={feature:t,geometry:e,index:1,segment:[n,n]},o=[i,r];i.featureSegments=o,r.featureSegments=o,this.rBush_.insert((0,M.HK)(n),i);var a=e,s=(0,t2.Cs)();if(s&&this.getMap()){var l=this.getMap().getView().getProjection();a=a.clone().transform(s,l),a=eM(a).transform(l,s)}this.rBush_.insert(a.getExtent(),r)}},{key:"writeGeometryCollectionGeometry_",value:function(t,e){for(var n=e.getGeometriesArray(),i=0;i<n.length;++i){var r=n[i];(0,this.SEGMENT_WRITERS_[r.getType()])(t,r)}}},{key:"createOrUpdateVertexFeature_",value:function(t,e,n){var i=this.vertexFeature_;return i?i.getGeometry().setCoordinates(t):(i=new n8(new eR.Z(t)),this.vertexFeature_=i,this.overlay_.getSource().addFeature(i)),i.set("features",e),i.set("geometries",n),i}},{key:"handleEvent",value:function(t){var e;return!t.originalEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=tj.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=t.type==tj.SINGLECLICK&&!!this.ignoreNextSingleClick_||this.removePoint()),t.type==tj.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),R((0,d.Z)(n.prototype),"handleEvent",this).call(this,t)&&!e)}},{key:"handleDragEvent",value:function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);for(var e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],n=[],i=[],r=0,o=this.dragSegments_.length;r<o;++r){var a=this.dragSegments_[r],s=a[0],l=s.feature;n.includes(l)||n.push(l);var u=s.geometry;i.includes(u)||i.push(u);for(var c=s.depth,h=void 0,f=s.segment,d=a[1];e.length<u.getStride();)e.push(f[d][e.length]);switch(u.getType()){case"Point":h=e,f[0]=e,f[1]=e;break;case"MultiPoint":(h=u.getCoordinates())[s.index]=e,f[0]=e,f[1]=e;break;case"LineString":(h=u.getCoordinates())[s.index+d]=e,f[d]=e;break;case"MultiLineString":case"Polygon":(h=u.getCoordinates())[c[0]][s.index+d]=e,f[d]=e;break;case"MultiPolygon":(h=u.getCoordinates())[c[1]][c[0]][s.index+d]=e,f[d]=e;break;case"Circle":if(f[0]=e,f[1]=e,0===s.index)this.changingFeature_=!0,u.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;var v=t.map.getView().getProjection(),g=(0,te.TE)((0,t2.Vs)(u.getCenter(),v),(0,t2.Vs)(e,v)),p=(0,t2.Cs)();if(p){var y=u.clone().transform(p,v);y.setRadius(g),g=y.transform(v,p).getRadius()}u.setRadius(g),this.changingFeature_=!1}}h&&this.setGeometryCoordinates_(u,h)}this.createOrUpdateVertexFeature_(e,n,i)}},{key:"handleDownEvent",value:function(t){if(!this.condition_(t))return!1;var e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;var n=this.vertexFeature_;if(n){var i=t.map.getView().getProjection(),r=[],o=n.getGeometry().getCoordinates(),a=(0,M.hI)([o]),s=this.rBush_.getInExtent(a),l={};s.sort(a7);for(var u=0,c=s.length;u<c;++u){var h=s[u],f=h.segment,d=(0,A.sq)(h.geometry),v=h.depth;if(v&&(d+="-"+v.join("-")),l[d]||(l[d]=[,,]),"Circle"===h.geometry.getType()&&1===h.index){var g=st(e,h,i);(0,te.fS)(g,o)&&!l[d][0]&&(this.dragSegments_.push([h,0]),l[d][0]=h);continue}if((0,te.fS)(f[0],o)&&!l[d][0]){this.dragSegments_.push([h,0]),l[d][0]=h;continue}if((0,te.fS)(f[1],o)&&!l[d][1]){if(l[d][0]&&0===l[d][0].index){var p=h.geometry.getCoordinates();switch(h.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":p=p[v[1]];case"Polygon":if(h.index!==p[v[0]].length-2)continue}}this.dragSegments_.push([h,1]),l[d][1]=h;continue}(0,A.sq)(f) in this.vertexSegments_&&!l[d][0]&&!l[d][1]&&this.insertVertexCondition_(t)&&r.push(h)}r.length&&this.willModifyFeatures_(t,[r]);for(var y=r.length-1;y>=0;--y)this.insertVertex_(r[y],o)}return!!this.vertexFeature_}},{key:"handleUpEvent",value:function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var n=this.dragSegments_[e][0],i=n.geometry;if("Circle"===i.getType()){var r=i.getCenter(),o=n.featureSegments[0],a=n.featureSegments[1];o.segment[0]=r,o.segment[1]=r,a.segment[0]=r,a.segment[1]=r,this.rBush_.update((0,M.HK)(r),o);var s=i,l=(0,t2.Cs)();if(l){var u=t.map.getView().getProjection();s=s.clone().transform(l,u),s=eM(s).transform(u,l)}this.rBush_.update(s.getExtent(),a)}else this.rBush_.update((0,M.hI)(n.segment),n)}return this.featuresBeingModified_&&(this.dispatchEvent(new a6(a4.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1}},{key:"handlePointerMove_",value:function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)}},{key:"handlePointerAtPixel_",value:function(t,e,n){var i,r,o=this,a=n||e.getCoordinateFromPixel(t),s=e.getView().getProjection();if(this.hitDetection_){var l="object"==typeof this.hitDetection_?function(t){return t===o.hitDetection_}:void 0;e.forEachFeatureAtPixel(t,function(t,e,n){var a=n||t.getGeometry();if("Point"===a.getType()&&t instanceof n8&&o.features_.getArray().includes(t)){var s=(r=a).getFlatCoordinates().slice(0,2);i=[{feature:t,geometry:r,segment:[s,s]}]}return!0},{layerFilter:l})}if(!i){var u=(0,t2.dY)((0,M.HK)(a,a3),s),c=e.getView().getResolution()*this.pixelTolerance_,h=(0,t2.Fj)((0,M.f3)(u,c,a3),s);i=this.rBush_.getInExtent(h)}if(i&&i.length>0){var f=i.sort(function(t,e){return a9(a,t,s)-a9(a,e,s)})[0],d=f.segment,v=st(a,f,s),g=e.getPixelFromCoordinate(v),p=(0,te.TE)(t,g);if(r||p<=this.pixelTolerance_){var y={};if(y[(0,A.sq)(d)]=!0,this.snapToPointer_||(this.delta_[0]=v[0]-a[0],this.delta_[1]=v[1]-a[1]),"Circle"===f.geometry.getType()&&1===f.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(v,[f.feature],[f.geometry]);else{var _=e.getPixelFromCoordinate(d[0]),m=e.getPixelFromCoordinate(d[1]),x=(0,te.bI)(g,_),R=(0,te.bI)(g,m);p=Math.sqrt(Math.min(x,R)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(v=x>R?d[1]:d[0]),this.createOrUpdateVertexFeature_(v,[f.feature],[f.geometry]);var E={};E[(0,A.sq)(f.geometry)]=!0;for(var k=1,T=i.length;k<T;++k){var C=i[k].segment;if((0,te.fS)(d[0],C[0])&&(0,te.fS)(d[1],C[1])||(0,te.fS)(d[0],C[1])&&(0,te.fS)(d[1],C[0])){var S=(0,A.sq)(i[k].geometry);S in E||(E[S]=!0,y[(0,A.sq)(C)]=!0)}else break}}this.vertexSegments_=y;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}},{key:"insertVertex_",value:function(t,e){for(var n,i=t.segment,r=t.feature,o=t.geometry,a=t.depth,s=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case"MultiLineString":case"Polygon":(n=o.getCoordinates())[a[0]].splice(s+1,0,e);break;case"MultiPolygon":(n=o.getCoordinates())[a[1]][a[0]].splice(s+1,0,e);break;case"LineString":(n=o.getCoordinates()).splice(s+1,0,e);break;default:return}this.setGeometryCoordinates_(o,n);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(o,s,a,1);var u={segment:[i[0],e],feature:r,geometry:o,depth:a,index:s};l.insert((0,M.hI)(u.segment),u),this.dragSegments_.push([u,1]);var c={segment:[e,i[1]],feature:r,geometry:o,depth:a,index:s+1};l.insert((0,M.hI)(c.segment),c),this.dragSegments_.push([c,0]),this.ignoreNextSingleClick_=!0}},{key:"removePoint",value:function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=tj.POINTERDRAG){var t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);var e=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new a6(a4.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1}},{key:"removeVertex_",value:function(){var t,e,n,i,r,o,a,s,l,u,c,h=this.dragSegments_,f={},d=!1;for(r=h.length-1;r>=0;--r)u=(n=h[r])[0],c=(0,A.sq)(u.feature),u.depth&&(c+="-"+u.depth.join("-")),c in f||(f[c]={}),0===n[1]?(f[c].right=u,f[c].index=u.index):1==n[1]&&(f[c].left=u,f[c].index=u.index+1);for(c in f){switch(l=f[c].right,a=f[c].left,(s=(o=f[c].index)-1)<0&&(s=0),t=e=(i=(u=void 0!==a?a:l).geometry).getCoordinates(),d=!1,i.getType()){case"MultiLineString":e[u.depth[0]].length>2&&(e[u.depth[0]].splice(o,1),d=!0);break;case"LineString":e.length>2&&(e.splice(o,1),d=!0);break;case"MultiPolygon":t=t[u.depth[1]];case"Polygon":(t=t[u.depth[0]]).length>4&&(o==t.length-1&&(o=0),t.splice(o,1),d=!0,0===o&&(t.pop(),t.push(t[0]),s=t.length-1))}if(d){this.setGeometryCoordinates_(i,e);var v=[];if(void 0!==a&&(this.rBush_.remove(a),v.push(a.segment[0])),void 0!==l&&(this.rBush_.remove(l),v.push(l.segment[1])),void 0!==a&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:s,segment:v};this.rBush_.insert((0,M.hI)(g.segment),g)}this.updateSegmentIndices_(i,o,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),h.length=0}}return d}},{key:"setGeometryCoordinates_",value:function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}},{key:"updateSegmentIndices_",value:function(t,e,n,i){this.rBush_.forEachInExtent(t.getExtent(),function(r){r.geometry===t&&(void 0===n||void 0===r.depth||(0,t4.fS)(r.depth,n))&&r.index>e&&(r.index+=i)})}}]),n}(eV);function a7(t,e){return t.index-e.index}function a9(t,e,n){var i=e.geometry;if("Circle"===i.getType()){var r=i;if(1===e.index){var o=(0,t2.Cs)();o&&(r=r.clone().transform(o,n));var a=Math.sqrt((0,te.bI)(r.getCenter(),(0,t2.Vs)(t,n)))-r.getRadius();return a*a}}var s=(0,t2.Vs)(t,n);return a5[0]=(0,t2.Vs)(e.segment[0],n),a5[1]=(0,t2.Vs)(e.segment[1],n),(0,te.Bs)(s,a5)}function st(t,e,n){var i=e.geometry;if("Circle"===i.getType()&&1===e.index){var r=i,o=(0,t2.Cs)();return o&&(r=r.clone().transform(o,n)),(0,t2.lO)(r.getClosestPoint((0,t2.Vs)(t,n)),n)}var a=(0,t2.Vs)(t,n);return a5[0]=(0,t2.Vs)(e.segment[0],n),a5[1]=(0,t2.Vs)(e.segment[1],n),(0,t2.lO)((0,te.oL)(a,a5),n)}function se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.Z)(this,n)}}(function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e,n=this;if(!(null===(e=this===null||void 0===this?void 0:this.context)||void 0===e?void 0:e.vectorsource))throw Error("A Modify interaction must be part of a vector layer");return this.classProps=i.classProps,new a8(Object.assign({source:this.context.vectorsource},Object.keys(t).filter(function(t){return n.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{})))}}]),i})(aA).classProps=["condition","deleteCondition","insertVertexCondition","style","pixelTolerance","hitDetection"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new eY(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["duration","delta"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new e7(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["condition","kinetic"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new e9(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["condition","duration"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new no(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["className","condition","duration","out","minArea"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new nc(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["condition","maxDelta","duration","useAnchor","constrainResolution"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new nh(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["threshold","duration"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new nf(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["duration"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new ns(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["condition","duration","pixelDelta"],function(t){(0,h.Z)(i,t);var e,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=(0,d.Z)(i);if(e){var r=(0,d.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.Z)(this,t)});function i(){return(0,u.Z)(this,i),n.apply(this,arguments)}return(0,c.Z)(i,[{key:"createOL",value:function(t){var e=this;return this.classProps=i.classProps,new nl(Object.keys(t).filter(function(t){return e.classProps.includes(t)}).reduce(function(e,n){return Object.assign(Object.assign({},e),(0,oK.Z)({},n,t[n]))},{}))}}]),i}(aO).classProps=["condition","duration","delta"];var sn=function(t){(0,h.Z)(n,t);var e=se(n);function n(){return(0,u.Z)(this,n),e.apply(this,arguments)}return(0,c.Z)(n)}(function(t){(0,h.Z)(n,t);var e=se(n);function n(t,i){var r,o;if((0,u.Z)(this,n),!(null===(o=(r=e.call(this,t,i)).context)||void 0===o?void 0:o.location))throw Error("An overlay must be part of a location provider (ie RFeature)");return r.ol=new aI({autoPan:t.autoPan}),r.containerRef=v.createRef(),r}return(0,c.Z)(n,[{key:"setPosition",value:function(){var t;if(this.ol.setPosition(this.context.location),this.props.autoPosition&&(null===(t=this.containerRef)||void 0===t?void 0:t.current)){this.containerRef.current.style.position="absolute";var e=this.context.map.getPixelFromCoordinate(this.context.location),n=this.context.map.getSize();e[0]>n[0]/2?(this.containerRef.current.style.left=null,this.containerRef.current.style.right="0px"):(this.containerRef.current.style.left="0px",this.containerRef.current.style.right=null),e[1]>n[1]/2?(this.containerRef.current.style.top=null,this.containerRef.current.style.bottom="0px"):(this.containerRef.current.style.top="0px",this.containerRef.current.style.bottom=null)}}},{key:"refresh",value:function(t){R((0,d.Z)(n.prototype),"refresh",this).call(this,t),this.ol.setElement(this.containerRef.current),this.setPosition()}},{key:"componentDidMount",value:function(){R((0,d.Z)(n.prototype),"componentDidMount",this).call(this),this.context.map.addOverlay(this.ol)}},{key:"componentWillUnmount",value:function(){R((0,d.Z)(n.prototype),"componentWillUnmount",this).call(this),this.context.map.removeOverlay(this.ol)}},{key:"render",value:function(){return this.setPosition(),v.createElement("div",{ref:this.containerRef,className:this.props.className},this.props.children)}}]),n}(x)),si={ERROR:"error"};S.ZP,k.Z},9008:function(t,e,n){t.exports=n(1597)},46:function(t){var e,n,i,r=t.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l=[],u=!1,c=-1;function h(){u&&i&&(u=!1,i.length?l=i.concat(l):c=-1,l.length&&f())}function f(){if(!u){var t=s(h);u=!0;for(var e=l.length;e;){for(i=l,l=[];++c<e;)i&&i[c].run();c=-1,e=l.length}i=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}r.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new d(t,e)),1!==l.length||u||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(t){return[]},r.binding=function(t){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw Error("process.chdir is not supported")},r.umask=function(){return 0}},2582:function(t){t.exports=function(){"use strict";function t(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function e(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e){r(t,0,t.children.length,e,t)}function r(t,e,n,i,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a=e;a<n;a++){var s=t.children[a];o(r,t.leaf?i(s):s)}return r}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function h(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(n,i,r,o,a){for(var s=[i,r];s.length;)if(!((r=s.pop())-(i=s.pop())<=o)){var l=i+Math.ceil((r-i)/o/2)*o;(function e(n,i,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),f=Math.max(r,Math.floor(i-l*c/s+h)),d=Math.min(o,Math.floor(i+(s-l)*c/s+h));e(n,i,f,d,a)}var v=n[i],g=r,p=o;for(t(n,r,i),a(n[o],v)>0&&t(n,r,o);g<p;){for(t(n,g,p),g++,p--;0>a(n[g],v);)g++;for(;a(n[p],v)>0;)p--}0===a(n[r],v)?t(n,r,p):t(n,++p,o),p<=i&&(r=p+1),i<=p&&(o=p-1)}})(n,l,i||0,r||n.length-1,a||e),s.push(i,l,l,r)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,n=[];if(!h(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?i(a):a;h(t,s)&&(e.leaf?n.push(a):c(t,s)?this._all(a,n):r.push(a))}e=r.pop()}return n},n.prototype.collides=function(t){var e=this.data;if(!h(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],o=e.leaf?this.toBBox(r):r;if(h(t,o)){if(e.leaf||c(t,o))return!0;n.push(r)}}e=n.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}}else this.data=n;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var n,i,r,o=this.data,a=this.toBBox(t),s=[],l=[];o||s.length;){if(o||(o=s.pop(),i=s[s.length-1],n=l.pop(),r=!0),o.leaf){var u=function(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return -1}(t,o.children,e);if(-1!==u)return o.children.splice(u,1),s.push(o),this._condense(s),this}r||o.leaf||!c(o,a)?i?(n++,o=i.children[n],r=!1):o=null:(s.push(o),l.push(n),n=0,i=o,o=o.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},n.prototype._build=function(t,e,n,r){var o,a=n-e+1,s=this._maxEntries;if(a<=s)return i(o=f(t.slice(e,n+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(o=f([])).leaf=!1,o.height=r;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));d(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);d(t,c,h,l,this.compareMinY);for(var v=c;v<=h;v+=l){var g=Math.min(v+l-1,h);o.children.push(this._build(t,v,g,r-1))}}return i(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=l(u),h=(Math.max(u.maxX,t.maxX)-Math.min(u.minX,t.minX))*(Math.max(u.maxY,t.maxY)-Math.min(u.minY,t.minY))-c;h<o?(o=h,r=c<r?c:r,a=u):h===o&&c<r&&(r=c,a=u)}e=a||e.children[0]}return e},n.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],a=this._chooseSubtree(i,this.data,e,r);for(a.children.push(t),o(a,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},n.prototype._split=function(t,e){var n=t[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=f(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,i(n,this.toBBox),i(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},n.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,n){for(var i,o,a,s,u=1/0,c=1/0,h=e;h<=n-e;h++){var f=r(t,0,h,this.toBBox),d=r(t,h,n,this.toBBox),v=(o=void 0,a=void 0,o=Math.max(f.minX,d.minX),a=Math.max(f.minY,d.minY),Math.max(0,Math.min(f.maxX,d.maxX)-o)*Math.max(0,Math.min(f.maxY,d.maxY)-a)),g=l(f)+l(d);v<u?(u=v,i=h,c=g<c?g:c):v===u&&g<c&&(c=g,i=h)}return i||n-e},n.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:a,r=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},n.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var a=this.toBBox,s=r(t,0,e,a),l=r(t,n-e,n,a),c=u(s)+u(l),h=e;h<n-e;h++){var f=t.children[h];o(s,t.leaf?a(f):f),c+=u(s)}for(var d=n-e-1;d>=e;d--){var v=t.children[d];o(l,t.leaf?a(v):v),c+=u(l)}return c},n.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)o(e[i],t)},n.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():i(t[e],this.toBBox)},n}()},2587:function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,{Z:function(){return i}})},748:function(t,e,n){"use strict";function i(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,{Z:function(){return i}})},2777:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return i}})},2262:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,{Z:function(){return r}})},7247:function(t,e,n){"use strict";function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,{Z:function(){return i}})},1531:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(607);function r(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&(0,i.Z)(t,e)}},3553:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var i=n(4027),r=n(748);function o(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(t)}},607:function(t,e,n){"use strict";function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,{Z:function(){return i}})},6835:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(2937);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n,i,r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(t,e)||(0,i.Z)(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2937:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(2587);function r(t,e){if(t){if("string"==typeof t)return(0,i.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return(0,i.Z)(t,e)}}},6576:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var i=n(7247),r=n(607);function o(t,e,n){return(o=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&(0,r.Z)(o,n.prototype),o}:Reflect.construct).apply(null,arguments)}function a(t){var e="function"==typeof Map?new Map:void 0;return(a=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return o(t,arguments,(0,i.Z)(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,r.Z)(n,t)})(t)}}}]);